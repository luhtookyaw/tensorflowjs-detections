/*! For license information please see main.a78a67c9.js.LICENSE.txt */
!function(){var e={757:function(e,t,n){e.exports=n(727)},725:function(e){"use strict";var t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable;function a(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(a){return!1}}()?Object.assign:function(e,o){for(var i,u,s=a(e),c=1;c<arguments.length;c++){for(var l in i=Object(arguments[c]))n.call(i,l)&&(s[l]=i[l]);if(t){u=t(i);for(var f=0;f<u.length;f++)r.call(i,u[f])&&(s[u[f]]=i[u[f]])}}return s}},463:function(e,t,n){"use strict";var r=n(791),a=n(725),o=n(296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(i(227));var u=new Set,s={};function c(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(s[e]=t,e=0;e<t.length;e++)u.add(t[e])}var f=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d=Object.prototype.hasOwnProperty,h={},m={};function v(e,t,n,r,a,o,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=i}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function x(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=g.hasOwnProperty(t)?g[t]:null;(null!==a?0===a.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!d.call(m,e)||!d.call(h,e)&&(p.test(e)?m[e]=!0:(h[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,x);g[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,x);g[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,x);g[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,k=60103,C=60106,E=60107,S=60108,N=60114,T=60109,R=60110,I=60112,_=60113,A=60120,O=60115,D=60116,F=60121,P=60128,L=60129,M=60130,B=60131;if("function"===typeof Symbol&&Symbol.for){var z=Symbol.for;k=z("react.element"),C=z("react.portal"),E=z("react.fragment"),S=z("react.strict_mode"),N=z("react.profiler"),T=z("react.provider"),R=z("react.context"),I=z("react.forward_ref"),_=z("react.suspense"),A=z("react.suspense_list"),O=z("react.memo"),D=z("react.lazy"),F=z("react.block"),z("react.scope"),P=z("react.opaque.id"),L=z("react.debug_trace_mode"),M=z("react.offscreen"),B=z("react.legacy_hidden")}var V,U="function"===typeof Symbol&&Symbol.iterator;function W(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=U&&e[U]||e["@@iterator"])?e:null}function G(e){if(void 0===V)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);V=t&&t[1]||""}return"\n"+V+e}var j=!1;function H(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(s){var r=s}Reflect.construct(e,[],t)}else{try{t.call()}catch(s){r=s}e.call(t.prototype)}else{try{throw Error()}catch(s){r=s}e()}}catch(s){if(s&&r&&"string"===typeof s.stack){for(var a=s.stack.split("\n"),o=r.stack.split("\n"),i=a.length-1,u=o.length-1;1<=i&&0<=u&&a[i]!==o[u];)u--;for(;1<=i&&0<=u;i--,u--)if(a[i]!==o[u]){if(1!==i||1!==u)do{if(i--,0>--u||a[i]!==o[u])return"\n"+a[i].replace(" at new "," at ")}while(1<=i&&0<=u);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?G(e):""}function K(e){switch(e.tag){case 5:return G(e.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return e=H(e.type,!1);case 11:return e=H(e.type.render,!1);case 22:return e=H(e.type._render,!1);case 1:return e=H(e.type,!0);default:return""}}function q(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case C:return"Portal";case N:return"Profiler";case S:return"StrictMode";case _:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case R:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case O:return q(e.type);case F:return q(e._render);case D:t=e._payload,e=e._init;try{return q(e(t))}catch(n){}}return null}function X(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Y(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Q(e){e._valueTracker||(e._valueTracker=function(e){var t=Y(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function $(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Y(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function J(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return a({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=X(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=X(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ae(e,t.type,n):t.hasOwnProperty("defaultValue")&&ae(e,t.type,X(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ae(e,t,n){"number"===t&&J(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function oe(e,t){return e=a({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function ie(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+X(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function ue(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return a({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function se(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:X(n)}}function ce(e,t){var n=X(t.value),r=X(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var fe="http://www.w3.org/1999/xhtml",pe="http://www.w3.org/2000/svg";function de(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function he(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?de(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var me,ve,ge=(ve=function(e,t){if(e.namespaceURI!==pe||"innerHTML"in e)e.innerHTML=t;else{for((me=me||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=me.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ve(e,t)}))}:ve);function ye(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var xe={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},be=["Webkit","ms","Moz","O"];function we(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||xe.hasOwnProperty(e)&&xe[e]?(""+t).trim():t+"px"}function ke(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=we(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(xe).forEach((function(e){be.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xe[t]=xe[e]}))}));var Ce=a({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ee(e,t){if(t){if(Ce[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function Se(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Ne(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Te=null,Re=null,Ie=null;function _e(e){if(e=ra(e)){if("function"!==typeof Te)throw Error(i(280));var t=e.stateNode;t&&(t=oa(t),Te(e.stateNode,e.type,t))}}function Ae(e){Re?Ie?Ie.push(e):Ie=[e]:Re=e}function Oe(){if(Re){var e=Re,t=Ie;if(Ie=Re=null,_e(e),t)for(e=0;e<t.length;e++)_e(t[e])}}function De(e,t){return e(t)}function Fe(e,t,n,r,a){return e(t,n,r,a)}function Pe(){}var Le=De,Me=!1,Be=!1;function ze(){null===Re&&null===Ie||(Pe(),Oe())}function Ve(e,t){var n=e.stateNode;if(null===n)return null;var r=oa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Ue=!1;if(f)try{var We={};Object.defineProperty(We,"passive",{get:function(){Ue=!0}}),window.addEventListener("test",We,We),window.removeEventListener("test",We,We)}catch(ve){Ue=!1}function Ge(e,t,n,r,a,o,i,u,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var je=!1,He=null,Ke=!1,qe=null,Xe={onError:function(e){je=!0,He=e}};function Ye(e,t,n,r,a,o,i,u,s){je=!1,He=null,Ge.apply(Xe,arguments)}function Qe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Je(e){if(Qe(e)!==e)throw Error(i(188))}function Ze(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Qe(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Je(a),e;if(o===r)return Je(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var u=!1,s=a.child;s;){if(s===n){u=!0,n=a,r=o;break}if(s===r){u=!0,r=a,n=o;break}s=s.sibling}if(!u){for(s=o.child;s;){if(s===n){u=!0,n=o,r=a;break}if(s===r){u=!0,r=o,n=a;break}s=s.sibling}if(!u)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,at,ot=!1,it=[],ut=null,st=null,ct=null,lt=new Map,ft=new Map,pt=[],dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ht(e,t,n,r,a){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:a,targetContainers:[r]}}function mt(e,t){switch(e){case"focusin":case"focusout":ut=null;break;case"dragenter":case"dragleave":st=null;break;case"mouseover":case"mouseout":ct=null;break;case"pointerover":case"pointerout":lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ft.delete(t.pointerId)}}function vt(e,t,n,r,a,o){return null===e||e.nativeEvent!==o?(e=ht(t,n,r,a,o),null!==t&&(null!==(t=ra(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function gt(e){var t=na(e.target);if(null!==t){var n=Qe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void at(e.lanePriority,(function(){o.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function yt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ra(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function xt(e,t,n){yt(e)&&n.delete(t)}function bt(){for(ot=!1;0<it.length;){var e=it[0];if(null!==e.blockedOn){null!==(e=ra(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&it.shift()}null!==ut&&yt(ut)&&(ut=null),null!==st&&yt(st)&&(st=null),null!==ct&&yt(ct)&&(ct=null),lt.forEach(xt),ft.forEach(xt)}function wt(e,t){e.blockedOn===t&&(e.blockedOn=null,ot||(ot=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,bt)))}function kt(e){function t(t){return wt(t,e)}if(0<it.length){wt(it[0],e);for(var n=1;n<it.length;n++){var r=it[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==ut&&wt(ut,e),null!==st&&wt(st,e),null!==ct&&wt(ct,e),lt.forEach(t),ft.forEach(t),n=0;n<pt.length;n++)(r=pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<pt.length&&null===(n=pt[0]).blockedOn;)gt(n),null===n.blockedOn&&pt.shift()}function Ct(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Et={animationend:Ct("Animation","AnimationEnd"),animationiteration:Ct("Animation","AnimationIteration"),animationstart:Ct("Animation","AnimationStart"),transitionend:Ct("Transition","TransitionEnd")},St={},Nt={};function Tt(e){if(St[e])return St[e];if(!Et[e])return e;var t,n=Et[e];for(t in n)if(n.hasOwnProperty(t)&&t in Nt)return St[e]=n[t];return e}f&&(Nt=document.createElement("div").style,"AnimationEvent"in window||(delete Et.animationend.animation,delete Et.animationiteration.animation,delete Et.animationstart.animation),"TransitionEvent"in window||delete Et.transitionend.transition);var Rt=Tt("animationend"),It=Tt("animationiteration"),_t=Tt("animationstart"),At=Tt("transitionend"),Ot=new Map,Dt=new Map,Ft=["abort","abort",Rt,"animationEnd",It,"animationIteration",_t,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",At,"transitionEnd","waiting","waiting"];function Pt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],a=e[n+1];a="on"+(a[0].toUpperCase()+a.slice(1)),Dt.set(r,t),Ot.set(r,a),c(a,[r])}}(0,o.unstable_now)();var Lt=8;function Mt(e){if(0!==(1&e))return Lt=15,1;if(0!==(2&e))return Lt=14,2;if(0!==(4&e))return Lt=13,4;var t=24&e;return 0!==t?(Lt=12,t):0!==(32&e)?(Lt=11,32):0!==(t=192&e)?(Lt=10,t):0!==(256&e)?(Lt=9,256):0!==(t=3584&e)?(Lt=8,t):0!==(4096&e)?(Lt=7,4096):0!==(t=4186112&e)?(Lt=6,t):0!==(t=62914560&e)?(Lt=5,t):67108864&e?(Lt=4,67108864):0!==(134217728&e)?(Lt=3,134217728):0!==(t=805306368&e)?(Lt=2,t):0!==(1073741824&e)?(Lt=1,1073741824):(Lt=8,e)}function Bt(e,t){var n=e.pendingLanes;if(0===n)return Lt=0;var r=0,a=0,o=e.expiredLanes,i=e.suspendedLanes,u=e.pingedLanes;if(0!==o)r=o,a=Lt=15;else if(0!==(o=134217727&n)){var s=o&~i;0!==s?(r=Mt(s),a=Lt):0!==(u&=o)&&(r=Mt(u),a=Lt)}else 0!==(o=n&~i)?(r=Mt(o),a=Lt):0!==u&&(r=Mt(u),a=Lt);if(0===r)return 0;if(r=n&((0>(r=31-jt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&i)){if(Mt(t),a<=Lt)return t;Lt=a}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-jt(t)),r|=e[n],t&=~a;return r}function zt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Vt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Ut(24&~t))?Vt(10,t):e;case 10:return 0===(e=Ut(192&~t))?Vt(8,t):e;case 8:return 0===(e=Ut(3584&~t))&&(0===(e=Ut(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Ut(805306368&~t))&&(t=268435456),t}throw Error(i(358,e))}function Ut(e){return e&-e}function Wt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Gt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-jt(t)]=n}var jt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Ht(e)/Kt|0)|0},Ht=Math.log,Kt=Math.LN2;var qt=o.unstable_UserBlockingPriority,Xt=o.unstable_runWithPriority,Yt=!0;function Qt(e,t,n,r){Me||Pe();var a=Jt,o=Me;Me=!0;try{Fe(a,e,t,n,r)}finally{(Me=o)||ze()}}function $t(e,t,n,r){Xt(qt,Jt.bind(null,e,t,n,r))}function Jt(e,t,n,r){var a;if(Yt)if((a=0===(4&t))&&0<it.length&&-1<dt.indexOf(e))e=ht(null,e,t,n,r),it.push(e);else{var o=Zt(e,t,n,r);if(null===o)a&&mt(e,r);else{if(a){if(-1<dt.indexOf(e))return e=ht(o,e,t,n,r),void it.push(e);if(function(e,t,n,r,a){switch(t){case"focusin":return ut=vt(ut,e,t,n,r,a),!0;case"dragenter":return st=vt(st,e,t,n,r,a),!0;case"mouseover":return ct=vt(ct,e,t,n,r,a),!0;case"pointerover":var o=a.pointerId;return lt.set(o,vt(lt.get(o)||null,e,t,n,r,a)),!0;case"gotpointercapture":return o=a.pointerId,ft.set(o,vt(ft.get(o)||null,e,t,n,r,a)),!0}return!1}(o,e,t,n,r))return;mt(e,r)}Pr(e,t,r,null,n)}}}function Zt(e,t,n,r){var a=Ne(r);if(null!==(a=na(a))){var o=Qe(a);if(null===o)a=null;else{var i=o.tag;if(13===i){if(null!==(a=$e(o)))return a;a=null}else if(3===i){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;a=null}else o!==a&&(a=null)}}return Pr(e,t,r,a,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,a="value"in en?en.value:en.textContent,o=a.length;for(e=0;e<r&&n[e]===a[e];e++);var i=r-e;for(t=1;t<=i&&n[r-t]===a[o-t];t++);return nn=a.slice(e,1<t?1-t:void 0)}function an(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function on(){return!0}function un(){return!1}function sn(e){function t(t,n,r,a,o){for(var i in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?on:un,this.isPropagationStopped=un,this}return a(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var cn,ln,fn,pn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},dn=sn(pn),hn=a({},pn,{view:0,detail:0}),mn=sn(hn),vn=a({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Rn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==fn&&(fn&&"mousemove"===e.type?(cn=e.screenX-fn.screenX,ln=e.screenY-fn.screenY):ln=cn=0,fn=e),cn)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),gn=sn(vn),yn=sn(a({},vn,{dataTransfer:0})),xn=sn(a({},hn,{relatedTarget:0})),bn=sn(a({},pn,{animationName:0,elapsedTime:0,pseudoElement:0})),wn=a({},pn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kn=sn(wn),Cn=sn(a({},pn,{data:0})),En={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Nn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Nn[e])&&!!t[e]}function Rn(){return Tn}var In=a({},hn,{key:function(e){if(e.key){var t=En[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=an(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Rn,charCode:function(e){return"keypress"===e.type?an(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?an(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=sn(In),An=sn(a({},vn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=sn(a({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Rn})),Dn=sn(a({},pn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Fn=a({},vn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=sn(Fn),Ln=[9,13,27,32],Mn=f&&"CompositionEvent"in window,Bn=null;f&&"documentMode"in document&&(Bn=document.documentMode);var zn=f&&"TextEvent"in window&&!Bn,Vn=f&&(!Mn||Bn&&8<Bn&&11>=Bn),Un=String.fromCharCode(32),Wn=!1;function Gn(e,t){switch(e){case"keyup":return-1!==Ln.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function jn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Hn=!1;var Kn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Kn[e.type]:"textarea"===t}function Xn(e,t,n,r){Ae(r),0<(t=Mr(t,"onChange")).length&&(n=new dn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Yn=null,Qn=null;function $n(e){Ir(e,0)}function Jn(e){if($(aa(e)))return e}function Zn(e,t){if("change"===e)return t}var er=!1;if(f){var tr;if(f){var nr="oninput"in document;if(!nr){var rr=document.createElement("div");rr.setAttribute("oninput","return;"),nr="function"===typeof rr.oninput}tr=nr}else tr=!1;er=tr&&(!document.documentMode||9<document.documentMode)}function ar(){Yn&&(Yn.detachEvent("onpropertychange",or),Qn=Yn=null)}function or(e){if("value"===e.propertyName&&Jn(Qn)){var t=[];if(Xn(t,Qn,e,Ne(e)),e=$n,Me)e(t);else{Me=!0;try{De(e,t)}finally{Me=!1,ze()}}}}function ir(e,t,n){"focusin"===e?(ar(),Qn=n,(Yn=t).attachEvent("onpropertychange",or)):"focusout"===e&&ar()}function ur(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Qn)}function sr(e,t){if("click"===e)return Jn(t)}function cr(e,t){if("input"===e||"change"===e)return Jn(t)}var lr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},fr=Object.prototype.hasOwnProperty;function pr(e,t){if(lr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!fr.call(t,n[r])||!lr(e[n[r]],t[n[r]]))return!1;return!0}function dr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function hr(e,t){var n,r=dr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dr(r)}}function mr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?mr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function vr(){for(var e=window,t=J();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=J((e=t.contentWindow).document)}return t}function gr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var yr=f&&"documentMode"in document&&11>=document.documentMode,xr=null,br=null,wr=null,kr=!1;function Cr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;kr||null==xr||xr!==J(r)||("selectionStart"in(r=xr)&&gr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},wr&&pr(wr,r)||(wr=r,0<(r=Mr(br,"onSelect")).length&&(t=new dn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=xr)))}Pt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Pt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Pt(Ft,2);for(var Er="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Sr=0;Sr<Er.length;Sr++)Dt.set(Er[Sr],0);l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),c("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),c("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),c("onBeforeInput",["compositionend","keypress","textInput","paste"]),c("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),c("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Nr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Nr));function Rr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,u,s,c){if(Ye.apply(this,arguments),je){if(!je)throw Error(i(198));var l=He;je=!1,He=null,Ke||(Ke=!0,qe=l)}}(r,t,void 0,e),e.currentTarget=null}function Ir(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var i=r.length-1;0<=i;i--){var u=r[i],s=u.instance,c=u.currentTarget;if(u=u.listener,s!==o&&a.isPropagationStopped())break e;Rr(a,u,c),o=s}else for(i=0;i<r.length;i++){if(s=(u=r[i]).instance,c=u.currentTarget,u=u.listener,s!==o&&a.isPropagationStopped())break e;Rr(a,u,c),o=s}}}if(Ke)throw e=qe,Ke=!1,qe=null,e}function _r(e,t){var n=ia(t),r=e+"__bubble";n.has(r)||(Fr(t,e,2,!1),n.add(r))}var Ar="_reactListening"+Math.random().toString(36).slice(2);function Or(e){e[Ar]||(e[Ar]=!0,u.forEach((function(t){Tr.has(t)||Dr(t,!1,e,null),Dr(t,!0,e,null)})))}function Dr(e,t,n,r){var a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===e&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!t&&Tr.has(e)){if("scroll"!==e)return;a|=2,o=r}var i=ia(o),u=e+"__"+(t?"capture":"bubble");i.has(u)||(t&&(a|=4),Fr(o,e,a,t),i.add(u))}function Fr(e,t,n,r){var a=Dt.get(t);switch(void 0===a?2:a){case 0:a=Qt;break;case 1:a=$t;break;default:a=Jt}n=a.bind(null,t,n,e),a=void 0,!Ue||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Pr(e,t,n,r,a){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var i=r.tag;if(3===i||4===i){var u=r.stateNode.containerInfo;if(u===a||8===u.nodeType&&u.parentNode===a)break;if(4===i)for(i=r.return;null!==i;){var s=i.tag;if((3===s||4===s)&&((s=i.stateNode.containerInfo)===a||8===s.nodeType&&s.parentNode===a))return;i=i.return}for(;null!==u;){if(null===(i=na(u)))return;if(5===(s=i.tag)||6===s){r=o=i;continue e}u=u.parentNode}}r=r.return}!function(e,t,n){if(Be)return e(t,n);Be=!0;try{Le(e,t,n)}finally{Be=!1,ze()}}((function(){var r=o,a=Ne(n),i=[];e:{var u=Ot.get(e);if(void 0!==u){var s=dn,c=e;switch(e){case"keypress":if(0===an(n))break e;case"keydown":case"keyup":s=_n;break;case"focusin":c="focus",s=xn;break;case"focusout":c="blur",s=xn;break;case"beforeblur":case"afterblur":s=xn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=On;break;case Rt:case It:case _t:s=bn;break;case At:s=Dn;break;case"scroll":s=mn;break;case"wheel":s=Pn;break;case"copy":case"cut":case"paste":s=kn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=An}var l=0!==(4&t),f=!l&&"scroll"===e,p=l?null!==u?u+"Capture":null:u;l=[];for(var d,h=r;null!==h;){var m=(d=h).stateNode;if(5===d.tag&&null!==m&&(d=m,null!==p&&(null!=(m=Ve(h,p))&&l.push(Lr(h,m,d)))),f)break;h=h.return}0<l.length&&(u=new s(u,c,null,n,a),i.push({event:u,listeners:l}))}}if(0===(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(u="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(c=n.relatedTarget||n.fromElement)||!na(c)&&!c[ea])&&(s||u)&&(u=a.window===a?a:(u=a.ownerDocument)?u.defaultView||u.parentWindow:window,s?(s=r,null!==(c=(c=n.relatedTarget||n.toElement)?na(c):null)&&(c!==(f=Qe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=r),s!==c)){if(l=gn,m="onMouseLeave",p="onMouseEnter",h="mouse","pointerout"!==e&&"pointerover"!==e||(l=An,m="onPointerLeave",p="onPointerEnter",h="pointer"),f=null==s?u:aa(s),d=null==c?u:aa(c),(u=new l(m,h+"leave",s,n,a)).target=f,u.relatedTarget=d,m=null,na(a)===r&&((l=new l(p,h+"enter",c,n,a)).target=d,l.relatedTarget=f,m=l),f=m,s&&c)e:{for(p=c,h=0,d=l=s;d;d=Br(d))h++;for(d=0,m=p;m;m=Br(m))d++;for(;0<h-d;)l=Br(l),h--;for(;0<d-h;)p=Br(p),d--;for(;h--;){if(l===p||null!==p&&l===p.alternate)break e;l=Br(l),p=Br(p)}l=null}else l=null;null!==s&&zr(i,u,s,l,!1),null!==c&&null!==f&&zr(i,f,c,l,!0)}if("select"===(s=(u=r?aa(r):window).nodeName&&u.nodeName.toLowerCase())||"input"===s&&"file"===u.type)var v=Zn;else if(qn(u))if(er)v=cr;else{v=ur;var g=ir}else(s=u.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===u.type||"radio"===u.type)&&(v=sr);switch(v&&(v=v(e,r))?Xn(i,v,n,a):(g&&g(e,u,r),"focusout"===e&&(g=u._wrapperState)&&g.controlled&&"number"===u.type&&ae(u,"number",u.value)),g=r?aa(r):window,e){case"focusin":(qn(g)||"true"===g.contentEditable)&&(xr=g,br=r,wr=null);break;case"focusout":wr=br=xr=null;break;case"mousedown":kr=!0;break;case"contextmenu":case"mouseup":case"dragend":kr=!1,Cr(i,n,a);break;case"selectionchange":if(yr)break;case"keydown":case"keyup":Cr(i,n,a)}var y;if(Mn)e:{switch(e){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Hn?Gn(e,n)&&(x="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(x="onCompositionStart");x&&(Vn&&"ko"!==n.locale&&(Hn||"onCompositionStart"!==x?"onCompositionEnd"===x&&Hn&&(y=rn()):(tn="value"in(en=a)?en.value:en.textContent,Hn=!0)),0<(g=Mr(r,x)).length&&(x=new Cn(x,e,null,n,a),i.push({event:x,listeners:g}),y?x.data=y:null!==(y=jn(n))&&(x.data=y))),(y=zn?function(e,t){switch(e){case"compositionend":return jn(t);case"keypress":return 32!==t.which?null:(Wn=!0,Un);case"textInput":return(e=t.data)===Un&&Wn?null:e;default:return null}}(e,n):function(e,t){if(Hn)return"compositionend"===e||!Mn&&Gn(e,t)?(e=rn(),nn=tn=en=null,Hn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Vn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Mr(r,"onBeforeInput")).length&&(a=new Cn("onBeforeInput","beforeinput",null,n,a),i.push({event:a,listeners:r}),a.data=y))}Ir(i,t)}))}function Lr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Mr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,o=a.stateNode;5===a.tag&&null!==o&&(a=o,null!=(o=Ve(e,n))&&r.unshift(Lr(e,o,a)),null!=(o=Ve(e,t))&&r.push(Lr(e,o,a))),e=e.return}return r}function Br(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function zr(e,t,n,r,a){for(var o=t._reactName,i=[];null!==n&&n!==r;){var u=n,s=u.alternate,c=u.stateNode;if(null!==s&&s===r)break;5===u.tag&&null!==c&&(u=c,a?null!=(s=Ve(n,o))&&i.unshift(Lr(n,s,u)):a||null!=(s=Ve(n,o))&&i.push(Lr(n,s,u))),n=n.return}0!==i.length&&e.push({event:t,listeners:i})}function Vr(){}var Ur=null,Wr=null;function Gr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function jr(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Hr="function"===typeof setTimeout?setTimeout:void 0,Kr="function"===typeof clearTimeout?clearTimeout:void 0;function qr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Xr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Yr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var Qr=0;var $r=Math.random().toString(36).slice(2),Jr="__reactFiber$"+$r,Zr="__reactProps$"+$r,ea="__reactContainer$"+$r,ta="__reactEvents$"+$r;function na(e){var t=e[Jr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[ea]||n[Jr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Yr(e);null!==e;){if(n=e[Jr])return n;e=Yr(e)}return t}n=(e=n).parentNode}return null}function ra(e){return!(e=e[Jr]||e[ea])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function aa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function oa(e){return e[Zr]||null}function ia(e){var t=e[ta];return void 0===t&&(t=e[ta]=new Set),t}var ua=[],sa=-1;function ca(e){return{current:e}}function la(e){0>sa||(e.current=ua[sa],ua[sa]=null,sa--)}function fa(e,t){sa++,ua[sa]=e.current,e.current=t}var pa={},da=ca(pa),ha=ca(!1),ma=pa;function va(e,t){var n=e.type.contextTypes;if(!n)return pa;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,o={};for(a in n)o[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function ga(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ya(){la(ha),la(da)}function xa(e,t,n){if(da.current!==pa)throw Error(i(168));fa(da,t),fa(ha,n)}function ba(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(i(108,q(t)||"Unknown",o));return a({},n,r)}function wa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||pa,ma=da.current,fa(da,e),fa(ha,ha.current),!0}function ka(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=ba(e,t,ma),r.__reactInternalMemoizedMergedChildContext=e,la(ha),la(da),fa(da,e)):la(ha),fa(ha,n)}var Ca=null,Ea=null,Sa=o.unstable_runWithPriority,Na=o.unstable_scheduleCallback,Ta=o.unstable_cancelCallback,Ra=o.unstable_shouldYield,Ia=o.unstable_requestPaint,_a=o.unstable_now,Aa=o.unstable_getCurrentPriorityLevel,Oa=o.unstable_ImmediatePriority,Da=o.unstable_UserBlockingPriority,Fa=o.unstable_NormalPriority,Pa=o.unstable_LowPriority,La=o.unstable_IdlePriority,Ma={},Ba=void 0!==Ia?Ia:function(){},za=null,Va=null,Ua=!1,Wa=_a(),Ga=1e4>Wa?_a:function(){return _a()-Wa};function ja(){switch(Aa()){case Oa:return 99;case Da:return 98;case Fa:return 97;case Pa:return 96;case La:return 95;default:throw Error(i(332))}}function Ha(e){switch(e){case 99:return Oa;case 98:return Da;case 97:return Fa;case 96:return Pa;case 95:return La;default:throw Error(i(332))}}function Ka(e,t){return e=Ha(e),Sa(e,t)}function qa(e,t,n){return e=Ha(e),Na(e,t,n)}function Xa(){if(null!==Va){var e=Va;Va=null,Ta(e)}Ya()}function Ya(){if(!Ua&&null!==za){Ua=!0;var e=0;try{var t=za;Ka(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),za=null}catch(n){throw null!==za&&(za=za.slice(e+1)),Na(Oa,Xa),n}finally{Ua=!1}}}var Qa=w.ReactCurrentBatchConfig;function $a(e,t){if(e&&e.defaultProps){for(var n in t=a({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Ja=ca(null),Za=null,eo=null,to=null;function no(){to=eo=Za=null}function ro(e){var t=Ja.current;la(Ja),e.type._context._currentValue=t}function ao(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function oo(e,t){Za=e,to=eo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Mi=!0),e.firstContext=null)}function io(e,t){if(to!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(to=e,t=1073741823),t={context:e,observedBits:t,next:null},null===eo){if(null===Za)throw Error(i(308));eo=t,Za.dependencies={lanes:0,firstContext:t,responders:null}}else eo=eo.next=t;return e._currentValue}var uo=!1;function so(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function co(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function lo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fo(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function po(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?a=o=i:o=o.next=i,n=n.next}while(null!==n);null===o?a=o=t:o=o.next=t}else a=o=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ho(e,t,n,r){var o=e.updateQueue;uo=!1;var i=o.firstBaseUpdate,u=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var c=s,l=c.next;c.next=null,null===u?i=l:u.next=l,u=c;var f=e.alternate;if(null!==f){var p=(f=f.updateQueue).lastBaseUpdate;p!==u&&(null===p?f.firstBaseUpdate=l:p.next=l,f.lastBaseUpdate=c)}}if(null!==i){for(p=o.baseState,u=0,f=l=c=null;;){s=i.lane;var d=i.eventTime;if((r&s)===s){null!==f&&(f=f.next={eventTime:d,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var h=e,m=i;switch(s=t,d=n,m.tag){case 1:if("function"===typeof(h=m.payload)){p=h.call(d,p,s);break e}p=h;break e;case 3:h.flags=-4097&h.flags|64;case 0:if(null===(s="function"===typeof(h=m.payload)?h.call(d,p,s):h)||void 0===s)break e;p=a({},p,s);break e;case 2:uo=!0}}null!==i.callback&&(e.flags|=32,null===(s=o.effects)?o.effects=[i]:s.push(i))}else d={eventTime:d,lane:s,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===f?(l=f=d,c=p):f=f.next=d,u|=s;if(null===(i=i.next)){if(null===(s=o.shared.pending))break;i=s.next,s.next=null,o.lastBaseUpdate=s,o.shared.pending=null}}null===f&&(c=p),o.baseState=c,o.firstBaseUpdate=l,o.lastBaseUpdate=f,Uu|=u,e.lanes=u,e.memoizedState=p}}function mo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var vo=(new r.Component).refs;function go(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:a({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var yo={isMounted:function(e){return!!(e=e._reactInternals)&&Qe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ps(),a=ds(e),o=lo(r,a);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),fo(e,o),hs(e,a,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ps(),a=ds(e),o=lo(r,a);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),fo(e,o),hs(e,a,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ps(),r=ds(e),a=lo(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),fo(e,a),hs(e,r,n)}};function xo(e,t,n,r,a,o,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,i):!t.prototype||!t.prototype.isPureReactComponent||(!pr(n,r)||!pr(a,o))}function bo(e,t,n){var r=!1,a=pa,o=t.contextType;return"object"===typeof o&&null!==o?o=io(o):(a=ga(t)?ma:da.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?va(e,a):pa),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=yo,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=o),t}function wo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&yo.enqueueReplaceState(t,t.state,null)}function ko(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=vo,so(e);var o=t.contextType;"object"===typeof o&&null!==o?a.context=io(o):(o=ga(t)?ma:da.current,a.context=va(e,o)),ho(e,n,a,r),a.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(go(e,t,o,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&yo.enqueueReplaceState(a,a.state,null),ho(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4)}var Co=Array.isArray;function Eo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=r.refs;t===vo&&(t=r.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function So(e,t){if("textarea"!==e.type)throw Error(i(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function No(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Ks(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function u(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,n,r){return null===t||6!==t.tag?((t=Qs(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=a(t,n.props)).ref=Eo(e,t,n),r.return=e,r):((r=qs(n.type,n.key,n.props,null,e.mode,r)).ref=Eo(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=$s(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,o){return null===t||7!==t.tag?((t=Xs(n,e.mode,r,o)).return=e,t):((t=a(t,n)).return=e,t)}function p(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Qs(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case k:return(n=qs(t.type,t.key,t.props,null,e.mode,n)).ref=Eo(e,null,t),n.return=e,n;case C:return(t=$s(t,e.mode,n)).return=e,t}if(Co(t)||W(t))return(t=Xs(t,e.mode,n,null)).return=e,t;So(e,t)}return null}function d(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==a?null:s(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case k:return n.key===a?n.type===E?f(e,t,n.props.children,r,a):c(e,t,n,r):null;case C:return n.key===a?l(e,t,n,r):null}if(Co(n)||W(n))return null!==a?null:f(e,t,n,r,null);So(e,n)}return null}function h(e,t,n,r,a){if("string"===typeof r||"number"===typeof r)return s(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case k:return e=e.get(null===r.key?n:r.key)||null,r.type===E?f(t,e,r.props.children,a,r.key):c(t,e,r,a);case C:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a)}if(Co(r)||W(r))return f(t,e=e.get(n)||null,r,a,null);So(t,r)}return null}function m(a,i,u,s){for(var c=null,l=null,f=i,m=i=0,v=null;null!==f&&m<u.length;m++){f.index>m?(v=f,f=null):v=f.sibling;var g=d(a,f,u[m],s);if(null===g){null===f&&(f=v);break}e&&f&&null===g.alternate&&t(a,f),i=o(g,i,m),null===l?c=g:l.sibling=g,l=g,f=v}if(m===u.length)return n(a,f),c;if(null===f){for(;m<u.length;m++)null!==(f=p(a,u[m],s))&&(i=o(f,i,m),null===l?c=f:l.sibling=f,l=f);return c}for(f=r(a,f);m<u.length;m++)null!==(v=h(f,a,m,u[m],s))&&(e&&null!==v.alternate&&f.delete(null===v.key?m:v.key),i=o(v,i,m),null===l?c=v:l.sibling=v,l=v);return e&&f.forEach((function(e){return t(a,e)})),c}function v(a,u,s,c){var l=W(s);if("function"!==typeof l)throw Error(i(150));if(null==(s=l.call(s)))throw Error(i(151));for(var f=l=null,m=u,v=u=0,g=null,y=s.next();null!==m&&!y.done;v++,y=s.next()){m.index>v?(g=m,m=null):g=m.sibling;var x=d(a,m,y.value,c);if(null===x){null===m&&(m=g);break}e&&m&&null===x.alternate&&t(a,m),u=o(x,u,v),null===f?l=x:f.sibling=x,f=x,m=g}if(y.done)return n(a,m),l;if(null===m){for(;!y.done;v++,y=s.next())null!==(y=p(a,y.value,c))&&(u=o(y,u,v),null===f?l=y:f.sibling=y,f=y);return l}for(m=r(a,m);!y.done;v++,y=s.next())null!==(y=h(m,a,v,y.value,c))&&(e&&null!==y.alternate&&m.delete(null===y.key?v:y.key),u=o(y,u,v),null===f?l=y:f.sibling=y,f=y);return e&&m.forEach((function(e){return t(a,e)})),l}return function(e,r,o,s){var c="object"===typeof o&&null!==o&&o.type===E&&null===o.key;c&&(o=o.props.children);var l="object"===typeof o&&null!==o;if(l)switch(o.$$typeof){case k:e:{for(l=o.key,c=r;null!==c;){if(c.key===l){if(7===c.tag){if(o.type===E){n(e,c.sibling),(r=a(c,o.props.children)).return=e,e=r;break e}}else if(c.elementType===o.type){n(e,c.sibling),(r=a(c,o.props)).ref=Eo(e,c,o),r.return=e,e=r;break e}n(e,c);break}t(e,c),c=c.sibling}o.type===E?((r=Xs(o.props.children,e.mode,s,o.key)).return=e,e=r):((s=qs(o.type,o.key,o.props,null,e.mode,s)).ref=Eo(e,r,o),s.return=e,e=s)}return u(e);case C:e:{for(c=o.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=a(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=$s(o,e.mode,s)).return=e,e=r}return u(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=a(r,o)).return=e,e=r):(n(e,r),(r=Qs(o,e.mode,s)).return=e,e=r),u(e);if(Co(o))return m(e,r,o,s);if(W(o))return v(e,r,o,s);if(l&&So(e,o),"undefined"===typeof o&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(i(152,q(e.type)||"Component"))}return n(e,r)}}var To=No(!0),Ro=No(!1),Io={},_o=ca(Io),Ao=ca(Io),Oo=ca(Io);function Do(e){if(e===Io)throw Error(i(174));return e}function Fo(e,t){switch(fa(Oo,t),fa(Ao,e),fa(_o,Io),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:he(null,"");break;default:t=he(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}la(_o),fa(_o,t)}function Po(){la(_o),la(Ao),la(Oo)}function Lo(e){Do(Oo.current);var t=Do(_o.current),n=he(t,e.type);t!==n&&(fa(Ao,e),fa(_o,n))}function Mo(e){Ao.current===e&&(la(_o),la(Ao))}var Bo=ca(0);function zo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vo=null,Uo=null,Wo=!1;function Go(e,t){var n=js(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function jo(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function Ho(e){if(Wo){var t=Uo;if(t){var n=t;if(!jo(e,t)){if(!(t=Xr(n.nextSibling))||!jo(e,t))return e.flags=-1025&e.flags|2,Wo=!1,void(Vo=e);Go(Vo,n)}Vo=e,Uo=Xr(t.firstChild)}else e.flags=-1025&e.flags|2,Wo=!1,Vo=e}}function Ko(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Vo=e}function qo(e){if(e!==Vo)return!1;if(!Wo)return Ko(e),Wo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!jr(t,e.memoizedProps))for(t=Uo;t;)Go(e,t),t=Xr(t.nextSibling);if(Ko(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){Uo=Xr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}Uo=null}}else Uo=Vo?Xr(e.stateNode.nextSibling):null;return!0}function Xo(){Uo=Vo=null,Wo=!1}var Yo=[];function Qo(){for(var e=0;e<Yo.length;e++)Yo[e]._workInProgressVersionPrimary=null;Yo.length=0}var $o=w.ReactCurrentDispatcher,Jo=w.ReactCurrentBatchConfig,Zo=0,ei=null,ti=null,ni=null,ri=!1,ai=!1;function oi(){throw Error(i(321))}function ii(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!lr(e[n],t[n]))return!1;return!0}function ui(e,t,n,r,a,o){if(Zo=o,ei=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,$o.current=null===e||null===e.memoizedState?Di:Fi,e=n(r,a),ai){o=0;do{if(ai=!1,!(25>o))throw Error(i(301));o+=1,ni=ti=null,t.updateQueue=null,$o.current=Pi,e=n(r,a)}while(ai)}if($o.current=Oi,t=null!==ti&&null!==ti.next,Zo=0,ni=ti=ei=null,ri=!1,t)throw Error(i(300));return e}function si(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ni?ei.memoizedState=ni=e:ni=ni.next=e,ni}function ci(){if(null===ti){var e=ei.alternate;e=null!==e?e.memoizedState:null}else e=ti.next;var t=null===ni?ei.memoizedState:ni.next;if(null!==t)ni=t,ti=e;else{if(null===e)throw Error(i(310));e={memoizedState:(ti=e).memoizedState,baseState:ti.baseState,baseQueue:ti.baseQueue,queue:ti.queue,next:null},null===ni?ei.memoizedState=ni=e:ni=ni.next=e}return ni}function li(e,t){return"function"===typeof t?t(e):t}function fi(e){var t=ci(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=ti,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var u=a.next;a.next=o.next,o.next=u}r.baseQueue=a=o,n.pending=null}if(null!==a){a=a.next,r=r.baseState;var s=u=o=null,c=a;do{var l=c.lane;if((Zo&l)===l)null!==s&&(s=s.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),r=c.eagerReducer===e?c.eagerState:e(r,c.action);else{var f={lane:l,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===s?(u=s=f,o=r):s=s.next=f,ei.lanes|=l,Uu|=l}c=c.next}while(null!==c&&c!==a);null===s?o=r:s.next=u,lr(r,t.memoizedState)||(Mi=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=s,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function pi(e){var t=ci(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var u=a=a.next;do{o=e(o,u.action),u=u.next}while(u!==a);lr(o,t.memoizedState)||(Mi=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function di(e,t,n){var r=t._getVersion;r=r(t._source);var a=t._workInProgressVersionPrimary;if(null!==a?e=a===r:(e=e.mutableReadLanes,(e=(Zo&e)===e)&&(t._workInProgressVersionPrimary=r,Yo.push(t))),e)return n(t._source);throw Yo.push(t),Error(i(350))}function hi(e,t,n,r){var a=Du;if(null===a)throw Error(i(349));var o=t._getVersion,u=o(t._source),s=$o.current,c=s.useState((function(){return di(a,t,n)})),l=c[1],f=c[0];c=ni;var p=e.memoizedState,d=p.refs,h=d.getSnapshot,m=p.source;p=p.subscribe;var v=ei;return e.memoizedState={refs:d,source:t,subscribe:r},s.useEffect((function(){d.getSnapshot=n,d.setSnapshot=l;var e=o(t._source);if(!lr(u,e)){e=n(t._source),lr(f,e)||(l(e),e=ds(v),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var r=a.entanglements,i=e;0<i;){var s=31-jt(i),c=1<<s;r[s]|=e,i&=~c}}}),[n,t,r]),s.useEffect((function(){return r(t._source,(function(){var e=d.getSnapshot,n=d.setSnapshot;try{n(e(t._source));var r=ds(v);a.mutableReadLanes|=r&a.pendingLanes}catch(o){n((function(){throw o}))}}))}),[t,r]),lr(h,n)&&lr(m,t)&&lr(p,r)||((e={pending:null,dispatch:null,lastRenderedReducer:li,lastRenderedState:f}).dispatch=l=Ai.bind(null,ei,e),c.queue=e,c.baseQueue=null,f=di(a,t,n),c.memoizedState=c.baseState=f),f}function mi(e,t,n){return hi(ci(),e,t,n)}function vi(e){var t=si();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:li,lastRenderedState:e}).dispatch=Ai.bind(null,ei,e),[t.memoizedState,e]}function gi(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ei.updateQueue)?(t={lastEffect:null},ei.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function yi(e){return e={current:e},si().memoizedState=e}function xi(){return ci().memoizedState}function bi(e,t,n,r){var a=si();ei.flags|=e,a.memoizedState=gi(1|t,n,void 0,void 0===r?null:r)}function wi(e,t,n,r){var a=ci();r=void 0===r?null:r;var o=void 0;if(null!==ti){var i=ti.memoizedState;if(o=i.destroy,null!==r&&ii(r,i.deps))return void gi(t,n,o,r)}ei.flags|=e,a.memoizedState=gi(1|t,n,o,r)}function ki(e,t){return bi(516,4,e,t)}function Ci(e,t){return wi(516,4,e,t)}function Ei(e,t){return wi(4,2,e,t)}function Si(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ni(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,wi(4,2,Si.bind(null,t,e),n)}function Ti(){}function Ri(e,t){var n=ci();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ii(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ii(e,t){var n=ci();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ii(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function _i(e,t){var n=ja();Ka(98>n?98:n,(function(){e(!0)})),Ka(97<n?97:n,(function(){var n=Jo.transition;Jo.transition=1;try{e(!1),t()}finally{Jo.transition=n}}))}function Ai(e,t,n){var r=ps(),a=ds(e),o={lane:a,action:n,eagerReducer:null,eagerState:null,next:null},i=t.pending;if(null===i?o.next=o:(o.next=i.next,i.next=o),t.pending=o,i=e.alternate,e===ei||null!==i&&i===ei)ai=ri=!0;else{if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var u=t.lastRenderedState,s=i(u,n);if(o.eagerReducer=i,o.eagerState=s,lr(s,u))return}catch(c){}hs(e,a,r)}}var Oi={readContext:io,useCallback:oi,useContext:oi,useEffect:oi,useImperativeHandle:oi,useLayoutEffect:oi,useMemo:oi,useReducer:oi,useRef:oi,useState:oi,useDebugValue:oi,useDeferredValue:oi,useTransition:oi,useMutableSource:oi,useOpaqueIdentifier:oi,unstable_isNewReconciler:!1},Di={readContext:io,useCallback:function(e,t){return si().memoizedState=[e,void 0===t?null:t],e},useContext:io,useEffect:ki,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,bi(4,2,Si.bind(null,t,e),n)},useLayoutEffect:function(e,t){return bi(4,2,e,t)},useMemo:function(e,t){var n=si();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=si();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Ai.bind(null,ei,e),[r.memoizedState,e]},useRef:yi,useState:vi,useDebugValue:Ti,useDeferredValue:function(e){var t=vi(e),n=t[0],r=t[1];return ki((function(){var t=Jo.transition;Jo.transition=1;try{r(e)}finally{Jo.transition=t}}),[e]),n},useTransition:function(){var e=vi(!1),t=e[0];return yi(e=_i.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=si();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},hi(r,e,t,n)},useOpaqueIdentifier:function(){if(Wo){var e=!1,t=function(e){return{$$typeof:P,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(Qr++).toString(36))),Error(i(355))})),n=vi(t)[1];return 0===(2&ei.mode)&&(ei.flags|=516,gi(5,(function(){n("r:"+(Qr++).toString(36))}),void 0,null)),t}return vi(t="r:"+(Qr++).toString(36)),t},unstable_isNewReconciler:!1},Fi={readContext:io,useCallback:Ri,useContext:io,useEffect:Ci,useImperativeHandle:Ni,useLayoutEffect:Ei,useMemo:Ii,useReducer:fi,useRef:xi,useState:function(){return fi(li)},useDebugValue:Ti,useDeferredValue:function(e){var t=fi(li),n=t[0],r=t[1];return Ci((function(){var t=Jo.transition;Jo.transition=1;try{r(e)}finally{Jo.transition=t}}),[e]),n},useTransition:function(){var e=fi(li)[0];return[xi().current,e]},useMutableSource:mi,useOpaqueIdentifier:function(){return fi(li)[0]},unstable_isNewReconciler:!1},Pi={readContext:io,useCallback:Ri,useContext:io,useEffect:Ci,useImperativeHandle:Ni,useLayoutEffect:Ei,useMemo:Ii,useReducer:pi,useRef:xi,useState:function(){return pi(li)},useDebugValue:Ti,useDeferredValue:function(e){var t=pi(li),n=t[0],r=t[1];return Ci((function(){var t=Jo.transition;Jo.transition=1;try{r(e)}finally{Jo.transition=t}}),[e]),n},useTransition:function(){var e=pi(li)[0];return[xi().current,e]},useMutableSource:mi,useOpaqueIdentifier:function(){return pi(li)[0]},unstable_isNewReconciler:!1},Li=w.ReactCurrentOwner,Mi=!1;function Bi(e,t,n,r){t.child=null===e?Ro(t,null,n,r):To(t,e.child,n,r)}function zi(e,t,n,r,a){n=n.render;var o=t.ref;return oo(t,a),r=ui(e,t,n,r,o,a),null===e||Mi?(t.flags|=1,Bi(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,ou(e,t,a))}function Vi(e,t,n,r,a,o){if(null===e){var i=n.type;return"function"!==typeof i||Hs(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=qs(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ui(e,t,i,r,a,o))}return i=e.child,0===(a&o)&&(a=i.memoizedProps,(n=null!==(n=n.compare)?n:pr)(a,r)&&e.ref===t.ref)?ou(e,t,o):(t.flags|=1,(e=Ks(i,r)).ref=t.ref,e.return=t,t.child=e)}function Ui(e,t,n,r,a,o){if(null!==e&&pr(e.memoizedProps,r)&&e.ref===t.ref){if(Mi=!1,0===(o&a))return t.lanes=e.lanes,ou(e,t,o);0!==(16384&e.flags)&&(Mi=!0)}return ji(e,t,n,r,o)}function Wi(e,t,n){var r=t.pendingProps,a=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},ks(t,n);else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},ks(t,e),null;t.memoizedState={baseLanes:0},ks(t,null!==o?o.baseLanes:n)}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,ks(t,r);return Bi(e,t,a,n),t.child}function Gi(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function ji(e,t,n,r,a){var o=ga(n)?ma:da.current;return o=va(t,o),oo(t,a),n=ui(e,t,n,r,o,a),null===e||Mi?(t.flags|=1,Bi(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,ou(e,t,a))}function Hi(e,t,n,r,a){if(ga(n)){var o=!0;wa(t)}else o=!1;if(oo(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),bo(t,n,r),ko(t,n,r,a),r=!0;else if(null===e){var i=t.stateNode,u=t.memoizedProps;i.props=u;var s=i.context,c=n.contextType;"object"===typeof c&&null!==c?c=io(c):c=va(t,c=ga(n)?ma:da.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof i.getSnapshotBeforeUpdate;f||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(u!==r||s!==c)&&wo(t,i,r,c),uo=!1;var p=t.memoizedState;i.state=p,ho(t,r,i,a),s=t.memoizedState,u!==r||p!==s||ha.current||uo?("function"===typeof l&&(go(t,n,l,r),s=t.memoizedState),(u=uo||xo(t,n,u,r,p,s,c))?(f||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4)):("function"===typeof i.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=s),i.props=r,i.state=s,i.context=c,r=u):("function"===typeof i.componentDidMount&&(t.flags|=4),r=!1)}else{i=t.stateNode,co(e,t),u=t.memoizedProps,c=t.type===t.elementType?u:$a(t.type,u),i.props=c,f=t.pendingProps,p=i.context,"object"===typeof(s=n.contextType)&&null!==s?s=io(s):s=va(t,s=ga(n)?ma:da.current);var d=n.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(u!==f||p!==s)&&wo(t,i,r,s),uo=!1,p=t.memoizedState,i.state=p,ho(t,r,i,a);var h=t.memoizedState;u!==f||p!==h||ha.current||uo?("function"===typeof d&&(go(t,n,d,r),h=t.memoizedState),(c=uo||xo(t,n,c,r,p,h,s))?(l||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(r,h,s),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(r,h,s)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof i.componentDidUpdate||u===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||u===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=h),i.props=r,i.state=h,i.context=s,r=c):("function"!==typeof i.componentDidUpdate||u===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||u===e.memoizedProps&&p===e.memoizedState||(t.flags|=256),r=!1)}return Ki(e,t,n,r,o,a)}function Ki(e,t,n,r,a,o){Gi(e,t);var i=0!==(64&t.flags);if(!r&&!i)return a&&ka(t,n,!1),ou(e,t,o);r=t.stateNode,Li.current=t;var u=i&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&i?(t.child=To(t,e.child,null,o),t.child=To(t,null,u,o)):Bi(e,t,u,o),t.memoizedState=r.state,a&&ka(t,n,!0),t.child}function qi(e){var t=e.stateNode;t.pendingContext?xa(0,t.pendingContext,t.pendingContext!==t.context):t.context&&xa(0,t.context,!1),Fo(e,t.containerInfo)}var Xi,Yi,Qi,$i={dehydrated:null,retryLane:0};function Ji(e,t,n){var r,a=t.pendingProps,o=Bo.current,i=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(i=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(o|=1),fa(Bo,1&o),null===e?(void 0!==a.fallback&&Ho(t),e=a.children,o=a.fallback,i?(e=Zi(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=$i,e):"number"===typeof a.unstable_expectedLoadTime?(e=Zi(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=$i,t.lanes=33554432,e):((n=Ys({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,i?(a=tu(e,t,a.children,a.fallback,n),i=t.child,o=e.child.memoizedState,i.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},i.childLanes=e.childLanes&~n,t.memoizedState=$i,a):(n=eu(e,t,a.children,n),t.memoizedState=null,n))}function Zi(e,t,n,r){var a=e.mode,o=e.child;return t={mode:"hidden",children:t},0===(2&a)&&null!==o?(o.childLanes=0,o.pendingProps=t):o=Ys(t,a,0,null),n=Xs(n,a,r,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n}function eu(e,t,n,r){var a=e.child;return e=a.sibling,n=Ks(a,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function tu(e,t,n,r,a){var o=t.mode,i=e.child;e=i.sibling;var u={mode:"hidden",children:n};return 0===(2&o)&&t.child!==i?((n=t.child).childLanes=0,n.pendingProps=u,null!==(i=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=i,i.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Ks(i,u),null!==e?r=Ks(e,r):(r=Xs(r,o,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function nu(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ao(e.return,t)}function ru(e,t,n,r,a,o){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,lastEffect:o}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a,i.lastEffect=o)}function au(e,t,n){var r=t.pendingProps,a=r.revealOrder,o=r.tail;if(Bi(e,t,r.children,n),0!==(2&(r=Bo.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&nu(e,n);else if(19===e.tag)nu(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(fa(Bo,r),0===(2&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===zo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),ru(t,!1,a,n,o,t.lastEffect);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===zo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}ru(t,!0,n,null,o,t.lastEffect);break;case"together":ru(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function ou(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Uu|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Ks(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Ks(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function iu(e,t){if(!Wo)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function uu(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return ga(t.type)&&ya(),null;case 3:return Po(),la(ha),la(da),Qo(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(qo(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:Mo(t);var o=Do(Oo.current);if(n=t.type,null!==e&&null!=t.stateNode)Yi(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(i(166));return null}if(e=Do(_o.current),qo(t)){r=t.stateNode,n=t.type;var u=t.memoizedProps;switch(r[Jr]=t,r[Zr]=u,n){case"dialog":_r("cancel",r),_r("close",r);break;case"iframe":case"object":case"embed":_r("load",r);break;case"video":case"audio":for(e=0;e<Nr.length;e++)_r(Nr[e],r);break;case"source":_r("error",r);break;case"img":case"image":case"link":_r("error",r),_r("load",r);break;case"details":_r("toggle",r);break;case"input":ee(r,u),_r("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!u.multiple},_r("invalid",r);break;case"textarea":se(r,u),_r("invalid",r)}for(var c in Ee(n,u),e=null,u)u.hasOwnProperty(c)&&(o=u[c],"children"===c?"string"===typeof o?r.textContent!==o&&(e=["children",o]):"number"===typeof o&&r.textContent!==""+o&&(e=["children",""+o]):s.hasOwnProperty(c)&&null!=o&&"onScroll"===c&&_r("scroll",r));switch(n){case"input":Q(r),re(r,u,!0);break;case"textarea":Q(r),le(r);break;case"select":case"option":break;default:"function"===typeof u.onClick&&(r.onclick=Vr)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(c=9===o.nodeType?o:o.ownerDocument,e===fe&&(e=de(n)),e===fe?"script"===n?((e=c.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=c.createElement(n,{is:r.is}):(e=c.createElement(n),"select"===n&&(c=e,r.multiple?c.multiple=!0:r.size&&(c.size=r.size))):e=c.createElementNS(e,n),e[Jr]=t,e[Zr]=r,Xi(e,t),t.stateNode=e,c=Se(n,r),n){case"dialog":_r("cancel",e),_r("close",e),o=r;break;case"iframe":case"object":case"embed":_r("load",e),o=r;break;case"video":case"audio":for(o=0;o<Nr.length;o++)_r(Nr[o],e);o=r;break;case"source":_r("error",e),o=r;break;case"img":case"image":case"link":_r("error",e),_r("load",e),o=r;break;case"details":_r("toggle",e),o=r;break;case"input":ee(e,r),o=Z(e,r),_r("invalid",e);break;case"option":o=oe(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=a({},r,{value:void 0}),_r("invalid",e);break;case"textarea":se(e,r),o=ue(e,r),_r("invalid",e);break;default:o=r}Ee(n,o);var l=o;for(u in l)if(l.hasOwnProperty(u)){var f=l[u];"style"===u?ke(e,f):"dangerouslySetInnerHTML"===u?null!=(f=f?f.__html:void 0)&&ge(e,f):"children"===u?"string"===typeof f?("textarea"!==n||""!==f)&&ye(e,f):"number"===typeof f&&ye(e,""+f):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(s.hasOwnProperty(u)?null!=f&&"onScroll"===u&&_r("scroll",e):null!=f&&b(e,u,f,c))}switch(n){case"input":Q(e),re(e,r,!1);break;case"textarea":Q(e),le(e);break;case"option":null!=r.value&&e.setAttribute("value",""+X(r.value));break;case"select":e.multiple=!!r.multiple,null!=(u=r.value)?ie(e,!!r.multiple,u,!1):null!=r.defaultValue&&ie(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Vr)}Gr(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Qi(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));n=Do(Oo.current),Do(_o.current),qo(t)?(r=t.stateNode,n=t.memoizedProps,r[Jr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Jr]=t,t.stateNode=r)}return null;case 13:return la(Bo),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&qo(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Bo.current)?0===Bu&&(Bu=3):(0!==Bu&&3!==Bu||(Bu=4),null===Du||0===(134217727&Uu)&&0===(134217727&Wu)||ys(Du,Pu))),(r||n)&&(t.flags|=4),null);case 4:return Po(),null===e&&Or(t.stateNode.containerInfo),null;case 10:return ro(t),null;case 19:if(la(Bo),null===(r=t.memoizedState))return null;if(u=0!==(64&t.flags),null===(c=r.rendering))if(u)iu(r,!1);else{if(0!==Bu||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(c=zo(e))){for(t.flags|=64,iu(r,!1),null!==(u=c.updateQueue)&&(t.updateQueue=u,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(u=n).flags&=2,u.nextEffect=null,u.firstEffect=null,u.lastEffect=null,null===(c=u.alternate)?(u.childLanes=0,u.lanes=e,u.child=null,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=c.childLanes,u.lanes=c.lanes,u.child=c.child,u.memoizedProps=c.memoizedProps,u.memoizedState=c.memoizedState,u.updateQueue=c.updateQueue,u.type=c.type,e=c.dependencies,u.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return fa(Bo,1&Bo.current|2),t.child}e=e.sibling}null!==r.tail&&Ga()>Ku&&(t.flags|=64,u=!0,iu(r,!1),t.lanes=33554432)}else{if(!u)if(null!==(e=zo(c))){if(t.flags|=64,u=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),iu(r,!0),null===r.tail&&"hidden"===r.tailMode&&!c.alternate&&!Wo)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ga()-r.renderingStartTime>Ku&&1073741824!==n&&(t.flags|=64,u=!0,iu(r,!1),t.lanes=33554432);r.isBackwards?(c.sibling=t.child,t.child=c):(null!==(n=r.last)?n.sibling=c:t.child=c,r.last=c)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ga(),n.sibling=null,t=Bo.current,fa(Bo,u?1&t|2:1&t),n):null;case 23:case 24:return Cs(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(i(156,t.tag))}function su(e){switch(e.tag){case 1:ga(e.type)&&ya();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Po(),la(ha),la(da),Qo(),0!==(64&(t=e.flags)))throw Error(i(285));return e.flags=-4097&t|64,e;case 5:return Mo(e),null;case 13:return la(Bo),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return la(Bo),null;case 4:return Po(),null;case 10:return ro(e),null;case 23:case 24:return Cs(),null;default:return null}}function cu(e,t){try{var n="",r=t;do{n+=K(r),r=r.return}while(r);var a=n}catch(o){a="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:a}}function lu(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Xi=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Yi=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Do(_o.current);var i,u=null;switch(n){case"input":o=Z(e,o),r=Z(e,r),u=[];break;case"option":o=oe(e,o),r=oe(e,r),u=[];break;case"select":o=a({},o,{value:void 0}),r=a({},r,{value:void 0}),u=[];break;case"textarea":o=ue(e,o),r=ue(e,r),u=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Vr)}for(f in Ee(n,r),n=null,o)if(!r.hasOwnProperty(f)&&o.hasOwnProperty(f)&&null!=o[f])if("style"===f){var c=o[f];for(i in c)c.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==f&&"children"!==f&&"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&"autoFocus"!==f&&(s.hasOwnProperty(f)?u||(u=[]):(u=u||[]).push(f,null));for(f in r){var l=r[f];if(c=null!=o?o[f]:void 0,r.hasOwnProperty(f)&&l!==c&&(null!=l||null!=c))if("style"===f)if(c){for(i in c)!c.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&c[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(u||(u=[]),u.push(f,n)),n=l;else"dangerouslySetInnerHTML"===f?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(u=u||[]).push(f,l)):"children"===f?"string"!==typeof l&&"number"!==typeof l||(u=u||[]).push(f,""+l):"suppressContentEditableWarning"!==f&&"suppressHydrationWarning"!==f&&(s.hasOwnProperty(f)?(null!=l&&"onScroll"===f&&_r("scroll",e),u||c===l||(u=[])):"object"===typeof l&&null!==l&&l.$$typeof===P?l.toString():(u=u||[]).push(f,l))}n&&(u=u||[]).push("style",n);var f=u;(t.updateQueue=f)&&(t.flags|=4)}},Qi=function(e,t,n,r){n!==r&&(t.flags|=4)};var fu="function"===typeof WeakMap?WeakMap:Map;function pu(e,t,n){(n=lo(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Qu||(Qu=!0,$u=r),lu(0,t)},n}function du(e,t,n){(n=lo(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return lu(0,t),r(a)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Ju?Ju=new Set([this]):Ju.add(this),lu(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var hu="function"===typeof WeakSet?WeakSet:Set;function mu(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){Vs(e,n)}else t.current=null}function vu(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:$a(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&qr(t.stateNode.containerInfo))}throw Error(i(163))}function gu(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var a=e;r=a.next,0!==(4&(a=a.tag))&&0!==(1&a)&&(Ms(n,e),Ls(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:$a(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&mo(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:case 1:e=n.child.stateNode}mo(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Gr(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&kt(n)))))}throw Error(i(163))}function yu(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var a=n.memoizedProps.style;a=void 0!==a&&null!==a&&a.hasOwnProperty("display")?a.display:null,r.style.display=we("display",a)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function xu(e,t){if(Ea&&"function"===typeof Ea.onCommitFiberUnmount)try{Ea.onCommitFiberUnmount(Ca,t)}catch(o){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,a=r.destroy;if(r=r.tag,void 0!==a)if(0!==(4&r))Ms(t,n);else{r=t;try{a()}catch(o){Vs(r,o)}}n=n.next}while(n!==e)}break;case 1:if(mu(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(o){Vs(t,o)}break;case 5:mu(t);break;case 4:Su(e,t)}}function bu(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function wu(e){return 5===e.tag||3===e.tag||4===e.tag}function ku(e){e:{for(var t=e.return;null!==t;){if(wu(t))break e;t=t.return}throw Error(i(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(i(161))}16&n.flags&&(ye(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||wu(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?Cu(e,n,t):Eu(e,n,t)}function Cu(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Vr));else if(4!==r&&null!==(e=e.child))for(Cu(e,t,n),e=e.sibling;null!==e;)Cu(e,t,n),e=e.sibling}function Eu(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Eu(e,t,n),e=e.sibling;null!==e;)Eu(e,t,n),e=e.sibling}function Su(e,t){for(var n,r,a=t,o=!1;;){if(!o){o=a.return;e:for(;;){if(null===o)throw Error(i(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===a.tag||6===a.tag){e:for(var u=e,s=a,c=s;;)if(xu(u,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===s)break e;for(;null===c.sibling;){if(null===c.return||c.return===s)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}r?(u=n,s=a.stateNode,8===u.nodeType?u.parentNode.removeChild(s):u.removeChild(s)):n.removeChild(a.stateNode)}else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(xu(e,a),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(o=!1)}a.sibling.return=a.return,a=a.sibling}}function Nu(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:case 12:case 17:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var a=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[Zr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Se(e,a),t=Se(e,r),a=0;a<o.length;a+=2){var u=o[a],s=o[a+1];"style"===u?ke(n,s):"dangerouslySetInnerHTML"===u?ge(n,s):"children"===u?ye(n,s):b(n,u,s,t)}switch(e){case"input":ne(n,r);break;case"textarea":ce(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?ie(n,!!r.multiple,o,!1):e!==!!r.multiple&&(null!=r.defaultValue?ie(n,!!r.multiple,r.defaultValue,!0):ie(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(i(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,kt(n.containerInfo)));case 13:return null!==t.memoizedState&&(Hu=Ga(),yu(t.child,!0)),void Tu(t);case 19:return void Tu(t);case 23:case 24:return void yu(t,null!==t.memoizedState)}throw Error(i(163))}function Tu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new hu),t.forEach((function(t){var r=Ws.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Ru(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Iu=Math.ceil,_u=w.ReactCurrentDispatcher,Au=w.ReactCurrentOwner,Ou=0,Du=null,Fu=null,Pu=0,Lu=0,Mu=ca(0),Bu=0,zu=null,Vu=0,Uu=0,Wu=0,Gu=0,ju=null,Hu=0,Ku=1/0;function qu(){Ku=Ga()+500}var Xu,Yu=null,Qu=!1,$u=null,Ju=null,Zu=!1,es=null,ts=90,ns=[],rs=[],as=null,os=0,is=null,us=-1,ss=0,cs=0,ls=null,fs=!1;function ps(){return 0!==(48&Ou)?Ga():-1!==us?us:us=Ga()}function ds(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===ja()?1:2;if(0===ss&&(ss=Vu),0!==Qa.transition){0!==cs&&(cs=null!==ju?ju.pendingLanes:0),e=ss;var t=4186112&~cs;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=ja(),0!==(4&Ou)&&98===e?e=Vt(12,ss):e=Vt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ss),e}function hs(e,t,n){if(50<os)throw os=0,is=null,Error(i(185));if(null===(e=ms(e,t)))return null;Gt(e,t,n),e===Du&&(Wu|=t,4===Bu&&ys(e,Pu));var r=ja();1===t?0!==(8&Ou)&&0===(48&Ou)?xs(e):(vs(e,n),0===Ou&&(qu(),Xa())):(0===(4&Ou)||98!==r&&99!==r||(null===as?as=new Set([e]):as.add(e)),vs(e,n)),ju=e}function ms(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function vs(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,a=e.pingedLanes,o=e.expirationTimes,u=e.pendingLanes;0<u;){var s=31-jt(u),c=1<<s,l=o[s];if(-1===l){if(0===(c&r)||0!==(c&a)){l=t,Mt(c);var f=Lt;o[s]=10<=f?l+250:6<=f?l+5e3:-1}}else l<=t&&(e.expiredLanes|=c);u&=~c}if(r=Bt(e,e===Du?Pu:0),t=Lt,0===r)null!==n&&(n!==Ma&&Ta(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Ma&&Ta(n)}15===t?(n=xs.bind(null,e),null===za?(za=[n],Va=Na(Oa,Ya)):za.push(n),n=Ma):14===t?n=qa(99,xs.bind(null,e)):(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(i(358,e))}}(t),n=qa(n,gs.bind(null,e))),e.callbackPriority=t,e.callbackNode=n}}function gs(e){if(us=-1,cs=ss=0,0!==(48&Ou))throw Error(i(327));var t=e.callbackNode;if(Ps()&&e.callbackNode!==t)return null;var n=Bt(e,e===Du?Pu:0);if(0===n)return null;var r=n,a=Ou;Ou|=16;var o=Ns();for(Du===e&&Pu===r||(qu(),Es(e,r));;)try{Is();break}catch(s){Ss(e,s)}if(no(),_u.current=o,Ou=a,null!==Fu?r=0:(Du=null,Pu=0,r=Bu),0!==(Vu&Wu))Es(e,0);else if(0!==r){if(2===r&&(Ou|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(n=zt(e))&&(r=Ts(e,n))),1===r)throw t=zu,Es(e,0),ys(e,n),vs(e,Ga()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(i(345));case 2:case 5:Os(e);break;case 3:if(ys(e,n),(62914560&n)===n&&10<(r=Hu+500-Ga())){if(0!==Bt(e,0))break;if(((a=e.suspendedLanes)&n)!==n){ps(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=Hr(Os.bind(null,e),r);break}Os(e);break;case 4:if(ys(e,n),(4186112&n)===n)break;for(r=e.eventTimes,a=-1;0<n;){var u=31-jt(n);o=1<<u,(u=r[u])>a&&(a=u),n&=~o}if(n=a,10<(n=(120>(n=Ga()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Iu(n/1960))-n)){e.timeoutHandle=Hr(Os.bind(null,e),n);break}Os(e);break;default:throw Error(i(329))}}return vs(e,Ga()),e.callbackNode===t?gs.bind(null,e):null}function ys(e,t){for(t&=~Gu,t&=~Wu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-jt(t),r=1<<n;e[n]=-1,t&=~r}}function xs(e){if(0!==(48&Ou))throw Error(i(327));if(Ps(),e===Du&&0!==(e.expiredLanes&Pu)){var t=Pu,n=Ts(e,t);0!==(Vu&Wu)&&(n=Ts(e,t=Bt(e,t)))}else n=Ts(e,t=Bt(e,0));if(0!==e.tag&&2===n&&(Ou|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(t=zt(e))&&(n=Ts(e,t))),1===n)throw n=zu,Es(e,0),ys(e,t),vs(e,Ga()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Os(e),vs(e,Ga()),null}function bs(e,t){var n=Ou;Ou|=1;try{return e(t)}finally{0===(Ou=n)&&(qu(),Xa())}}function ws(e,t){var n=Ou;Ou&=-2,Ou|=8;try{return e(t)}finally{0===(Ou=n)&&(qu(),Xa())}}function ks(e,t){fa(Mu,Lu),Lu|=t,Vu|=t}function Cs(){Lu=Mu.current,la(Mu)}function Es(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Kr(n)),null!==Fu)for(n=Fu.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&ya();break;case 3:Po(),la(ha),la(da),Qo();break;case 5:Mo(r);break;case 4:Po();break;case 13:case 19:la(Bo);break;case 10:ro(r);break;case 23:case 24:Cs()}n=n.return}Du=e,Fu=Ks(e.current,null),Pu=Lu=Vu=t,Bu=0,zu=null,Gu=Wu=Uu=0}function Ss(e,t){for(;;){var n=Fu;try{if(no(),$o.current=Oi,ri){for(var r=ei.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}ri=!1}if(Zo=0,ni=ti=ei=null,ai=!1,Au.current=null,null===n||null===n.return){Bu=1,zu=t,Fu=null;break}e:{var o=e,i=n.return,u=n,s=t;if(t=Pu,u.flags|=2048,u.firstEffect=u.lastEffect=null,null!==s&&"object"===typeof s&&"function"===typeof s.then){var c=s;if(0===(2&u.mode)){var l=u.alternate;l?(u.updateQueue=l.updateQueue,u.memoizedState=l.memoizedState,u.lanes=l.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=0!==(1&Bo.current),p=i;do{var d;if(d=13===p.tag){var h=p.memoizedState;if(null!==h)d=null!==h.dehydrated;else{var m=p.memoizedProps;d=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!f)}}if(d){var v=p.updateQueue;if(null===v){var g=new Set;g.add(c),p.updateQueue=g}else v.add(c);if(0===(2&p.mode)){if(p.flags|=64,u.flags|=16384,u.flags&=-2981,1===u.tag)if(null===u.alternate)u.tag=17;else{var y=lo(-1,1);y.tag=2,fo(u,y)}u.lanes|=1;break e}s=void 0,u=t;var x=o.pingCache;if(null===x?(x=o.pingCache=new fu,s=new Set,x.set(c,s)):void 0===(s=x.get(c))&&(s=new Set,x.set(c,s)),!s.has(u)){s.add(u);var b=Us.bind(null,o,c,u);c.then(b,b)}p.flags|=4096,p.lanes=t;break e}p=p.return}while(null!==p);s=Error((q(u.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Bu&&(Bu=2),s=cu(s,u),p=i;do{switch(p.tag){case 3:o=s,p.flags|=4096,t&=-t,p.lanes|=t,po(p,pu(0,o,t));break e;case 1:o=s;var w=p.type,k=p.stateNode;if(0===(64&p.flags)&&("function"===typeof w.getDerivedStateFromError||null!==k&&"function"===typeof k.componentDidCatch&&(null===Ju||!Ju.has(k)))){p.flags|=4096,t&=-t,p.lanes|=t,po(p,du(p,o,t));break e}}p=p.return}while(null!==p)}As(n)}catch(C){t=C,Fu===n&&null!==n&&(Fu=n=n.return);continue}break}}function Ns(){var e=_u.current;return _u.current=Oi,null===e?Oi:e}function Ts(e,t){var n=Ou;Ou|=16;var r=Ns();for(Du===e&&Pu===t||Es(e,t);;)try{Rs();break}catch(a){Ss(e,a)}if(no(),Ou=n,_u.current=r,null!==Fu)throw Error(i(261));return Du=null,Pu=0,Bu}function Rs(){for(;null!==Fu;)_s(Fu)}function Is(){for(;null!==Fu&&!Ra();)_s(Fu)}function _s(e){var t=Xu(e.alternate,e,Lu);e.memoizedProps=e.pendingProps,null===t?As(e):Fu=t,Au.current=null}function As(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=uu(n,t,Lu)))return void(Fu=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Lu)||0===(4&n.mode)){for(var r=0,a=n.child;null!==a;)r|=a.lanes|a.childLanes,a=a.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=su(t)))return n.flags&=2047,void(Fu=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Fu=t);Fu=t=e}while(null!==t);0===Bu&&(Bu=5)}function Os(e){var t=ja();return Ka(99,Ds.bind(null,e,t)),null}function Ds(e,t){do{Ps()}while(null!==es);if(0!==(48&Ou))throw Error(i(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null;var r=n.lanes|n.childLanes,a=r,o=e.pendingLanes&~a;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=a,e.mutableReadLanes&=a,e.entangledLanes&=a,a=e.entanglements;for(var u=e.eventTimes,s=e.expirationTimes;0<o;){var c=31-jt(o),l=1<<c;a[c]=0,u[c]=-1,s[c]=-1,o&=~l}if(null!==as&&0===(24&r)&&as.has(e)&&as.delete(e),e===Du&&(Fu=Du=null,Pu=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(a=Ou,Ou|=32,Au.current=null,Ur=Yt,gr(u=vr())){if("selectionStart"in u)s={start:u.selectionStart,end:u.selectionEnd};else e:if(s=(s=u.ownerDocument)&&s.defaultView||window,(l=s.getSelection&&s.getSelection())&&0!==l.rangeCount){s=l.anchorNode,o=l.anchorOffset,c=l.focusNode,l=l.focusOffset;try{s.nodeType,c.nodeType}catch(N){s=null;break e}var f=0,p=-1,d=-1,h=0,m=0,v=u,g=null;t:for(;;){for(var y;v!==s||0!==o&&3!==v.nodeType||(p=f+o),v!==c||0!==l&&3!==v.nodeType||(d=f+l),3===v.nodeType&&(f+=v.nodeValue.length),null!==(y=v.firstChild);)g=v,v=y;for(;;){if(v===u)break t;if(g===s&&++h===o&&(p=f),g===c&&++m===l&&(d=f),null!==(y=v.nextSibling))break;g=(v=g).parentNode}v=y}s=-1===p||-1===d?null:{start:p,end:d}}else s=null;s=s||{start:0,end:0}}else s=null;Wr={focusedElem:u,selectionRange:s},Yt=!1,ls=null,fs=!1,Yu=r;do{try{Fs()}catch(N){if(null===Yu)throw Error(i(330));Vs(Yu,N),Yu=Yu.nextEffect}}while(null!==Yu);ls=null,Yu=r;do{try{for(u=e;null!==Yu;){var x=Yu.flags;if(16&x&&ye(Yu.stateNode,""),128&x){var b=Yu.alternate;if(null!==b){var w=b.ref;null!==w&&("function"===typeof w?w(null):w.current=null)}}switch(1038&x){case 2:ku(Yu),Yu.flags&=-3;break;case 6:ku(Yu),Yu.flags&=-3,Nu(Yu.alternate,Yu);break;case 1024:Yu.flags&=-1025;break;case 1028:Yu.flags&=-1025,Nu(Yu.alternate,Yu);break;case 4:Nu(Yu.alternate,Yu);break;case 8:Su(u,s=Yu);var k=s.alternate;bu(s),null!==k&&bu(k)}Yu=Yu.nextEffect}}catch(N){if(null===Yu)throw Error(i(330));Vs(Yu,N),Yu=Yu.nextEffect}}while(null!==Yu);if(w=Wr,b=vr(),x=w.focusedElem,u=w.selectionRange,b!==x&&x&&x.ownerDocument&&mr(x.ownerDocument.documentElement,x)){null!==u&&gr(x)&&(b=u.start,void 0===(w=u.end)&&(w=b),"selectionStart"in x?(x.selectionStart=b,x.selectionEnd=Math.min(w,x.value.length)):(w=(b=x.ownerDocument||document)&&b.defaultView||window).getSelection&&(w=w.getSelection(),s=x.textContent.length,k=Math.min(u.start,s),u=void 0===u.end?k:Math.min(u.end,s),!w.extend&&k>u&&(s=u,u=k,k=s),s=hr(x,k),o=hr(x,u),s&&o&&(1!==w.rangeCount||w.anchorNode!==s.node||w.anchorOffset!==s.offset||w.focusNode!==o.node||w.focusOffset!==o.offset)&&((b=b.createRange()).setStart(s.node,s.offset),w.removeAllRanges(),k>u?(w.addRange(b),w.extend(o.node,o.offset)):(b.setEnd(o.node,o.offset),w.addRange(b))))),b=[];for(w=x;w=w.parentNode;)1===w.nodeType&&b.push({element:w,left:w.scrollLeft,top:w.scrollTop});for("function"===typeof x.focus&&x.focus(),x=0;x<b.length;x++)(w=b[x]).element.scrollLeft=w.left,w.element.scrollTop=w.top}Yt=!!Ur,Wr=Ur=null,e.current=n,Yu=r;do{try{for(x=e;null!==Yu;){var C=Yu.flags;if(36&C&&gu(x,Yu.alternate,Yu),128&C){b=void 0;var E=Yu.ref;if(null!==E){var S=Yu.stateNode;Yu.tag,b=S,"function"===typeof E?E(b):E.current=b}}Yu=Yu.nextEffect}}catch(N){if(null===Yu)throw Error(i(330));Vs(Yu,N),Yu=Yu.nextEffect}}while(null!==Yu);Yu=null,Ba(),Ou=a}else e.current=n;if(Zu)Zu=!1,es=e,ts=t;else for(Yu=r;null!==Yu;)t=Yu.nextEffect,Yu.nextEffect=null,8&Yu.flags&&((C=Yu).sibling=null,C.stateNode=null),Yu=t;if(0===(r=e.pendingLanes)&&(Ju=null),1===r?e===is?os++:(os=0,is=e):os=0,n=n.stateNode,Ea&&"function"===typeof Ea.onCommitFiberRoot)try{Ea.onCommitFiberRoot(Ca,n,void 0,64===(64&n.current.flags))}catch(N){}if(vs(e,Ga()),Qu)throw Qu=!1,e=$u,$u=null,e;return 0!==(8&Ou)||Xa(),null}function Fs(){for(;null!==Yu;){var e=Yu.alternate;fs||null===ls||(0!==(8&Yu.flags)?et(Yu,ls)&&(fs=!0):13===Yu.tag&&Ru(e,Yu)&&et(Yu,ls)&&(fs=!0));var t=Yu.flags;0!==(256&t)&&vu(e,Yu),0===(512&t)||Zu||(Zu=!0,qa(97,(function(){return Ps(),null}))),Yu=Yu.nextEffect}}function Ps(){if(90!==ts){var e=97<ts?97:ts;return ts=90,Ka(e,Bs)}return!1}function Ls(e,t){ns.push(t,e),Zu||(Zu=!0,qa(97,(function(){return Ps(),null})))}function Ms(e,t){rs.push(t,e),Zu||(Zu=!0,qa(97,(function(){return Ps(),null})))}function Bs(){if(null===es)return!1;var e=es;if(es=null,0!==(48&Ou))throw Error(i(331));var t=Ou;Ou|=32;var n=rs;rs=[];for(var r=0;r<n.length;r+=2){var a=n[r],o=n[r+1],u=a.destroy;if(a.destroy=void 0,"function"===typeof u)try{u()}catch(c){if(null===o)throw Error(i(330));Vs(o,c)}}for(n=ns,ns=[],r=0;r<n.length;r+=2){a=n[r],o=n[r+1];try{var s=a.create;a.destroy=s()}catch(c){if(null===o)throw Error(i(330));Vs(o,c)}}for(s=e.current.firstEffect;null!==s;)e=s.nextEffect,s.nextEffect=null,8&s.flags&&(s.sibling=null,s.stateNode=null),s=e;return Ou=t,Xa(),!0}function zs(e,t,n){fo(e,t=pu(0,t=cu(n,t),1)),t=ps(),null!==(e=ms(e,1))&&(Gt(e,1,t),vs(e,t))}function Vs(e,t){if(3===e.tag)zs(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){zs(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ju||!Ju.has(r))){var a=du(n,e=cu(t,e),1);if(fo(n,a),a=ps(),null!==(n=ms(n,1)))Gt(n,1,a),vs(n,a);else if("function"===typeof r.componentDidCatch&&(null===Ju||!Ju.has(r)))try{r.componentDidCatch(t,e)}catch(o){}break}}n=n.return}}function Us(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ps(),e.pingedLanes|=e.suspendedLanes&n,Du===e&&(Pu&n)===n&&(4===Bu||3===Bu&&(62914560&Pu)===Pu&&500>Ga()-Hu?Es(e,0):Gu|=n),vs(e,t)}function Ws(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===ja()?1:2:(0===ss&&(ss=Vu),0===(t=Ut(62914560&~ss))&&(t=4194304))),n=ps(),null!==(e=ms(e,t))&&(Gt(e,t,n),vs(e,n))}function Gs(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function js(e,t,n,r){return new Gs(e,t,n,r)}function Hs(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Ks(e,t){var n=e.alternate;return null===n?((n=js(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function qs(e,t,n,r,a,o){var u=2;if(r=e,"function"===typeof e)Hs(e)&&(u=1);else if("string"===typeof e)u=5;else e:switch(e){case E:return Xs(n.children,a,o,t);case L:u=8,a|=16;break;case S:u=8,a|=1;break;case N:return(e=js(12,n,t,8|a)).elementType=N,e.type=N,e.lanes=o,e;case _:return(e=js(13,n,t,a)).type=_,e.elementType=_,e.lanes=o,e;case A:return(e=js(19,n,t,a)).elementType=A,e.lanes=o,e;case M:return Ys(n,a,o,t);case B:return(e=js(24,n,t,a)).elementType=B,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:u=10;break e;case R:u=9;break e;case I:u=11;break e;case O:u=14;break e;case D:u=16,r=null;break e;case F:u=22;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=js(u,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Xs(e,t,n,r){return(e=js(7,e,r,t)).lanes=n,e}function Ys(e,t,n,r){return(e=js(23,e,r,t)).elementType=M,e.lanes=n,e}function Qs(e,t,n){return(e=js(6,e,null,t)).lanes=n,e}function $s(e,t,n){return(t=js(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Js(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Wt(0),this.expirationTimes=Wt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wt(0),this.mutableSourceEagerHydrationData=null}function Zs(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:C,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function ec(e,t,n,r){var a=t.current,o=ps(),u=ds(a);e:if(n){t:{if(Qe(n=n._reactInternals)!==n||1!==n.tag)throw Error(i(170));var s=n;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(ga(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(i(171))}if(1===n.tag){var c=n.type;if(ga(c)){n=ba(n,c,s);break e}}n=s}else n=pa;return null===t.context?t.context=n:t.pendingContext=n,(t=lo(o,u)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),fo(a,t),hs(a,u,o),u}function tc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function nc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function rc(e,t){nc(e,t),(e=e.alternate)&&nc(e,t)}function ac(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Js(e,t,null!=n&&!0===n.hydrate),t=js(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,so(t),e[ea]=n.current,Or(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var a=(t=r[e])._getVersion;a=a(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,a]:n.mutableSourceEagerHydrationData.push(t,a)}this._internalRoot=n}function oc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ic(e,t,n,r,a){var o=n._reactRootContainer;if(o){var i=o._internalRoot;if("function"===typeof a){var u=a;a=function(){var e=tc(i);u.call(e)}}ec(t,i,e,a)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new ac(e,0,t?{hydrate:!0}:void 0)}(n,r),i=o._internalRoot,"function"===typeof a){var s=a;a=function(){var e=tc(i);s.call(e)}}ws((function(){ec(t,i,e,a)}))}return tc(i)}function uc(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!oc(t))throw Error(i(200));return Zs(e,t,null,n)}Xu=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||ha.current)Mi=!0;else{if(0===(n&r)){switch(Mi=!1,t.tag){case 3:qi(t),Xo();break;case 5:Lo(t);break;case 1:ga(t.type)&&wa(t);break;case 4:Fo(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var a=t.type._context;fa(Ja,a._currentValue),a._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Ji(e,t,n):(fa(Bo,1&Bo.current),null!==(t=ou(e,t,n))?t.sibling:null);fa(Bo,1&Bo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return au(e,t,n);t.flags|=64}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),fa(Bo,Bo.current),r)break;return null;case 23:case 24:return t.lanes=0,Wi(e,t,n)}return ou(e,t,n)}Mi=0!==(16384&e.flags)}else Mi=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=va(t,da.current),oo(t,n),a=ui(null,t,r,e,a,n),t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,ga(r)){var o=!0;wa(t)}else o=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,so(t);var u=r.getDerivedStateFromProps;"function"===typeof u&&go(t,r,u,e),a.updater=yo,t.stateNode=a,a._reactInternals=t,ko(t,r,e,n),t=Ki(null,t,r,!0,o,n)}else t.tag=0,Bi(null,t,a,n),t=t.child;return t;case 16:a=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=(o=a._init)(a._payload),t.type=a,o=t.tag=function(e){if("function"===typeof e)return Hs(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===O)return 14}return 2}(a),e=$a(a,e),o){case 0:t=ji(null,t,a,e,n);break e;case 1:t=Hi(null,t,a,e,n);break e;case 11:t=zi(null,t,a,e,n);break e;case 14:t=Vi(null,t,a,$a(a.type,e),r,n);break e}throw Error(i(306,a,""))}return t;case 0:return r=t.type,a=t.pendingProps,ji(e,t,r,a=t.elementType===r?a:$a(r,a),n);case 1:return r=t.type,a=t.pendingProps,Hi(e,t,r,a=t.elementType===r?a:$a(r,a),n);case 3:if(qi(t),r=t.updateQueue,null===e||null===r)throw Error(i(282));if(r=t.pendingProps,a=null!==(a=t.memoizedState)?a.element:null,co(e,t),ho(t,r,null,n),(r=t.memoizedState.element)===a)Xo(),t=ou(e,t,n);else{if((o=(a=t.stateNode).hydrate)&&(Uo=Xr(t.stateNode.containerInfo.firstChild),Vo=t,o=Wo=!0),o){if(null!=(e=a.mutableSourceEagerHydrationData))for(a=0;a<e.length;a+=2)(o=e[a])._workInProgressVersionPrimary=e[a+1],Yo.push(o);for(n=Ro(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Bi(e,t,r,n),Xo();t=t.child}return t;case 5:return Lo(t),null===e&&Ho(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,u=a.children,jr(r,a)?u=null:null!==o&&jr(r,o)&&(t.flags|=16),Gi(e,t),Bi(e,t,u,n),t.child;case 6:return null===e&&Ho(t),null;case 13:return Ji(e,t,n);case 4:return Fo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=To(t,null,r,n):Bi(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,zi(e,t,r,a=t.elementType===r?a:$a(r,a),n);case 7:return Bi(e,t,t.pendingProps,n),t.child;case 8:case 12:return Bi(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,a=t.pendingProps,u=t.memoizedProps,o=a.value;var s=t.type._context;if(fa(Ja,s._currentValue),s._currentValue=o,null!==u)if(s=u.value,0===(o=lr(s,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(s,o):1073741823))){if(u.children===a.children&&!ha.current){t=ou(e,t,n);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){u=s.child;for(var l=c.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&o)){1===s.tag&&((l=lo(-1,n&-n)).tag=2,fo(s,l)),s.lanes|=n,null!==(l=s.alternate)&&(l.lanes|=n),ao(s.return,n),c.lanes|=n;break}l=l.next}}else u=10===s.tag&&s.type===t.type?null:s.child;if(null!==u)u.return=s;else for(u=s;null!==u;){if(u===t){u=null;break}if(null!==(s=u.sibling)){s.return=u.return,u=s;break}u=u.return}s=u}Bi(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=(o=t.pendingProps).children,oo(t,n),r=r(a=io(a,o.unstable_observedBits)),t.flags|=1,Bi(e,t,r,n),t.child;case 14:return o=$a(a=t.type,t.pendingProps),Vi(e,t,a,o=$a(a.type,o),r,n);case 15:return Ui(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:$a(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,ga(r)?(e=!0,wa(t)):e=!1,oo(t,n),bo(t,r,a),ko(t,r,a,n),Ki(null,t,r,!0,e,n);case 19:return au(e,t,n);case 23:case 24:return Wi(e,t,n)}throw Error(i(156,t.tag))},ac.prototype.render=function(e){ec(e,this._internalRoot,null,null)},ac.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;ec(null,e,null,(function(){t[ea]=null}))},tt=function(e){13===e.tag&&(hs(e,4,ps()),rc(e,4))},nt=function(e){13===e.tag&&(hs(e,67108864,ps()),rc(e,67108864))},rt=function(e){if(13===e.tag){var t=ps(),n=ds(e);hs(e,n,t),rc(e,n)}},at=function(e,t){return t()},Te=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=oa(r);if(!a)throw Error(i(90));$(r),ne(r,a)}}}break;case"textarea":ce(e,n);break;case"select":null!=(t=n.value)&&ie(e,!!n.multiple,t,!1)}},De=bs,Fe=function(e,t,n,r,a){var o=Ou;Ou|=4;try{return Ka(98,e.bind(null,t,n,r,a))}finally{0===(Ou=o)&&(qu(),Xa())}},Pe=function(){0===(49&Ou)&&(function(){if(null!==as){var e=as;as=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,vs(e,Ga())}))}Xa()}(),Ps())},Le=function(e,t){var n=Ou;Ou|=2;try{return e(t)}finally{0===(Ou=n)&&(qu(),Xa())}};var sc={Events:[ra,aa,oa,Ae,Oe,Ps,{current:!1}]},cc={findFiberByHostInstance:na,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},lc={bundleType:cc.bundleType,version:cc.version,rendererPackageName:cc.rendererPackageName,rendererConfig:cc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:cc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var fc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fc.isDisabled&&fc.supportsFiber)try{Ca=fc.inject(lc),Ea=fc}catch(ve){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sc,t.createPortal=uc,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw Error(i(268,Object.keys(e)))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e,t){var n=Ou;if(0!==(48&n))return e(t);Ou|=1;try{if(e)return Ka(99,e.bind(null,t))}finally{Ou=n,Xa()}},t.hydrate=function(e,t,n){if(!oc(t))throw Error(i(200));return ic(null,e,t,!0,n)},t.render=function(e,t,n){if(!oc(t))throw Error(i(200));return ic(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!oc(e))throw Error(i(40));return!!e._reactRootContainer&&(ws((function(){ic(null,null,e,!1,(function(){e._reactRootContainer=null,e[ea]=null}))})),!0)},t.unstable_batchedUpdates=bs,t.unstable_createPortal=function(e,t){return uc(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!oc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return ic(e,t,n,!1,r)},t.version="17.0.2"},164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},97:function(e,t,n){var r;r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,n){"use strict";n.r(t);var r=n("react"),a=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},e(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=function(){return o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},o.apply(this,arguments)},i=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n};function u(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise((function(n,r){t.call(navigator,e,n,r)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var s=function(e){function t(t){var n=e.call(this,t)||this;return n.canvas=null,n.ctx=null,n.requestUserMediaId=0,n.unmounted=!1,n.state={hasUserMedia:!1},n}return a(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;u()?(e.hasUserMedia||this.requestUserMedia(),t.children&&"function"!=typeof t.children&&console.warn("children must be a function")):t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(u()){var n=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),r=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),a=e.minScreenshotWidth!==t.minScreenshotWidth,o=e.minScreenshotHeight!==t.minScreenshotHeight;(r||a||o)&&(this.canvas=null,this.ctx=null),(n||r)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map((function(t){e.removeTrack(t),t.stop()})),e.getAudioTracks().map((function(t){e.removeTrack(t),t.stop()}))):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,n=this.props;if(!t.hasUserMedia)return null;var r=this.getCanvas(e);return r&&r.toDataURL(n.screenshotFormat,n.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,n=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var r=this.video.videoWidth,a=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var o=r/a;a=(r=n.minScreenshotWidth||this.video.clientWidth)/o,n.minScreenshotHeight&&a<n.minScreenshotHeight&&(r=(a=n.minScreenshotHeight)*o)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||r,this.canvas.height=(null===e||void 0===e?void 0:e.height)||a,this.ctx=this.canvas.getContext("2d")}var i=this.ctx,u=this.canvas;return i&&u&&(n.mirrored&&(i.translate(u.width,0),i.scale(-1,1)),i.imageSmoothingEnabled=n.imageSmoothing,i.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||u.width,(null===e||void 0===e?void 0:e.height)||u.height),n.mirrored&&(i.scale(-1,1),i.translate(-u.width,0))),u},t.prototype.requestUserMedia=function(){var e=this,n=this.props,r=function(r,a){var o={video:"undefined"===typeof a||a};n.audio&&(o.audio="undefined"===typeof r||r),e.requestUserMediaId++;var i=e.requestUserMediaId;navigator.mediaDevices.getUserMedia(o).then((function(n){e.unmounted||i!==e.requestUserMediaId?t.stopMediaStream(n):e.handleUserMedia(null,n)})).catch((function(t){e.handleUserMedia(t)}))};if("mediaDevices"in navigator)r(n.audioConstraints,n.videoConstraints);else{var a=function(e){return{optional:[{sourceId:e}]}},o=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources((function(e){var t=null,i=null;e.forEach((function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(i=e.id)}));var u=o(n.audioConstraints);u&&(t=u);var s=o(n.videoConstraints);s&&(i=s),r(a(t),a(i))}))}},t.prototype.handleUserMedia=function(e,t){var n=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void n.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(r){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}n.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,n=this.props,a=n.audio,u=(n.forceScreenshotSourceSize,n.onUserMedia,n.onUserMediaError,n.screenshotFormat,n.screenshotQuality,n.minScreenshotWidth,n.minScreenshotHeight,n.audioConstraints,n.videoConstraints,n.imageSmoothing,n.mirrored),s=n.style,c=void 0===s?{}:s,l=n.children,f=i(n,["audio","forceScreenshotSourceSize","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style","children"]),p=u?o(o({},c),{transform:(c.transform||"")+" scaleX(-1)"}):c,d={getScreenshot:this.getScreenshot.bind(this)};return r.createElement(r.Fragment,null,r.createElement("video",o({autoPlay:!0,src:t.src,muted:!a,playsInline:!0,ref:function(t){e.video=t},style:p},f)),l&&l(d))},t.defaultProps={audio:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(r.Component);t.default=s},react:function(t,n){t.exports=e}}).default},e.exports=r(n(791))},374:function(e,t,n){"use strict";n(725);var r=n(791),a=60103;if(60107,"function"===typeof Symbol&&Symbol.for){var o=Symbol.for;a=o("react.element"),o("react.fragment")}var i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u=Object.prototype.hasOwnProperty,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,o={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)u.call(t,r)&&!s.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:o,_owner:i.current}}t.jsx=c,t.jsxs=c},117:function(e,t,n){"use strict";var r=n(725),a=60103,o=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var i=60109,u=60110,s=60112;t.Suspense=60113;var c=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var f=Symbol.for;a=f("react.element"),o=f("react.portal"),t.Fragment=f("react.fragment"),t.StrictMode=f("react.strict_mode"),t.Profiler=f("react.profiler"),i=f("react.provider"),u=f("react.context"),s=f("react.forward_ref"),t.Suspense=f("react.suspense"),c=f("react.memo"),l=f("react.lazy")}var p="function"===typeof Symbol&&Symbol.iterator;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m={};function v(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}function g(){}function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||h}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(d(85));this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=v.prototype;var x=y.prototype=new g;x.constructor=y,r(x,v.prototype),x.isPureReactComponent=!0;var b={current:null},w=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,n){var r,o={},i=null,u=null;if(null!=t)for(r in void 0!==t.ref&&(u=t.ref),void 0!==t.key&&(i=""+t.key),t)w.call(t,r)&&!k.hasOwnProperty(r)&&(o[r]=t[r]);var s=arguments.length-2;if(1===s)o.children=n;else if(1<s){for(var c=Array(s),l=0;l<s;l++)c[l]=arguments[l+2];o.children=c}if(e&&e.defaultProps)for(r in s=e.defaultProps)void 0===o[r]&&(o[r]=s[r]);return{$$typeof:a,type:e,key:i,ref:u,props:o,_owner:b.current}}function E(e){return"object"===typeof e&&null!==e&&e.$$typeof===a}var S=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function T(e,t,n,r,i){var u=typeof e;"undefined"!==u&&"boolean"!==u||(e=null);var s=!1;if(null===e)s=!0;else switch(u){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case a:case o:s=!0}}if(s)return i=i(s=e),e=""===r?"."+N(s,0):r,Array.isArray(i)?(n="",null!=e&&(n=e.replace(S,"$&/")+"/"),T(i,t,n,"",(function(e){return e}))):null!=i&&(E(i)&&(i=function(e,t){return{$$typeof:a,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(S,"$&/")+"/")+e)),t.push(i)),1;if(s=0,r=""===r?".":r+":",Array.isArray(e))for(var c=0;c<e.length;c++){var l=r+N(u=e[c],c);s+=T(u,t,n,l,i)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(u=e.next()).done;)s+=T(u=u.value,t,n,l=r+N(u,c++),i);else if("object"===u)throw t=""+e,Error(d(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return s}function R(e,t,n){if(null==e)return e;var r=[],a=0;return T(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function I(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var _={current:null};function A(){var e=_.current;if(null===e)throw Error(d(321));return e}var O={ReactCurrentDispatcher:_,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!E(e))throw Error(d(143));return e}},t.Component=v,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(d(267,e));var o=r({},e.props),i=e.key,u=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(u=t.ref,s=b.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)w.call(t,l)&&!k.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){c=Array(l);for(var f=0;f<l;f++)c[f]=arguments[f+2];o.children=c}return{$$typeof:a,type:e.type,key:i,ref:u,props:o,_owner:s}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:u,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:s,render:e}},t.isValidElement=E,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:I}},t.memo=function(e,t){return{$$typeof:c,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return A().useCallback(e,t)},t.useContext=function(e,t){return A().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return A().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return A().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return A().useLayoutEffect(e,t)},t.useMemo=function(e,t){return A().useMemo(e,t)},t.useReducer=function(e,t,n){return A().useReducer(e,t,n)},t.useRef=function(e){return A().useRef(e)},t.useState=function(e){return A().useState(e)},t.version="17.0.2"},791:function(e,t,n){"use strict";e.exports=n(117)},184:function(e,t,n){"use strict";e.exports=n(374)},727:function(e){var t=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,a="function"===typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",i=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(A){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof v?t:v,o=Object.create(a.prototype),i=new R(r||[]);return o._invoke=function(e,t,n){var r=f;return function(a,o){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===a)throw o;return _()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var u=S(i,n);if(u){if(u===m)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var s=l(e,t,n);if("normal"===s.type){if(r=n.done?h:p,s.arg===m)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=h,n.method="throw",n.arg=s.arg)}}}(e,n,i),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(A){return{type:"throw",arg:A}}}e.wrap=c;var f="suspendedStart",p="suspendedYield",d="executing",h="completed",m={};function v(){}function g(){}function y(){}var x={};s(x,o,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(I([])));w&&w!==n&&r.call(w,o)&&(x=w);var k=y.prototype=v.prototype=Object.create(x);function C(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(a,o,i,u){var s=l(e[a],e,o);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"===typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,i,u)}),(function(e){n("throw",e,i,u)})):t.resolve(f).then((function(e){c.value=e,i(c)}),(function(e){return n("throw",e,i,u)}))}u(s.arg)}var a;this._invoke=function(e,r){function o(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(o,o):o()}}function S(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,S(e,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var a=l(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,m;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function R(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function I(e){if(e){var n=e[o];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var a=-1,i=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}return{next:_}}function _(){return{value:t,done:!0}}return g.prototype=y,s(k,"constructor",y),s(y,"constructor",g),g.displayName=s(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s(e,u,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},C(E.prototype),s(E.prototype,i,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,a,o){void 0===o&&(o=Promise);var i=new E(c(t,n,r,a),o);return e.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},C(k),s(k,u,"Generator"),s(k,o,(function(){return this})),s(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=I,R.prototype={constructor:R,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return u.type="throw",u.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],u=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;T(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:I(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),m}},e}(e.exports);try{regeneratorRuntime=t}catch(n){"object"===typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},813:function(e,t){"use strict";var n,r,a,o;if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var u=Date,s=u.now();t.unstable_now=function(){return u.now()-s}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var c=null,l=null,f=function e(){if(null!==c)try{var n=t.unstable_now();c(!0,n),c=null}catch(r){throw setTimeout(e,0),r}};n=function(e){null!==c?setTimeout(n,0,e):(c=e,setTimeout(f,0))},r=function(e,t){l=setTimeout(e,t)},a=function(){clearTimeout(l)},t.unstable_shouldYield=function(){return!1},o=t.unstable_forceFrameRate=function(){}}else{var p=window.setTimeout,d=window.clearTimeout;if("undefined"!==typeof console){var h=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof h&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,v=null,g=-1,y=5,x=0;t.unstable_shouldYield=function(){return t.unstable_now()>=x},o=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):y=0<e?Math.floor(1e3/e):5};var b=new MessageChannel,w=b.port2;b.port1.onmessage=function(){if(null!==v){var e=t.unstable_now();x=e+y;try{v(!0,e)?w.postMessage(null):(m=!1,v=null)}catch(n){throw w.postMessage(null),n}}else m=!1},n=function(e){v=e,m||(m=!0,w.postMessage(null))},r=function(e,n){g=p((function(){e(t.unstable_now())}),n)},a=function(){d(g),g=-1}}function k(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,a=e[r];if(!(void 0!==a&&0<S(a,t)))break e;e[r]=t,e[n]=a,n=r}}function C(e){return void 0===(e=e[0])?null:e}function E(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length;r<a;){var o=2*(r+1)-1,i=e[o],u=o+1,s=e[u];if(void 0!==i&&0>S(i,n))void 0!==s&&0>S(s,i)?(e[r]=s,e[u]=n,r=u):(e[r]=i,e[o]=n,r=o);else{if(!(void 0!==s&&0>S(s,n)))break e;e[r]=s,e[u]=n,r=u}}}return t}return null}function S(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var N=[],T=[],R=1,I=null,_=3,A=!1,O=!1,D=!1;function F(e){for(var t=C(T);null!==t;){if(null===t.callback)E(T);else{if(!(t.startTime<=e))break;E(T),t.sortIndex=t.expirationTime,k(N,t)}t=C(T)}}function P(e){if(D=!1,F(e),!O)if(null!==C(N))O=!0,n(L);else{var t=C(T);null!==t&&r(P,t.startTime-e)}}function L(e,n){O=!1,D&&(D=!1,a()),A=!0;var o=_;try{for(F(n),I=C(N);null!==I&&(!(I.expirationTime>n)||e&&!t.unstable_shouldYield());){var i=I.callback;if("function"===typeof i){I.callback=null,_=I.priorityLevel;var u=i(I.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?I.callback=u:I===C(N)&&E(N),F(n)}else E(N);I=C(N)}if(null!==I)var s=!0;else{var c=C(T);null!==c&&r(P,c.startTime-n),s=!1}return s}finally{I=null,_=o,A=!1}}var M=o;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){O||A||(O=!0,n(L))},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_getFirstCallbackNode=function(){return C(N)},t.unstable_next=function(e){switch(_){case 1:case 2:case 3:var t=3;break;default:t=_}var n=_;_=t;try{return e()}finally{_=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=M,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=_;_=e;try{return t()}finally{_=n}},t.unstable_scheduleCallback=function(e,o,i){var u=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?u+i:u:i=u,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:R++,callback:o,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>u?(e.sortIndex=i,k(T,e),null===C(N)&&e===C(T)&&(D?a():D=!0,r(P,i-u))):(e.sortIndex=s,k(N,e),O||A||(O=!0,n(L))),e},t.unstable_wrapCallback=function(e){var t=_;return function(){var n=_;_=t;try{return e.apply(this,arguments)}finally{_=n}}}},296:function(e,t,n){"use strict";e.exports=n(813)},699:function(e,t,n){var r=n(501),a=n(112),o=n(132),i=n(890),u=n(113),s=n(350),c=n(411);c.alea=r,c.xor128=a,c.xorwow=o,c.xorshift7=i,c.xor4096=u,c.tychei=s,e.exports=c},501:function(e,t,n){var r;!function(e,a,o){function i(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function u(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new i(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.alea=s}(0,e=n.nmd(e),n.amdD)},350:function(e,t,n){var r;!function(e,a,o){function i(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function u(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.tychei=s}(0,e=n.nmd(e),n.amdD)},112:function(e,t,n){var r;!function(e,a,o){function i(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function u(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor128=s}(0,e=n.nmd(e),n.amdD)},113:function(e,t,n){var r;!function(e,a,o){function i(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,o=t.i;return t.w=r=r+1640531527|0,n=a[o+34&127],e=a[o=o+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[o]=n^e,t.i=o,n+(r^r>>>16)|0},function(e,t){var n,r,a,o,i,u=[],s=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,s=Math.max(s,t.length)),a=0,o=-32;o<s;++o)t&&(r^=t.charCodeAt((o+32)%t.length)),0===o&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,o>=0&&(i=i+1640531527|0,a=0==(n=u[127&o]^=r+i)?a+1:0);for(a>=128&&(u[127&(t&&t.length||0)]=-1),a=127,o=512;o>0;--o)r=u[a+34&127],n=u[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,u[a]=r^n;e.w=i,e.X=u,e.i=a}(t,e)}function u(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xor4096=s}(0,e=n.nmd(e),n.amdD)},890:function(e,t,n){var r;!function(e,a,o){function i(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function u(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorshift7=s}(0,e=n.nmd(e),n.amdD)},132:function(e,t,n){var r;!function(e,a,o){function i(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function u(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new i(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&u(r,n),a.state=function(){return u(n,{})}),a}a&&a.exports?a.exports=s:n.amdD&&n.amdO?void 0===(r=function(){return s}.call(t,n,t,a))||(a.exports=r):this.xorwow=s}(0,e=n.nmd(e),n.amdD)},411:function(e,t,n){var r;!function(a,o){var i,u=this,s=256,c=o.pow(s,6),l=o.pow(2,52),f=2*l,p=255;function d(e,t,n){var r=[],p=g(v((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(a)]:null==e?function(){try{var e;return i&&(e=i.randomBytes)?e=e(s):(e=new Uint8Array(s),(u.crypto||u.msCrypto).getRandomValues(e)),y(e)}catch(r){var t=u.navigator,n=t&&t.plugins;return[+new Date,u,n,u.screen,y(a)]}}():e,3),r),d=new h(r),x=function(){for(var e=d.g(6),t=c,n=0;e<l;)e=(e+n)*s,t*=s,n=d.g(1);for(;e>=f;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|d.g(4)},x.quick=function(){return d.g(4)/4294967296},x.double=x,g(y(d.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,d),e.state=function(){return m(d,{})}),n?(o.random=e,t):e})(x,p,"global"in t?t.global:this==o,t.state)}function h(e){var t,n=e.length,r=this,a=0,o=r.i=r.j=0,i=r.S=[];for(n||(e=[n++]);a<s;)i[a]=a++;for(a=0;a<s;a++)i[a]=i[o=p&o+e[a%n]+(t=i[a])],i[o]=t;(r.g=function(e){for(var t,n=0,a=r.i,o=r.j,i=r.S;e--;)t=i[a=p&a+1],n=n*s+i[p&(i[a]=i[o=p&o+t])+(i[o]=t)];return r.i=a,r.j=o,n})(s)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(v(e[n],t-1))}catch(o){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[p&a]=p&(n^=19*t[p&a])+r.charCodeAt(a++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(o.seedrandom=d,g(o.random(),a),e.exports){e.exports=d;try{i=n(42)}catch(x){}}else void 0===(r=function(){return d}.call(t,n,t,e))||(e.exports=r)}([],Math)},410:function(){},628:function(){},42:function(){}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.amdD=function(){throw new Error("define cannot be used indirect")},n.amdO={},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){"use strict";var e={};n.r(e),n.d(e,{collectGatherOpShapeInfo:function(){return hu},computeOutShape:function(){return du},segOpComputeOptimalWindowSize:function(){return pu}});var t={};n.r(t),n.d(t,{json:function(){return cm}});var r={};n.r(r),n.d(r,{json:function(){return lm}});var a={};n.r(a),n.d(a,{json:function(){return fm}});var o={};n.r(o),n.d(o,{json:function(){return pm}});var i={};n.r(i),n.d(i,{json:function(){return dm}});var u={};n.r(u),n.d(u,{json:function(){return hm}});var s={};n.r(s),n.d(s,{json:function(){return mm}});var c={};n.r(c),n.d(c,{json:function(){return vm}});var l={};n.r(l),n.d(l,{json:function(){return gm}});var f={};n.r(f),n.d(f,{json:function(){return ym}});var p={};n.r(p),n.d(p,{json:function(){return xm}});var d={};n.r(d),n.d(d,{json:function(){return bm}});var h={};n.r(h),n.d(h,{json:function(){return wm}});var m={};n.r(m),n.d(m,{json:function(){return km}});var v={};n.r(v),n.d(v,{json:function(){return Cm}});var g={};n.r(g),n.d(g,{json:function(){return Em}});var y=n(791),x=n(164);function b(e,t,n,r,a,o,i){try{var u=e[o](i),s=u.value}catch(c){return void n(c)}u.done?t(s):Promise.resolve(s).then(r,a)}function w(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function i(e){b(o,r,a,i,u,"next",e)}function u(e){b(o,r,a,i,u,"throw",e)}i(void 0)}))}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){if(e){if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o=[],i=!0,u=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(s){u=!0,a=s}finally{try{i||null==n.return||n.return()}finally{if(u)throw a}}return o}}(e,t)||C(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=n(757),N=n.n(S);function T(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=C(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){u=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(u)throw o}}}}function R(e){return function(e){if(Array.isArray(e))return k(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||C(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function A(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var O="tfjsflags",D=function(){function e(t){I(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return A(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=w(N().mark((function e(t){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(t instanceof Promise)throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=function(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return F(t,r[0],r[1]),r.join("=")})),t}(this.global.location.search);if(O in t)t.tfjsflags.split(",").forEach((function(t){var n=E(t.split(":"),2),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(r,a)}))}}}]),e}();function F(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function P(){return M}var L,M=null;function B(){if(null==L){var e;if("undefined"!==typeof window)e=window;else if("undefined"!==typeof n.g)e=n.g;else if("undefined"!==typeof process)e=process;else{if("undefined"===typeof self)throw new Error("Could not find a global object");e=self}L=e}return L}function z(e,t){var n=function(){var e=B();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}var V="Acos",U="Acosh",W="Add",G="AddN",j="ArgMax",H="ArgMin",K="Asin",q="Asinh",X="Atan",Y="Atanh",Q="Atan2",$="AvgPool",J="AvgPool3D",Z="AvgPool3DBackprop",ee="BatchMatMul",te="BatchToSpaceND",ne="BroadcastTo",re="Cast",ae="Ceil",oe="ClipByValue",ie="Concat",ue="Conv2D",se="Conv2DBackpropFilter",ce="Conv2DBackpropInput",le="Conv3D",fe="Cosh",pe="Cumsum",de="DepthToSpace",he="DepthwiseConv2dNative",me="Dilation2D",ve="Div",ge="Expm1",ye="FlipLeftRight",xe="Floor",be="FloorDiv",we="FusedBatchNorm",ke="GatherV2",Ce="GreaterEqual",Ee="Identity",Se="IsFinite",Ne="IsInf",Te="IsNan",Re="Log1p",Ie="LogSoftmax",_e="LRN",Ae="LRNBackprop",Oe="Max",De="Maximum",Fe="MaxPool",Pe="MaxPool3D",Le="MaxPool3DBackprop",Me="MaxPoolWithArgmax",Be="Min",ze="Minimum",Ve="Multiply",Ue="Negate",We="NonMaxSuppressionV3",Ge="NonMaxSuppressionV4",je="NonMaxSuppressionV5",He="OnesLike",Ke="OneHot",qe="PadV2",Xe="Prelu",Ye="Prod",Qe="Range",$e="Reciprocal",Je="Relu",Ze="Reshape",et="ResizeNearestNeighbor",tt="ResizeBilinear",nt="Relu6",rt="Reverse",at="Round",ot="Rsqrt",it="SelectV2",ut="Selu",st="Slice",ct="Sinh",lt="Sign",ft="Sigmoid",pt="Softplus",dt="Sqrt",ht="Sum",mt="SpaceToBatchND",vt="SplitV",gt="Softmax",yt="SquaredDifference",xt="Square",bt="SparseToDense",wt="StridedSlice",kt="Tanh",Ct="Tile",Et="TopK",St="Transpose",Nt="Unpack",Tt="UnsortedSegmentSum",Rt="ZerosLike",It="Step",_t="FromPixels",At="RotateWithOffset",Ot="_FusedMatMul",Dt="FusedConv2D",Ft="FusedDepthwiseConv2D",Pt=z("kernelRegistry",(function(){return new Map})),Lt=z("gradRegistry",(function(){return new Map}));function Mt(e,t){var n=Wt(e,t);return Pt.get(n)}function Bt(e){return Lt.get(e)}function zt(e){for(var t=Pt.entries(),n=[];;){var r=t.next(),a=r.done,o=r.value;if(a)break;var i=E(o,2),u=i[0],s=i[1];E(u.split("_"),1)[0]===e&&n.push(s)}return n}function Vt(e){var t=e.kernelName,n=e.backendName,r=Wt(t,n);Pt.has(r)&&console.warn("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),Pt.set(r,e)}function Ut(e){var t=e.kernelName;Lt.has(t)&&P().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(t,"'")),Lt.set(t,e)}function Wt(e,t){return"".concat(t,"_").concat(e)}function Gt(e,t,n){return Math.max(e,Math.min(t,n))}function jt(e){return e%2===0?e:e+1}function Ht(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function Kt(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function qt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Kt($t(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function Xt(e){Kt(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function Yt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||un(e)&&!n)for(var r=0;r<e.length;++r)Yt(e[r],t,n);else t.push(e);return t}function Qt(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function $t(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Jt(e){return e%1===0}function Zt(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function en(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function tn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var o=0;!function i(){if(e())r();else{o++;var u=t(o);null!=n&&o>=n?a():setTimeout(i,u)}}()}))}function nn(e,t){var n=t.length;return Kt((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),Kt(e.every((function(e){return Jt(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function rn(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,o=null==t||a?null:nn(t,e).sort(),i=0,u=0;u<e.length;++u){if(null!=o){if(o[i]===u&&1!==e[u])throw new Error("Can't squeeze axis ".concat(u," since its dim '").concat(e[u],"' is not 1"));(null==o[i]||o[i]>u)&&1===e[u]&&(n.push(e[u]),r.push(u)),o[i]<=u&&i++}1!==e[u]&&(n.push(e[u]),r.push(u))}return{newShape:n,keptDims:r}}function an(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function on(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function un(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function sn(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function cn(e){return"string"===typeof e||e instanceof String}function ln(e){return Array.isArray(e)?ln(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":"number"===typeof e?"float32":cn(e)?"string":function(e){return"boolean"===typeof e}(e)?"bool":"float32"}function fn(e){return!!(e&&e.constructor&&e.call&&e.apply)}function pn(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function dn(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function hn(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=Yt(e)),P().getBool("DEBUG")&&function(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),r=0;r<n.length;++r)0!==Math.round(e[r])&&(n[r]=1);return n}throw new Error("Unknown data type ".concat(t))}function mn(e,t,n){var r=new Array;if(1===t.length)for(var a=t[0],o=0;o<a;o++)r[o]=n[e+o];else for(var i=t[0],u=t.slice(1),s=u.reduce((function(e,t){return e*t})),c=0;c<i;c++)r[c]=mn(e+c*s,u,n);return r}function vn(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length,"."));return mn(0,e,t)}function gn(e,t){for(var n=yn(e,t),r=0;r<n.length;r++)n[r]=1;return n}function yn(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function xn(){return P().platform.now()}function bn(e){e.forEach((function(t){Kt(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function wn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",P().platform.decode(e,t)}function kn(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function Cn(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}var En=function(){function e(t,n){I(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new Sn)}return A(e,[{key:"profileKernel",value:function(e,t,n){for(var r,a=this.backendTimer.time((function(){r=n()})),o=function(t){var n=r[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},i=0;i<r.length;i++)o(i);return{kernelName:e,outputs:r,inputs:t,timeMs:a.then((function(e){return e.kernelMs})),extraInfo:a.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,o=e.inputs,i=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,i]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],o,r[2])}))}))}}]),e}();var Sn=function(){function e(){I(this,e)}return A(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,o){var i="number"===typeof r?en("".concat(r,"ms"),9):r.error,u=en(e,25),s=t.rank,c=t.size,l=en(t.shape.toString(),14),f="";for(var p in a){var d=a[p];if(null!=d){var h=d.shape||t.shape,m=h.length;f+="".concat(p,": ").concat(m,"D ").concat(m>0?h:""," ")}}console.log("%c".concat(u,"\t%c").concat(i,"\t%c").concat(s,"D ").concat(l,"\t%c").concat(c,"\t%c").concat(f,"\t%c").concat(o),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function Nn(e,t,n){for(var r={},a={},o=0;o<t.length;o++)r[t[o].id]=!0;for(var i=0;i<e.length;i++){var u=e[i],s=u.inputs;for(var c in s){for(var l=s[c],f=!1,p=0;p<t.length;p++)if(r[l.id]){u.outputs.forEach((function(e){return r[e.id]=!0})),f=!0,a[u.id]=!0;break}if(f)break}}var d={};d[n.id]=!0;for(var h={},m=e.length-1;m>=0;m--)for(var v=e[m],g=v.inputs,y=0;y<v.outputs.length;y++)if(d[v.outputs[y].id]){for(var x in g)d[g[x].id]=!0,h[v.id]=!0;break}for(var b=[],w=0;w<e.length;w++){var k=e[w];if(a[k.id]&&h[k.id]){var C={};for(var E in k.inputs){var S=k.inputs[E];r[S.id]&&(C[E]=S)}var N=Object.assign({},k);N.inputs=C,N.outputs=k.outputs,b.push(N)}}return b}function Tn(e,t,n,r){for(var a=function(a){var o=t[a],i=[];if(o.outputs.forEach((function(t){var n=e[t.id];null!=n?i.push(n):i.push(null)})),null==o.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(o.kernelName,"."));var u=o.gradient(i),s=function(t){if(!(t in u))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(u),"."));var a=n((function(){return u[t]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var i=o.inputs[t];if(!$t(a.shape,i.shape))throw new Error("Error in gradient for op ".concat(o.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(i.shape,"'"));if(null==e[i.id])e[i.id]=a;else{var s=e[i.id];e[i.id]=r(s,a),s.dispose()}};for(var c in o.inputs)s(c)},o=t.length-1;o>=0;o--)a(o)}function Rn(e,t){return Rn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Rn(e,t)}function In(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rn(e,t)}function _n(e){return _n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},_n(e)}function An(e){return An="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},An(e)}function On(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Dn(e,t){if(t&&("object"===An(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return On(e)}function Fn(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_n(e);if(t){var a=_n(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Dn(this,n)}}function Pn(e,t,n,r){var a=dn(t),o=function(e,t,n,r){var a=Qt(t),o=r[r.length-1],i=new Array(o).fill(0),u=t.length,s="complex64"===n?zn(e):e;if(u>1)for(var c=0;c<a/o;c++)for(var l=c*o,f=0;f<o;f++)i[f]=Math.max(i[f],Ln(s[l+f],0,n).length);return i}(e,t,n,a),i=t.length,u=Bn(e,t,n,a,o),s=["Tensor"];return r&&(s.push("  dtype: ".concat(n)),s.push("  rank: ".concat(i)),s.push("  shape: [".concat(t,"]")),s.push("  values:")),s.push(u.map((function(e){return"    "+e})).join("\n")),s.join("\n")}function Ln(e,t,n){return en(Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):cn(e)?"'".concat(e,"'"):"bool"===n?Mn(e):parseFloat(e.toFixed(7)).toString(),t)}function Mn(e){return 0===e?"false":"true"}function Bn(e,t,n,r,a){var o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],i="complex64"===n?2:1,u=t[0],s=t.length;if(0===s){if("complex64"===n){var c=zn(e);return[Ln(c[0],0,n)]}return"bool"===n?[Mn(e[0])]:[e[0].toString()]}if(1===s){if(u>20){var l=3*i,f=Array.from(e.slice(0,l)),p=Array.from(e.slice((u-3)*i,u*i));return"complex64"===n&&(f=zn(f),p=zn(p)),["["+f.map((function(e,t){return Ln(e,a[t],n)})).join(", ")+", ..., "+p.map((function(e,t){return Ln(e,a[u-3+t],n)})).join(", ")+"]"]}var d="complex64"===n?zn(e):Array.from(e);return["["+d.map((function(e,t){return Ln(e,a[t],n)})).join(", ")+"]"]}var h=t.slice(1),m=r.slice(1),v=r[0]*i,g=[];if(u>20){for(var y=0;y<3;y++){var x=y*v,b=x+v;g.push.apply(g,R(Bn(e.slice(x,b),h,n,m,a,!1)))}g.push("...");for(var w=u-3;w<u;w++){var k=w*v,C=k+v;g.push.apply(g,R(Bn(e.slice(k,C),h,n,m,a,w===u-1)))}}else for(var E=0;E<u;E++){var S=E*v,N=S+v;g.push.apply(g,R(Bn(e.slice(S,N),h,n,m,a,E===u-1)))}var T=2===s?",":"";g[0]="["+g[0]+T;for(var I=1;I<g.length-1;I++)g[I]=" "+g[I]+T;for(var _=",\n",A=2;A<s;A++)_+="\n";return g[g.length-1]=" "+g[g.length-1]+"]"+(o?"":_),g}function zn(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var Vn=function(){function e(t,n,r){var a=this;if(I(this,e),this.dtype=n,this.shape=t.slice(),this.size=Qt(t),null!=r){var o=r.length;Kt(o===this.size,(function(){return"Length of values '".concat(o,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||on(n,this.size),this.strides=dn(t)}return A(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),Kt(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var o=this.locToIndex(r);this.values[o]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,o=t;a<o.length;a++){var i=o[a];if(i<0||i>=this.shape[r]){var u="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(u)}r++}for(var s=t[t.length-1],c=0;c<t.length-1;++c)s+=this.strides[c]*t[c];return this.values[s]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return Un().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),Un=null,Wn=null;var Gn=function(){function e(t,n,r,a){I(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=Qt(t),this.strides=dn(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return A(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=w(N().mark((function e(){var t;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Wn.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return Wn.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=w(N().mark((function e(){var t;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",vn(this.shape,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return vn(this.shape,this.dataSync())}},{key:"data",value:function(){var e=w(N().mark((function e(){var t,n;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=Un().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return wn(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataSync",value:function(){this.throwIfDisposed();var e=Un().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return wn(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=w(N().mark((function e(){var t;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,Un().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(Un().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Wn.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),Wn.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return Pn(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),Wn.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),Un().makeVariable(this,e,t,n)}}]),e}();Object.defineProperty(Gn,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}});var jn,Hn,Kn,qn,Xn,Yn=function(e){In(n,e);var t=Fn(n);function n(e,r,a,o){var i;return I(this,n),(i=t.call(this,e.shape,e.dtype,e.dataId,o)).trainable=r,i.name=a,i}return A(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!$t(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));Un().disposeTensor(this),this.dataId=e.dataId,Un().incRef(this,null)}},{key:"dispose",value:function(){Un().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(Gn);Object.defineProperty(Yn,Symbol.hasInstance,{value:function(e){return e instanceof Gn&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(jn||(jn={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(Hn||(Hn={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(Kn||(Kn={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(qn||(qn={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(Xn||(Xn={}));var Qn={float32:qn,int32:Hn,bool:Kn,complex64:Xn};function $n(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return Qn[e][t]}function Jn(e){return $n(e,"int32")}function Zn(e,t){if(e.dtype===t.dtype)return[e,t];var n=$n(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function er(e){var t=[];return tr(e,t,new Set),t}function tr(e,t,n){if(null!=e)if(e instanceof Gn)t.push(e);else if(r=e,Array.isArray(r)||"object"===typeof r){var r,a=e;for(var o in a){var i=a[o];n.has(i)||(n.add(i),tr(i,t,n))}}}var nr=function(){function e(){I(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return A(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),rr=function(){function e(t){I(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new nr}return A(e,[{key:"ready",value:function(){var e=w(N().mark((function e(){var t,n,r;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=w(N().mark((function e(t){var n,r;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new En(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;zt(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;zt(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(Promise.resolve(r)===r){var a=++this.pendingBackendInitId,o=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(n.stack||n.message)),!1}));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(i){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(i.stack||i.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,o=r.asyncInit;if(o||a)return{name:n,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t="float32",n={x:e},r={dtype:t};return ir.runKernelFunc((function(n){return n.cast(e,t)}),n,null,re,r)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var o=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],i=r-t-a-o;if(i>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(i," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e,t,n,r,a,o,i){var u,s=this,c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var f,p=this.state.numBytes,d=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var h,m,v=Mt(r,this.backendName);if(null!=v)f=function(){var e=s.backend.numDataIds();h=v.kernelFunc({inputs:t,attrs:a,backend:s.backend});var n=Array.isArray(h)?h:[h];s.shouldCheckForMemLeaks()&&s.checkKernelForMemLeak(r,e,n);var u=n.map((function(e){var t=e.dataId,n=e.shape,r=e.dtype;return s.makeTensorFromDataId(t,n,r)}));if(l){var f=s.getTensorsForGradient(r,t,u);if(null==f){null==i&&(i=[]);var p=u.filter((function(e,t){return i[t]}));f=(o||[]).slice().concat(p)}c=s.saveTensorsForBackwardMode(f)}return u};else{var g=function(e){l&&(c=e.map((function(e){return s.keep(s.clone(e))})))};f=function(){var t=s.backend.numDataIds();h=s.tidy((function(){return e(s.backend,g)}));var n=Array.isArray(h)?h:[h];return s.shouldCheckForMemLeaks()&&s.checkKernelForMemLeak(r,t,n),n}}return this.scopedRun((function(){return s.state.kernelDepth++}),(function(){return s.state.kernelDepth--}),(function(){s.ENV.getBool("DEBUG")||s.state.profiling?(m=s.profiler.profileKernel(r,t,(function(){return f()})),s.ENV.getBool("DEBUG")&&s.profiler.logKernelProfile(m),u=m.outputs):u=f()})),l&&this.addTapeNode(r,t,u,n,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-p,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-d,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return null!=t[e]?t[e].shape:null})),outputShapes:u.map((function(e){return e.shape})),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(h)?u:u[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this,n=e.map((function(e){return t.keep(t.clone(e))}));return n}},{key:"getTensorsForGradient",value:function(e,t,n){var r=Bt(e);if(null!=r){var a,o=r.inputsToSave||[],i=r.outputsToSave||[];r.saveAllInputs?(Kt(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=o.map((function(e){return t[e]}));var u=n.filter((function(e,t){return i[t]}));return a.concat(u)}return null}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&cn(e[0])&&(a=e.map((function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",P().platform.encode(e,t)}(e)})));var o=r.write(a,t,n),i=new Gn(t,n,o,this.nextTensorId());if(this.incRef(i,r),"string"===n){var u=this.state.tensorInfo.get(o),s=function(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}(a);this.state.numBytes+=s-u.bytes,u.bytes=s}return i}},{key:"makeTensorFromDataId",value:function(e,t,n,r){var a=new Gn(t,n=n||"float32",e,this.nextTensorId());return this.incRef(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new Yn(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"incRef",value:function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*sn(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof Yn||this.track(e)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=w(N().mark((function e(t){var n,r,a,o,i;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,r=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,R(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r,a=T(this.state.activeProfile.kernels),e.prev=12,a.s();case 14:if((o=a.n()).done){e.next=24;break}return i=o.value,e.next=18,i.kernelTimeMs;case 18:return i.kernelTimeMs=e.sent,e.next=21,i.extraInfo;case 21:i.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),a.e(e.t0);case 29:return e.prev=29,a.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,o){var i=this,u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=Bt(e);null!=s&&(r=s.gradFunc),null!=r&&(u.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=yn(r.size,r.dtype);return i.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,o)}),this.state.activeTape.push(u)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=er(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var o=this.state.activeScope.track[a];o.kept||r.has(o.id)||o.dispose()}var i=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==i.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=this,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(Kt(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var o=this.scopedRun((function(){return r.startTape()}),(function(){return r.endTape()}),(function(){return r.tidy("forward",e)}));Kt(o instanceof Gn,(function(){return"The result y returned by f() must be a tensor."}));var i=Nn(this.state.activeTape,t,o);if(!a&&0===i.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[o.id]=null==n?ar(o.shape):n,Tn(e,i,(function(e){return r.tidy(e)}),ur);var a=t.map((function(t){return e[t.id]}));return 0===r.state.gradientDepth&&(r.state.activeTape.forEach((function(e){var t,n=T(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(r){n.e(r)}finally{n.f()}})),r.state.activeTape=null),{value:o,grads:a}}))}},{key:"customGrad",value:function(e){var t=this;return Kt(fn(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var o;Kt(r.every((function(e){return e instanceof Gn})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};return r.forEach((function(e,t){i[t]=e})),t.runKernelFunc((function(t,n){return Kt((o=e.apply(void 0,[].concat(r,[n]))).value instanceof Gn,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),Kt(fn(o.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),o.value}),i,(function(e,t){var n=o.gradFunc(e,t),a=Array.isArray(n)?n:[n];Kt(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),Kt(a.every((function(e){return e instanceof Gn})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var i={};return a.forEach((function(e,t){i[t]=function(){return e}})),i}))}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:function(){var e=w(N().mark((function e(t){var n,r;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=xn(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=xn()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new nr,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function ar(e){var t=gn(Qt(e),"float32");return ir.makeTensor(t,e,"float32")}function or(){var e=B();if(null==e._tfengine){var t=new D(e);e._tfengine=new rr(t)}return function(e){M=e}(e._tfengine.ENV),Un=function(){return e._tfengine},e._tfengine}rr.nextTensorId=0,rr.nextVariableId=0;var ir=or();function ur(e,t){var n={a:e,b:t};return ir.runKernelFunc((function(n,r){var a=n.add(e,t);return r([e,t]),a}),n,null,W)}function sr(){if("undefined"!==typeof navigator&&null!=navigator){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function cr(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}var lr=P();function fr(e,t){var n=e;if(un(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||un(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&P().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&pr(e,r,[]),r}function pr(e,t,n){if(n=n||[],Array.isArray(e)||un(e)){Kt(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),Kt(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)pr(e[a],r,n.concat(a))}else Kt(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function dr(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}function hr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof Gn)return dr(r,e.dtype,t,n),e;var a=ln(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),dr(r,a,t,n),null==e||!un(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var o=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(o,"'"))}var i=fr(e,a);un(e)||Array.isArray(e)||(e=[e]);var u=!0,s="string"!==a?hn(e,a):Yt(e,[],u);return ir.makeTensor(s,i,a)}function mr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,r){return hr(e,"".concat(t,"[").concat(r,"]"),n)}),r)}lr.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),lr.registerFlag("IS_BROWSER",(function(){return cr()})),lr.registerFlag("IS_NODE",(function(){return"undefined"!==typeof process&&"undefined"!==typeof process.versions&&"undefined"!==typeof process.versions.node})),lr.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),lr.registerFlag("PROD",(function(){return!1})),lr.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return lr.getBool("DEBUG")})),lr.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),lr.registerFlag("IS_TEST",(function(){return!1}));function vr(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";var a=function(){ir.startScope(n);try{var e=r.apply(void 0,arguments);return e instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),ir.endScope(e),e}catch(t){throw ir.endScope(null),t}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}var gr=vr({complex_:function(e,t){var n=hr(e,"real","complex"),r=hr(t,"imag","complex");qt(n.shape,r.shape,"real and imag shapes, ".concat(n.shape," and ").concat(r.shape,", ")+"must match in call to tf.complex().");var a={real:n,imag:r};return ir.runKernelFunc((function(e){return e.complex(n,r)}),a,null,"Complex")}});function yr(e,t,n,r){if(null==r&&(r=ln(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!un(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){bn(t);var a=Qt(t),o=Qt(n);Kt(a===o,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(a," values but has ").concat(o)}));for(var i=0;i<n.length;++i){var u=n[i],s=i!==n.length-1||u!==Qt(t.slice(i));Kt(n[i]===t[i]||!s,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return un(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?hn(e,r):Yt(e,[],!0),ir.makeTensor(e,t,r)}function xr(e,t,n){return yr(e,t,fr(e,n),n)}var br={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};function wr(e,t){var n,r,a={},o=0,i=T(t);try{for(i.s();!(r=i.n()).done;){var u=r.value,s=u.name,c=u.dtype,l=u.shape,f=Qt(l),p=void 0;if("quantization"in u){var d=u.quantization;if("uint8"===d.dtype||"uint16"===d.dtype){if(!("min"in d)||!("scale"in d))throw new Error("Weight ".concat(u.name," with quantization ").concat(d.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==d.dtype)throw new Error("Weight ".concat(u.name," has unknown ")+"quantization dtype ".concat(d.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==c)throw new Error("Weight ".concat(u.name," is quantized with ").concat(d.dtype," ")+"which only supports weights of type float32 not ".concat(c,"."))}var h=br[d.dtype],m=e.slice(o,o+f*h),v="uint8"===d.dtype?new Uint8Array(m):new Uint16Array(m);if("float32"===c)if("uint8"===d.dtype||"uint16"===d.dtype){p=new Float32Array(v.length);for(var g=0;g<v.length;g++){var y=v[g];p[g]=y*d.scale+d.min}}else{if("float16"!==d.dtype)throw new Error("Unsupported quantization type ".concat(d.dtype," ")+"for weight type float32.");void 0===n&&(n=Rr()),p=n(v)}else{if("int32"!==c)throw new Error("Unsupported dtype in weight '".concat(s,"': ").concat(c));if("uint8"!==d.dtype&&"uint16"!==d.dtype)throw new Error("Unsupported quantization type ".concat(d.dtype," ")+"for weight type int32.");p=new Int32Array(v.length);for(var x=0;x<v.length;x++){var b=v[x];p[x]=Math.round(b*d.scale+d.min)}}o+=f*h}else if("string"===c){var w=Qt(u.shape);p=[];for(var k=0;k<w;k++){var C=new Uint32Array(e.slice(o,o+4))[0];o+=4;var E=new Uint8Array(e.slice(o,o+C));p.push(E),o+=C}}else{var S=br[c],N=e.slice(o,o+f*S);if("float32"===c)p=new Float32Array(N);else if("int32"===c)p=new Int32Array(N);else if("bool"===c)p=new Uint8Array(N);else{if("complex64"!==c)throw new Error("Unsupported dtype in weight '".concat(s,"': ").concat(c));p=new Float32Array(N);for(var R=new Float32Array(p.length/2),I=new Float32Array(p.length/2),_=0;_<R.length;_++)R[_]=p[2*_],I[_]=p[2*_+1];var A=xr(R,l,"float32"),O=xr(I,l,"float32");a[s]=gr(A,O)}o+=f*S}"complex64"!==c&&(a[s]=xr(p,l,c))}}catch(D){i.e(D)}finally{i.f()}return a}var kr="undefined"!==typeof Buffer&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function Cr(e){return kr?Buffer.byteLength(e):new Blob([e]).size}function Er(e){if(kr)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function Sr(e){if(kr){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function Nr(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function Tr(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:Cr(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:Cr(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function Rr(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),o=new Uint32Array(a),i=0;i<r.length;i++){var u=r[i],s=e[n[u>>10]+(1023&u)]+t[u>>10];o[i]=s}return new Float32Array(a)}}var Ir=function(){function e(){I(this,e),this.saveRouters=[],this.loadRouters=[]}return A(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),_r="tensorflowjs",Ar="models_store",Or="model_info_store";function Dr(){if(!P().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function Fr(e){var t=e.result;t.createObjectStore(Ar,{keyPath:"modelPath"}),t.createObjectStore(Or,{keyPath:"modelPath"})}var Pr=function(){function e(t){if(I(this,e),this.indexedDB=Dr(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return A(e,[{key:"save",value:function(){var e=w(N().mark((function e(t){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=w(N().mark((function e(){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(_r,1);a.onupgradeneeded=function(){return Fr(a)},a.onsuccess=function(){var o=a.result;if(null==t){var i=o.transaction(Ar,"readonly"),u=i.objectStore(Ar).get(n.modelPath);u.onsuccess=function(){if(null==u.result)return o.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(u.result.modelArtifacts)},u.onerror=function(e){return o.close(),r(u.error)},i.oncomplete=function(){return o.close()}}else{var s,c=Tr(t),l=o.transaction(Or,"readwrite"),f=l.objectStore(Or),p=f.put({modelPath:n.modelPath,modelArtifactsInfo:c});p.onsuccess=function(){var a=(s=o.transaction(Ar,"readwrite")).objectStore(Ar).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(f=l.objectStore(Or)).delete(n.modelPath);t.onsuccess=function(){return o.close(),r(a.error)},t.onerror=function(e){return o.close(),r(a.error)}}},p.onerror=function(e){return o.close(),r(p.error)},l.oncomplete=function(){null==s?o.close():s.oncomplete=function(){return o.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();Pr.URL_SCHEME="indexeddb://";var Lr=function(e){return P().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(Pr.URL_SCHEME)?(t=e.slice(Pr.URL_SCHEME.length),new Pr(t)):null;var t};Ir.registerSaveRouter(Lr),Ir.registerLoadRouter(Lr);var Mr=function(){function e(){I(this,e),this.indexedDB=Dr()}return A(e,[{key:"listModels",value:function(){var e=w(N().mark((function e(){var t=this;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(_r,1);r.onupgradeneeded=function(){return Fr(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(Or,"readonly"),o=a.objectStore(Or).getAll();o.onsuccess=function(){var t,n={},r=T(o.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(i){r.e(i)}finally{r.f()}e(n)},o.onerror=function(e){return t.close(),n(o.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=w(N().mark((function e(t){var n=this;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(Pr.URL_SCHEME)?r.slice(Pr.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(_r,1);a.onupgradeneeded=function(){return Fr(a)},a.onsuccess=function(){var n,o=a.result,i=o.transaction(Or,"readwrite"),u=i.objectStore(Or),s=u.get(t);s.onsuccess=function(){if(null==s.result)return o.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=u.delete(t),i=function(){var a=(n=o.transaction(Ar,"readwrite")).objectStore(Ar).delete(t);a.onsuccess=function(){return e(s.result.modelArtifactsInfo)},a.onerror=function(e){return r(s.error)}};a.onsuccess=i,a.onerror=function(e){return i(),o.close(),r(s.error)}},s.onerror=function(e){return o.close(),r(s.error)},i.oncomplete=function(){null==n?o.close():n.oncomplete=function(){return o.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Br="/",zr="tensorflowjs_models",Vr="info",Ur="model_topology",Wr="weight_specs",Gr="weight_data",jr="model_metadata";function Hr(e){return{info:[zr,e,Vr].join(Br),topology:[zr,e,Ur].join(Br),weightSpecs:[zr,e,Wr].join(Br),weightData:[zr,e,Gr].join(Br),modelMetadata:[zr,e,jr].join(Br)}}function Kr(e){var t=e.split(Br);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(Br)}var qr=function(){function e(t){if(I(this,e),!P().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=Hr(this.modelPath)}return A(e,[{key:"save",value:function(){var e=w(N().mark((function e(t){var n,r,a;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Tr(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Er(t.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata})),e.abrupt("return",{modelArtifactsInfo:a});case 16:throw e.prev=16,e.t0=e.catch(7),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 24:case"end":return e.stop()}}),e,this,[[7,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=w(N().mark((function e(){var t,n,r,a,o,i,u;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(o=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(o),n.format=i.format,n.generatedBy=i.generatedBy,n.convertedBy=i.convertedBy,n.userDefinedMetadata=i.userDefinedMetadata),null!=(u=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=Sr(u),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();qr.URL_SCHEME="localstorage://";var Xr=function(e){return P().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(qr.URL_SCHEME)?(t=e.slice(qr.URL_SCHEME.length),new qr(t)):null;var t};Ir.registerSaveRouter(Xr),Ir.registerLoadRouter(Xr);var Yr=function(){function e(){I(this,e),Kt(P().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Kt("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return A(e,[{key:"listModels",value:function(){var e=w(N().mark((function e(){var t,n,r,a,o,i;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=zr+Br,r=Br+Vr,a=0;a<this.LS.length;++a)(o=this.LS.key(a)).startsWith(n)&&o.endsWith(r)&&(i=Kr(o),t[i]=JSON.parse(this.LS.getItem(o)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=w(N().mark((function e(t){var n,r;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(qr.URL_SCHEME)?a.slice(qr.URL_SCHEME.length):a,n=Hr(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),e.abrupt("return",r);case 10:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Qr="://",$r=function(){function e(){I(this,e),this.managers={}}return A(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){Kt(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(Qr)&&(t=t.slice(0,t.indexOf(Qr))),Kt(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();Kt(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();var Jr=function(){function e(){I(this,e)}return A(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}();if(P().get("IS_BROWSER")){P().setPlatform("browser",new Jr);try{$r.registerManager(qr.URL_SCHEME,new Yr)}catch(Ng){}try{$r.registerManager(Pr.URL_SCHEME,new Mr)}catch(Ng){}}var Zr,ea=function(){return n(410)};var ta=function(){function e(){I(this,e),this.util=n(628),this.textEncoder=new this.util.TextEncoder}return A(e,[{key:"fetch",value:function(e,t){return null!=P().global.fetch?P().global.fetch(e,t):(null==Zr&&(Zr=ea()),Zr(e,t))}},{key:"now",value:function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),e}();function na(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",bn(e),new Vn(e,t,n)}P().get("IS_NODE")&&P().setPlatform("node",new ta);var ra=vr({cast_:function(e,t){var n=hr(e,"x","cast");if(!function(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={x:n},a={dtype:t};return ir.runKernelFunc((function(e){return e.cast(n,t)}),r,null,re,a)}});var aa=vr({clone_:function(e){var t=hr(e,"x","clone",null),n={x:t};return ir.runKernelFunc((function(){return ir.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),n,null,Ee)}});or();var oa={buffer:na,cast:ra,clone:aa,print:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}};Wn=oa;function ia(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var ua=function(){function e(t){if(I(this,e),!P().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return A(e,[{key:"save",value:function(){var e=w(N().mark((function e(t){var n,r,a,o,i,u;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},o=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=o,e.next=15,ia((function(){return i.dispatchEvent(new MouseEvent("click"))}));case 15:if(null==t.weightData){e.next=21;break}return(u=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,u.href=n,e.next=21,ia((function(){return u.dispatchEvent(new MouseEvent("click"))}));case 21:return e.abrupt("return",{modelArtifactsInfo:Tr(t)});case 22:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();ua.URL_SCHEME="downloads://";function sa(e,t,n,r){!function(e){Kt(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){Kt(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),Kt(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),Kt(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(o){return o.then((function(o){var i=n+ ++a/e.length*(r-n);return t(i),o})),o})))}function ca(e,t){return la.apply(this,arguments)}function la(){return(la=w(N().mark((function e(t,n){var r,a,o,i,u,s,c,l,f;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?P().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),o=0,i=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,sa(a,n.onProgress,o,i);case 13:e.t0=e.sent;case 14:if(u=e.t0,s=u.map((function(e){return e.arrayBuffer()})),c=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(s);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,sa(s,n.onProgress,c,l);case 26:e.t1=e.sent;case 27:return f=e.t1,e.abrupt("return",f);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Ir.registerSaveRouter((function(e){return P().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(ua.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new ua(e)}(e.slice(ua.URL_SCHEME.length)):null}));var fa=function(){function e(t,n){if(I(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(Kt("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=P().platform.fetch,Kt(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&Kt(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return A(e,[{key:"save",value:function(){var e=w(N().mark((function e(t){var n,r,a,o;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,userDefinedMetadata:t.userDefinedMetadata,weightsManifest:r},n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=10,this.fetch(this.path,n);case 10:if(!(o=e.sent).ok){e.next=15;break}return e.abrupt("return",{modelArtifactsInfo:Tr(t),responses:[o]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(o.status,"."));case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=w(N().mark((function e(){var t,n,r,a,o,i,u,s,c,l,f,p,d;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,o=n.weightsManifest,i=n.generatedBy,u=n.convertedBy,s=n.format,c=n.userDefinedMetadata,null!=a||null!=o){e.next=24;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 24:if(null==o){e.next=31;break}return e.next=27,this.loadWeights(o);case 27:p=e.sent,d=E(p,2),l=d[0],f=d[1];case 31:return e.abrupt("return",{modelTopology:a,weightSpecs:l,weightData:f,userDefinedMetadata:c,generatedBy:i,convertedBy:u,format:s});case 32:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=w(N().mark((function e(t){var n,r,a,o,i,u,s,c,l,f,p,d,h,m,v,g,y,x,b;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=pa(n),a=E(r,2),o=a[0],i=a[1],u=this.weightPathPrefix||o,s=[],c=T(t);try{for(c.s();!(l=c.n()).done;)f=l.value,s.push.apply(s,R(f.weights))}catch(Ng){c.e(Ng)}finally{c.f()}p=[],d=[],h=T(t);try{for(h.s();!(m=h.n()).done;){v=m.value,g=T(v.paths);try{for(g.s();!(y=g.n()).done;)x=y.value,null!=this.weightUrlConverter?d.push(this.weightUrlConverter(x)):p.push(u+x+i)}catch(Ng){g.e(Ng)}finally{g.f()}}}catch(Ng){h.e(Ng)}finally{h.f()}if(!this.weightUrlConverter){e.next=19;break}return e.t0=p.push,e.t1=p,e.t2=R,e.next=16,Promise.all(d);case 16:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 19:return e.next=21,ca(p,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 21:return b=e.sent,e.abrupt("return",[s,Nr(b)]);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function pa(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function da(e){return null!=e.match(fa.URL_SCHEME_REGEX)}fa.URL_SCHEME_REGEX=/^https?:\/\//;var ha=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return da(e)})):da(e))?ma(e,t):null};function ma(e,t){return new fa(e,t)}function va(e,t){return ma(e,t)}Ir.registerSaveRouter(ha),Ir.registerLoadRouter(ha);var ga;function ya(e,t,n){if(Xt(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=fr(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return yr(e,t,r,n)}var xa=vr({fromPixels_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,o=!1,i=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)o=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));i=!0}if(a){var u=2;if(a&&e.readyState<u)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}var s=Mt(_t,ir.backendName);if(null!=s){var c={pixels:e},l={numChannels:t};return ir.runKernel(_t,c,l)}var f,p,d=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],h=E(d,2),m=h[0],v=h[1];if(i?f=e.getContext("2d").getImageData(0,0,m,v).data:r||n?f=e.data:(o||a)&&(null==ga&&(ga=document.createElement("canvas").getContext("2d")),ga.canvas.width=m,ga.canvas.height=v,ga.drawImage(e,0,0,m,v),f=ga.getImageData(0,0,m,v).data),4===t)p=new Int32Array(f);else{var g=m*v;p=new Int32Array(g*t);for(var y=0;y<g;y++)for(var x=0;x<t;++x)p[y*t+x]=f[4*y+x]}var b=[v,m,t];return ya(p,b,"int32")}});function ba(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function wa(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function ka(e,t,n){return n<=e?n:n-(t-1)}function Ca(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function Ea(e,t,n,r,a,o,i,u,s){var c=e.length,l=new Array(c),f=new Array(c),p=new Array(c);if(t.length&&n>0){var d=t[0],h=n+1;l=function(e,t,n,r,a){for(var o=R(a),i=Ca(n,t),u=0;u<o.length;u++)if(i.indexOf(u)>-1)o[u]=0;else{var s=ka(t,n,u),c=r[s];e&1<<s&&(c=0),o[u]=c}return o}(i,d,h,r,e),f=function(e,t,n,r,a){for(var o=R(a),i=Ca(n,t),u=0;u<o.length;u++)if(i.indexOf(u)>-1)o[u]=Number.MAX_SAFE_INTEGER;else{var s=ka(t,n,u),c=r[s];e&1<<s&&(c=Number.MAX_SAFE_INTEGER),o[u]=c}for(var l=0;l<o.length;l++){var f=a[l];o[l]<0&&(o[l]+=f),o[l]=Gt(0,o[l],a[l])}return o}(u,d,h,a,e),p=function(e,t,n,r){for(var a=R(e),o=a.length;o<r.length;o++)a.push(1);for(var i=0;i<n;i++)0===i?a[t]=1:(a.splice(t,0,1),a.pop());return a}(o,d,h,e)}else for(var m=0;m<c;m++)l[m]=Na(i,r,o,e,m,s),f[m]=Ta(u,a,o,e,m,s),p[m]=Sa(o,m,s);return{begin:l,end:f,strides:p}}function Sa(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function Na(e,t,n,r,a,o){var i=t[a],u=n[a]||1;(e&1<<a||o&1<<a||null==i)&&(i=u>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),i=Gt(0,i,s-1)}function Ta(e,t,n,r,a,o){var i=t[a],u=n[a]||1;(e&1<<a||o&1<<a||null==i)&&(i=u>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),i=u>0?Gt(0,i,s):Gt(-1,i,s-1)}function Ra(e,t,n){var r,a;return(r="number"===typeof t?[t].concat(R(new Array(e.rank-1).fill(0))):t.length<e.rank?t.concat(new Array(e.rank-t.length).fill(0)):t.slice()).forEach((function(e){Kt(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(e.rank).fill(-1):"number"===typeof n?[n].concat(R(new Array(e.rank-1).fill(-1))):n.length<e.rank?n.concat(new Array(e.rank-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(Kt(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}var Ia=vr({add_:function(e,t){var n=hr(e,"a","add"),r=hr(t,"b","add"),a=E(Zn(n,r),2);n=a[0],r=a[1];var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.add(n,r);return t([n,r]),a}),o,null,W)}});function _a(e,t){var n=e[0].length;e.forEach((function(e,t){Kt(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),Kt(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var o=0;o<n;o++)Kt(o===t||e[o]===r[o],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function Aa(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}var Oa=vr({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Kt(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=mr(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}));var r=nn(t,n[0].shape)[0],a=Aa(n.map((function(e){return e.shape})),r);if(0===Qt(a))return xr([],a);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var o=n.map((function(e){return e.shape}));_a(o,r);var i=function(e,t){var a=e.concat(n,r);return t(n),a},u=n,s={axis:t};return ir.runKernelFunc(i,u,null,ie,s)}});var Da=vr({concat2d_:function(e,t){return Oa(e,t)}});var Fa=vr({floorDiv_:function(e,t){var n=hr(e,"a","floorDiv"),r=hr(t,"b","floorDiv"),a=E(Zn(n,r),2);n=a[0],r=a[1];var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.floorDiv(n,r);return t([n,r]),a}),o,null,be)}});var Pa=vr({div_:function(e,t){var n=hr(e,"a","div"),r=hr(t,"b","div"),a=E(Zn(n,r),2);if(n=a[0],r=a[1],"int32"===n.dtype&&"int32"===r.dtype)return Fa(n,r);var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.realDivide(n,r);return t([n,r]),a}),o,null,ve,{})}});var La=vr({imag_:function(e){var t=hr(e,"input","imag"),n={input:t};return ir.runKernelFunc((function(e){return e.imag(t)}),n,null,"Imag")}});function Ma(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function Ba(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);var o=t.map((function(t){return e[t]}));return[n,o]}function za(e,t){return function(e,t,n){for(var r=e.length+t.length,a=[],o=0,i=0,u=0;u<r;u++)-1===n.indexOf(u)?a.push(e[o++]):a.push(t[i++]);return a}(e,t.map((function(e){return 1})),t)}function Va(e,t,n){Kt(Ma(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function Ua(e,t){if(Ma(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function Wa(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function Ga(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}var ja=vr({reshape_:function(e,t){var n=hr(e,"x","reshape",null);t=function(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var o=e.slice();return o[r]=t/n,o}(t,n.size),Kt(n.size===Qt(t),(function(){return"new shape and old shape must have the same number of elements."}));var r={x:n},a={shape:t};return ir.runKernelFunc((function(e,r){return r([n]),e.reshape(n,t)}),r,null,Ze,a)}});var Ha=vr({transpose_:function(e,t){var n=hr(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),Kt(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){Kt(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(t)}))})),n.rank<=1)return n.clone();var r={x:n},a={perm:t};return ir.runKernelFunc((function(e){return e.transpose(n,t)}),r,null,St,a)}});var Ka=vr({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"x","max"),a=function(e,a){var o=nn(t,r.shape),i=Ua(o,r.rank),u=r;null!=i&&(u=Ha(r,i),o=Ga(o.length,u.rank));var s=e.max(u,o);null!=i&&u.dispose();var c=s;if(n){var l=za(c.shape,nn(t,r.shape));c=ja(c,l),s.dispose()}return a([r,c]),c},o={x:r},i={reductionIndices:t,keepDims:n};return ir.runKernelFunc(a,o,null,Oe,i)}});var qa=vr({mul_:function(e,t){var n=hr(e,"a","mul"),r=hr(t,"b","mul"),a=E(Zn(n,r),2);n=a[0],r=a[1];var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.multiply(n,r);return t([n,r]),a}),o,null,Ve)}});function Xa(e,t){Xt(e);var n=fr(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return yr(e,null,n,t)}function Ya(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=Ya(e,"float32"),r=Ya(e,"float32");return gr(n,r)}var a=yn(Qt(e),t);return ir.makeTensor(a,e,t)}function Qa(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var a=function(){if(e===t||e<t&&n<0||t<e&&n>1)return Ya([0],r);var a=yn(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var o=1;o<a.length;o++)a[o]=a[o-1]+n;return Xa(a,r)},o={start:e,stop:t,step:n,dtype:r};return ir.runKernelFunc(a,{},null,Qe,o)}var $a=vr({real_:function(e){var t=hr(e,"input","real"),n={input:t};return ir.runKernelFunc((function(e){return e.real(t)}),n,null,"Real")}});function Ja(e,t){if((un(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&un(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return yr(e,[],[],t)}var Za=vr({sigmoid_:function(e){var t=hr(e,"x","sigmoid"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.sigmoid(t);return n([r]),r}),n,null,ft)}});var eo=vr({slice_:function(e,t,n){var r=hr(e,"x","slice");if(0===r.rank)throw new Error("Slicing scalar is not possible");var a=E(Ra(r,t,n),2),o=a[0],i=a[1];!function(e,t,n){Kt(e.rank===t.length,(function(){return"Error in slice".concat(e.rank,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(e.rank,").")})),Kt(e.rank===n.length,(function(){return"Error in slice".concat(e.rank,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(e.rank,").")}));for(var r=function(r){Kt(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice".concat(e.rank,"D: begin[").concat(r,"] + size[").concat(r,"] ")+"(".concat(t[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(e.shape[r],")")}))},a=0;a<e.rank;++a)r(a)}(r,o,i);var u={x:r},s={begin:t,size:n};return ir.runKernelFunc((function(e,t){return t([r]),e.slice(r,o,i)}),u,null,st,s)}});var to=vr({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=hr(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var r={logits:n},a={dim:t};return ir.runKernelFunc((function(e,r){var a=e.softmax(n,t);return r([a]),a}),r,null,gt,a)}});var no=vr({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=null,r=hr(e,"x","expandDims",n);Kt(t<=r.rank,(function(){return"Axis must be <= rank of the tensor"}));var a=r.shape.slice();return t<0&&(Kt(-(r.rank+1)<=t,(function(){return"Axis must be in the interval [".concat(-(r.rank+1),", ").concat(r.rank,"]")})),t=r.rank+t+1),a.splice(t,0,1),ja(r,a)}});var ro=vr({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=mr(e,"tensors","stack");if(Kt(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return no(n[0],t);var r=n[0].rank,a=n[0].shape,o=n[0].dtype;Kt(t<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){qt(a,e.shape,"All tensors passed to stack must have matching shapes"),Kt(o===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var i=n.map((function(e){return no(e,t)}));return Oa(i,t)}});var ao=vr({sub_:function(e,t){var n=hr(e,"a","sub"),r=hr(t,"b","sub"),a=E(Zn(n,r),2);n=a[0],r=a[1];var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.subtract(n,r);return t([n,r]),a}),o,null,"Sub")}});function oo(e,t,n){if(Xt(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=fr(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return yr(e,t,r,n)}var io=vr({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=hr(e,"x","unstack");Kt(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")})),t<0&&(t+=n.shape.length);var r={value:n},a={axis:t},o=function(e){return e.unstack(n,t)};return ir.runKernelFunc(o,r,null,Nt,a)}});function uo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)Kt(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);Kt(a<=1,(function(){return"There should be only one negative value in split array."}));var o=t.indexOf(-1);if(-1!==o){var i=t.reduce((function(e,t){return t>0?e+t:e}));t[o]=e.shape[n]-i}Kt(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}var so=vr({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=hr(e,"x","split"),a=function(e,a){var o=nn(n,r.shape)[0],i=uo(r,t,o);return e.split(r,i,o)},o={x:r},i={numOrSizeSplits:t,axis:n};return ir.runKernelFunc(a,o,null,vt,i)}});var co=vr({zerosLike_:function(e){var t=hr(e,"x","zerosLike"),n={x:t};return ir.runKernelFunc((function(e){return e.zerosLike(t)}),n,null,Rt)}});var lo=vr({fft_:function(e){Kt("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return ir.runKernelFunc((function(t){var n=e.shape[e.shape.length-1],r=e.size/n,a=e.as2D(r,n);return t.fft(a).reshape(e.shape)}),t,null,"FFT")}});var fo=vr({rfft_:function(e,t){Kt("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var o=e.shape.map((function(e){return 0})),i=e.shape.map((function(e){return e}));i[e.shape.length-1]=t,n=eo(e,o,i),r=t}else if(null!=t&&t>r){var u=e.shape.map((function(e){return e}));u[e.shape.length-1]=t-r,n=Oa([e,Ya(u)],e.shape.length-1),r=t}else n=e;var s=co(n),c=ja(gr(n,s),[a,r]),l=lo(c),f=Math.floor(r/2)+1,p=$a(l),d=La(l),h=so(p,[f,r-f],p.shape.length-1),m=so(d,[f,r-f],d.shape.length-1),v=n.shape.slice();return v[n.shape.length-1]=f,ja(gr(h[0],m[0]),v)}});var po=vr({ifft_:function(e){Kt("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return ir.runKernelFunc((function(t){var n=e.shape[e.shape.length-1],r=e.size/n,a=ja(e,[r,n]),o=t.ifft(a);return ja(o,e.shape)}),t,null,"IFFT")}});var ho=vr({reverse_:function(e,t){var n=hr(e,"x","reverse"),r={x:n},a={dims:t};return ir.runKernelFunc((function(e){var r=nn(t,n.shape);if(0===n.rank)return aa(n);var a=e.reverse(n,r);return ja(a,n.shape)}),r,null,rt,a)}});var mo=vr({irfft_:function(e){var t,n=e.shape[e.shape.length-1],r=e.size/n;if(n<=2){var a=ja(e,[r,n]);t=po(a)}else{var o=[r,2*(n-1)],i=ja($a(e),[r,n]),u=ja(La(e),[r,n]),s=ho(eo(i,[0,1],[r,n-2]),1),c=qa(ho(eo(u,[0,1],[r,n-2]),1),Ja(-1)),l=Oa([i,s],1),f=Oa([u,c],1),p=ja(gr(l,f),[o[0],o[1]]);t=po(p)}if(t=$a(t),3===e.rank&&0!==e.shape[0]){var d=t,h=e.shape[0];t=ja(t,[h,t.shape[0]/h,t.shape[1]]),d.dispose()}return t}});function vo(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function go(e,t,n){for(var r=1-e%2,a=new Float32Array(e),o=0;o<e;++o){var i=2*Math.PI*o/(e+r-1);a[o]=t-n*Math.cos(i)}return Xa(a,"float32")}vr({hammingWindow_:function(e){return go(e,.54,.46)}});var yo=vr({hannWindow_:function(e){return go(e,.5,.5)}});function xo(e,t,n){var r={shape:e,value:t,dtype:n};return ir.runKernelFunc((function(r){return r.fill(e,t,n)}),{},null,"Fill",r)}var bo=vr({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=0,i=[];o+t<=e.size;)i.push(eo(e,o,t)),o+=n;if(r)for(;o<e.size;){var u=o+t-e.size,s=Oa([eo(e,o,t-u),xo([u],a)]);i.push(s),o+=n}return 0===i.length?oo([],[0,t]):ja(Oa(i),[i.length,t])}});vr({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:yo;null==r&&(r=vo(t));for(var o=bo(e,t,n),i=qa(o,a(t)),u=[],s=0;s<o.shape[0];s++)u.push(fo(eo(i,[s,0],[1,t]),r));return Oa(u)}});var wo=vr({cropAndResize_:function(e,t,n,r,a,o){var i=hr(e,"image","cropAndResize"),u=hr(t,"boxes","cropAndResize","float32"),s=hr(n,"boxInd","cropAndResize","int32");a=a||"bilinear",o=o||0;var c=u.shape[0];Kt(4===i.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(i.rank,".")})),Kt(2===u.rank&&4===u.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(c,",4] ")+"but had shape ".concat(u.shape,".")})),Kt(1===s.rank&&s.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(c,"] ")+"but had shape ".concat(u.shape,".")})),Kt(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),Kt(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),Kt("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:i,boxes:u,boxInd:s},f={method:a,extrapolationValue:o,cropSize:r},p=ir.runKernelFunc((function(e){return e.cropAndResize(i,u,s,r,a,o)}),l,null,"CropAndResize",f);return p}});var ko=vr({flipLeftRight_:function(e){var t=hr(e,"image","flipLeftRight","float32");Kt(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return ir.runKernel(ye,n,{})}});var Co=vr({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=hr(e,"image","rotateWithOffset","float32");Kt(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var o={image:a},i={radians:t,fillValue:n,center:r},u=ir.runKernel(At,o,i);return u}});function Eo(e,t,n,r,a,o){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==o&&(o=0);var i=e.shape[0];return n=Math.min(n,i),Kt(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),Kt(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),Kt(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),Kt(1===t.rank,(function(){return"scores must be a 1D tensor"})),Kt(t.shape[0]===i,(function(){return"scores has incompatible shape with boxes. Expected ".concat(i,", ")+"but was ".concat(t.shape[0])})),Kt(0<=o&&o<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(o,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:o}}var So=vr({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=hr(e,"boxes","nonMaxSuppression"),i=hr(t,"scores","nonMaxSuppression"),u=Eo(o,i,n,r,a);n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold;var s={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return ir.runKernelFunc((function(e){return e.nonMaxSuppression(o,i,n,r,a)}),{boxes:o,scores:i},null,We,s)}});function No(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,o=0,i=!1;for(;r<a;){var u=n(t,e[o=r+(a-r>>>1)]);u>0?r=o+1:(a=o,i=!u)}return i?r:-r-1}(e,t,n||To)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function To(e,t){return e>t?1:e<t?-1:0}function Ro(e,t,n,r,a){return Ao(e,t,n,r,a,0).selectedIndices}function Io(e,t,n,r,a,o){return Ao(e,t,n,r,a,0,!1,o,!0)}function _o(e,t,n,r,a,o){return Ao(e,t,n,r,a,o,!0)}function Ao(e,t,n,r,a,o){for(var i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],s=arguments.length>8&&void 0!==arguments[8]&&arguments[8],c=[],l=0;l<t.length;l++)t[l]>a&&c.push({score:t[l],boxIndex:l,suppressBeginIndex:0});c.sort(Fo);for(var f=o>0?-.5/o:0,p=[],d=[];p.length<n&&c.length>0;){var h=c.pop(),m=h.score,v=h.boxIndex,g=h.suppressBeginIndex;if(m<a)break;for(var y=!1,x=p.length-1;x>=g;--x){var b=Oo(e,v,p[x]);if(b>=r){y=!0;break}if(h.score=h.score*Do(r,f,b),h.score<=a)break}h.suppressBeginIndex=p.length,y||(h.score===m?(p.push(v),d.push(h.score)):h.score>a&&No(c,h,Fo))}var w=p.length,k=n-w;u&&k>0&&(p.push.apply(p,R(new Array(k).fill(0))),d.push.apply(d,R(new Array(k).fill(0))));var C={selectedIndices:Xa(p,"int32")};return i&&(C.selectedScores=Xa(d,"float32")),s&&(C.validOutputs=Ja(w,"int32")),C}function Oo(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),u=Math.max(r[0],r[2]),s=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),p=Math.max(a[1],a[3]),d=(u-o)*(s-i),h=(f-c)*(p-l);if(d<=0||h<=0)return 0;var m=Math.max(o,c),v=Math.max(i,l),g=Math.min(u,f),y=Math.min(s,p),x=Math.max(g-m,0)*Math.max(y-v,0);return x/(d+h-x)}function Do(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function Fo(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function Po(){return Po=w(N().mark((function e(t,n,r){var a,o,i,u,s,c,l,f,p,d=arguments;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=d.length>3&&void 0!==d[3]?d[3]:.5,o=d.length>4&&void 0!==d[4]?d[4]:Number.NEGATIVE_INFINITY,i=hr(t,"boxes","nonMaxSuppressionAsync"),u=hr(n,"scores","nonMaxSuppressionAsync"),s=Eo(i,u,r,a,o),r=s.maxOutputSize,a=s.iouThreshold,o=s.scoreThreshold,e.next=10,Promise.all([i.data(),u.data()]);case 10:return c=e.sent,l=c[0],f=c[1],p=Ro(l,f,r,a,o),i!==t&&i.dispose(),u!==n&&u.dispose(),e.abrupt("return",p);case 17:case"end":return e.stop()}}),e)}))),Po.apply(this,arguments)}var Lo=function(e,t,n){return Po.apply(this,arguments)};var Mo=vr({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=hr(e,"boxes","nonMaxSuppression"),u=hr(t,"scores","nonMaxSuppression"),s=Eo(i,u,n,r,a,o),c={boxes:i,scores:u},l={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold,softNmsSigma:o=s.softNmsSigma},f=ir.runKernel(je,c,l);return{selectedIndices:f[0],selectedScores:f[1]}}});function Bo(){return Bo=w(N().mark((function e(t,n,r){var a,o,i,u,s,c,l,f,p,d,h=arguments;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.length>3&&void 0!==h[3]?h[3]:.5,o=h.length>4&&void 0!==h[4]?h[4]:Number.NEGATIVE_INFINITY,i=h.length>5&&void 0!==h[5]?h[5]:0,u=hr(t,"boxes","nonMaxSuppressionAsync"),s=hr(n,"scores","nonMaxSuppressionAsync"),c=Eo(u,s,r,a,o,i),r=c.maxOutputSize,a=c.iouThreshold,o=c.scoreThreshold,i=c.softNmsSigma,e.next=12,Promise.all([u.data(),s.data()]);case 12:return l=e.sent,f=l[0],p=l[1],d=_o(f,p,r,a,o,i),u!==t&&u.dispose(),s!==n&&s.dispose(),e.abrupt("return",d);case 19:case"end":return e.stop()}}),e)}))),Bo.apply(this,arguments)}var zo=function(e,t,n){return Bo.apply(this,arguments)};var Vo=vr({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=hr(e,"boxes","nonMaxSuppression"),u=hr(t,"scores","nonMaxSuppression"),s=Eo(i,u,n,r,a,null),c=s.maxOutputSize,l=s.iouThreshold,f=s.scoreThreshold,p={boxes:i,scores:u},d={maxOutputSize:c,iouThreshold:l,scoreThreshold:f,padToMaxOutputSize:o},h=ir.runKernel(Ge,p,d);return{selectedIndices:h[0],validOutputs:h[1]}}});function Uo(){return Uo=w(N().mark((function e(t,n,r){var a,o,i,u,s,c,l,f,p,d,h,m,v,g,y=arguments;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=y.length>3&&void 0!==y[3]?y[3]:.5,o=y.length>4&&void 0!==y[4]?y[4]:Number.NEGATIVE_INFINITY,i=y.length>5&&void 0!==y[5]&&y[5],u=hr(t,"boxes","nonMaxSuppressionAsync"),s=hr(n,"scores","nonMaxSuppressionAsync"),c=Eo(u,s,r,a,o,null),l=c.maxOutputSize,f=c.iouThreshold,p=c.scoreThreshold,e.next=11,Promise.all([u.data(),s.data()]);case 11:return d=e.sent,h=E(d,2),m=h[0],v=h[1],g=Io(m,v,l,f,p,i),u!==t&&u.dispose(),s!==n&&s.dispose(),e.abrupt("return",g);case 19:case"end":return e.stop()}}),e)}))),Uo.apply(this,arguments)}var Wo=function(e,t,n){return Uo.apply(this,arguments)};var Go=vr({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"images","resizeBilinear");Kt(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,".")})),Kt(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")}));var a=r,o=!1;3===r.rank&&(o=!0,a=ja(r,[1,r.shape[0],r.shape[1],r.shape[2]]));var i=E(t,2),u=i[0],s=i[1],c=function(e,t){return t([a]),e.resizeBilinear(a,u,s,n)},l={images:a},f={alignCorners:n,size:t},p=ir.runKernelFunc(c,l,null,tt,f);return o?ja(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});var jo=vr({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"images","resizeNearestNeighbor");Kt(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(r.rank,".")})),Kt(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),Kt("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=r,o=!1;3===r.rank&&(o=!0,a=ja(r,[1,r.shape[0],r.shape[1],r.shape[2]]));var i=E(t,2),u=i[0],s=i[1],c={images:a},l={alignCorners:n,size:t},f=function(e,t){return t([a]),e.resizeNearestNeighbor(a,u,s,n)},p=ir.runKernelFunc(f,c,null,et,l);return o?ja(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});function Ho(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],o=t.length-r-1,i=t[o];(null==a||1===a&&i>1)&&n.unshift(o)}return n}function Ko(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var o=e[e.length-a-1];null==o&&(o=1);var i=t[t.length-a-1];if(null==i&&(i=1),1===o)n.unshift(i);else if(1===i)n.unshift(o);else{if(o!==i){var u="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(u)}n.unshift(o)}}return n}var qo=vr({greaterEqual_:function(e,t){var n=hr(e,"a","greaterEqual"),r=hr(t,"b","greaterEqual"),a=E(Zn(n,r),2);n=a[0],r=a[1],Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.greaterEqual(n,r);return t([n,r]),a}),o,null,Ce)}});var Xo=vr({lessEqual_:function(e,t){var n=hr(e,"a","lessEqual"),r=hr(t,"b","lessEqual"),a=E(Zn(n,r),2);n=a[0],r=a[1],Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.lessEqual(n,r);return t([n,r]),a}),o,null,"LessEqual")}});var Yo=vr({logicalAnd_:function(e,t){var n=hr(e,"a","logicalAnd","bool"),r=hr(t,"b","logicalAnd","bool");Ko(n.shape,r.shape);var a={a:n,b:r};return ir.runKernelFunc((function(e){return e.logicalAnd(n,r)}),a,null,"LogicalAnd")}});var Qo=vr({broadcastTo_:function(e,t){var n=hr(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!==0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=ja(n,a)}for(var o=n.shape,i=Array.from(t),u=t.length-1;u>=0;u--)if(o[u]===t[u])i[u]=1;else if(1!==n.shape[u])throw new Error("broadcastTo(): [".concat(r,"] cannot be broadcast to [").concat(t,"]."));var s=i.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));if(0===s.length)return aa(n);var c={x:n},l={shape:t,inputShape:o};return ir.runKernelFunc((function(e){return e.tile(n,i)}),c,null,ne,l)}});var $o=vr({where_:function(e,t,n){var r=hr(t,"a","where"),a=hr(n,"b","where"),o=hr(e,"condition","where","bool"),i=Ko(r.shape,a.shape),u=Qo(r,i),s=Qo(a,i);1===o.rank&&Kt(o.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})),1!==o.rank&&qt(o.shape,s.shape,"Error in where: ");var c={condition:o,t:u,e:s};return ir.runKernelFunc((function(e,t){var n=e.select(o,u,s);return t([o]),n}),c,null,it)}});vr({bandPart_:function(e,t,n){Kt(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),Kt(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=hr(e,"a","bandPart");Kt(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,o=E(r.shape.slice(-2),2),i=o[0],u=o[1];if(!(t<=i))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(i,")."));if(!(n<=u))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(u,")."));t<0&&(t=i),n<0&&(n=u);var s=ja(Qa(0,i,1,"int32"),[-1,1]),c=Qa(0,u,1,"int32"),l=ao(s,c),f=Yo(Xo(l,Ja(+t,"int32")),qo(l,Ja(-n,"int32"))),p=Ya([i,u],r.dtype);return ja(ro(io(ja(r,[-1,i,u])).map((function(e){return $o(f,e,p)}))),a)}});var Jo=vr({abs_:function(e){var t=hr(e,"x","abs"),n={x:t};return ir.runKernelFunc((function(e,n){return n([t]),"complex64"===t.dtype?e.complexAbs(t):e.abs(t)}),n,null,"Abs")}});var Zo=vr({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"x","min"),a=function(e,a){var o=nn(t,r.shape),i=o,u=Ua(i,r.rank),s=r;null!=u&&(s=Ha(r,u),i=Ga(i.length,r.rank));var c=e.min(s,i);null!=u&&s.dispose();var l=c;if(n){var f=za(l.shape,o);l=ja(c,f),c.dispose()}return a([r,l]),l},o={x:r},i={axis:t,keepDims:n};return ir.runKernelFunc(a,o,null,Be,i)}});var ei=vr({pow_:function(e,t){var n=hr(e,"base","pow"),r=hr(t,"exp","pow"),a=E(Zn(n,r),2);n=a[0],r=a[1];var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.pow(n,r);return t([n,r,a]),a}),o,null,"Pow")}});var ti=vr({sqrt_:function(e){var t=hr(e,"x","sqrt"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.sqrt(t);return n([t]),r}),n,null,dt)}});var ni=vr({square_:function(e){var t=hr(e,"x","square"),n=[t];return ir.runKernelFunc((function(e,n){return n([t]),e.square(t)}),{x:t},null,"Square",{},n,[])}});var ri=vr({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"x","sum");"bool"===r.dtype&&(r=ra(r,"int32"));var a=function(e,a){a([r]);var o=nn(t,r.shape),i=Ua(o,r.rank),u=o,s=r;null!=i&&(s=Ha(r,i),u=Ga(u.length,r.rank));var c=e.sum(s,u);if(n){var l=za(c.shape,o);c=ja(c,l)}return c},o={x:r},i={axis:t,keepDims:n};return ir.runKernelFunc(a,o,null,ht,i)}});function ai(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return Jo(e);if(1!==e.rank&&null===n)return ai(ja(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return ri(Jo(e),n);if(t===1/0)return Ka(Jo(e),n);if(t===-1/0)return Zo(Jo(e),n);if("euclidean"===t||2===t)return ti(ri(ei(Jo(e),Ja(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return Ka(ri(Jo(e),n[0]),n[1]-1);if(t===1/0)return Ka(ri(Jo(e),n[1]),n[0]);if(t===-1/0)return Zo(ri(Jo(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return ti(ri(ni(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var oi=vr({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=ai(e=hr(e,"x","norm"),t,n),o=a.shape;if(r){var i=nn(n,e.shape);o=za(a.shape,i)}return ja(a,o)}});var ii=vr({squeeze_:function(e,t){var n=hr(e,"x","squeeze");return ja(n,rn(n.shape,t).newShape)}});vr({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,Kt(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){Kt(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=so(e,e.shape[0],0).map((function(e){return ii(e,[0])}))),Kt(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(ir.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var o=qa(ri(qa(n[a],t)),n[a]);t=ao(t,o)}return Pa(t,oi(t,"euclidean"))})))},o=0;o<e.length;++o)a(o);return t?ro(n,0):n}});function ui(e){P().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function si(){return ir}function ci(e,t){return ir.tidy(e,t)}function li(e){er(e).forEach((function(e){return e.dispose()}))}function fi(e){return ir.keep(e)}var pi=vr({tile_:function(e,t){var n=hr(e,"x","tile",null);Kt(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var r=[n],a={x:n},o={reps:t};return ir.runKernelFunc((function(e,r){var a=e.tile(n,t);return r([n]),a}),a,null,Ct,o,r)}});var di=vr({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=na([e,t],r),o=e<=t?e:t,i=0;i<o;++i)a.set(1,i,i);var u=ja(a.toTensor(),[e,t]);if(null==n)return u;if(1===n.length)return pi(no(u,0),[n[0],1,1]);if(2===n.length)return pi(no(no(u,0),0),[n[0],n[1],1,1]);if(3===n.length)return pi(no(no(no(u,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}});var hi=vr({greater_:function(e,t){var n=hr(e,"a","greater"),r=hr(t,"b","greater"),a=E(Zn(n,r),2);n=a[0],r=a[1],Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e){return e.greater(n,r)}),o,null,"Greater")}});var mi=vr({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=hr(e,"a","matMul"),o=hr(t,"b","matMul"),i=Zn(a,o),u=E(i,2);a=u[0],o=u[1],Kt(a.rank>=2&&o.rank>=2&&a.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, "+"got ranks ".concat(a.rank," and ").concat(o.rank,".")}));var s=n?a.shape[a.rank-2]:a.shape[a.rank-1],c=r?o.shape[o.rank-1]:o.shape[o.rank-2],l=n?a.shape[a.rank-1]:a.shape[a.rank-2],f=r?o.shape[o.rank-2]:o.shape[o.rank-1],p=a.shape.slice(0,-2),d=o.shape.slice(0,-2),h=Qt(p),m=Qt(d);Kt($t(p,d),(function(){return"Error in matMul: outer dimensions (".concat(p,") and (")+"".concat(d,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(o.shape," must match.")})),Kt(s===c,(function(){return"Error in matMul: inner shapes (".concat(s,") and (")+"".concat(c,") of Tensors with shapes ").concat(a.shape," and ")+"".concat(o.shape," and transposeA=").concat(n)+" and transposeB=".concat(r," must match.")}));var v=a.shape.slice(0,-2).concat([l,f]),g=ja(a,n?[h,s,l]:[h,l,s]),y=ja(o,r?[m,f,c]:[m,c,f]),x=function(e,t){return t([g,y]),e.batchMatMul(g,y,n,r)},b={a:g,b:y},w={transposeA:n,transposeB:r},k=ir.runKernelFunc(x,b,null,ee,w);return ja(k,v)}});var vi=vr({neg_:function(e){var t=hr(e,"x","neg"),n={x:t};return ir.runKernelFunc((function(e){return e.neg(t)}),n,null,Ue)}});function gi(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return ir.tidy((function(){Kt(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=di(n),o=aa(e),i=oo([[1]],[1,1]),u=aa(i),s=n>=r?r:n,c=function(e){var t=o,s=u,c=a,l=E(ir.tidy((function(){var t=eo(o,[e,e],[n-e,1]),s=oi(t),c=eo(o,[e,e],[1,1]),l=$o(hi(c,0),oo([[-1]]),oo([[1]])),f=ao(c,qa(l,s)),p=Pa(t,f);u=1===p.shape[0]?aa(i):Oa([i,eo(p,[1,0],[p.shape[0]-1,p.shape[1]])],0);var d=vi(Pa(mi(l,f),s)),h=eo(o,[e,0],[n-e,r]),m=qa(d,u),v=Ha(u);if(0===e)o=ao(h,mi(m,mi(v,h)));else{var g=ao(h,mi(m,mi(v,h)));o=Oa([eo(o,[0,0],[e,r]),g],0)}var y=Ha(m),x=eo(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=ao(x,mi(mi(x,u),y));else{var b=ao(x,mi(mi(x,u),y));a=Oa([eo(a,[0,0],[n,e]),b],1)}return[u,o,a]})),3);u=l[0],o=l[1],a=l[2],li([t,s,c])},l=0;l<s;++l)c(l);return!t&&n>r&&(a=eo(a,[0,0],[n,r]),o=eo(o,[0,0],[r,r])),[a,o]}))}var yi;vr({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Kt(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return gi(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=io(ja(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],o=[];r.forEach((function(e){var n=E(gi(e,t),2),r=n[0],i=n[1];a.push(r),o.push(i)}));var i=ja(ro(a,0),e.shape),u=ja(ro(o,0),e.shape);return[i,u]}});function xi(e){return ir.customGrad(e)}function bi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=bi(e,"float32"),r=Ya(e,"float32");return gr(n,r)}var a=gn(Qt(e),t);return ir.makeTensor(a,e,t)}!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(yi||(yi={}));var wi=vr({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"x","mean"),a=nn(t,r.shape),o=Ba(r.shape,a),i=o[1],u=Qt(i),s=xi((function(e){var r=Ja(u),o=r.dtype===e.dtype?e:ra(e,r.dtype),i=Pa(o,r);return{value:ri(i,t,n),gradFunc:function(t){var n=e.shape.slice();a.forEach((function(e){n[e]=1}));var r=ja(t,n);return Pa(qa(r,bi(e.shape,"float32")),u)}}}));return s(r)}});var ki=vr({notEqual_:function(e,t){var n=hr(e,"a","notEqual"),r=hr(t,"b","notEqual"),a=E(Zn(n,r),2);n=a[0],r=a[1],Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e){return e.notEqual(n,r)}),o,null,"NotEqual")}});var Ci=vr({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:yi.SUM_BY_NONZERO_WEIGHTS,r=hr(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=hr(t,"weights","computeWeightedLoss"));var o=null==a?r:qa(r,a);if(n===yi.NONE)return o;if(n===yi.SUM)return ri(o);if(n===yi.MEAN){if(null==a)return wi(o);var i=r.size/a.size,u=Pa(ri(o),ri(a));return i>1?Pa(u,Ja(i)):u}if(n===yi.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Pa(ri(o),Ja(r.size));var s=qa(a,bi(r.shape)),c=ra(ri(ki(s,Ja(0))),"float32");return Pa(ri(o),c)}throw Error("Unknown reduction: ".concat(n))}});vr({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yi.SUM_BY_NONZERO_WEIGHTS,a=hr(e,"labels","absoluteDifference"),o=hr(t,"predictions","absoluteDifference"),i=null;null!=n&&(i=hr(n,"weights","absoluteDifference")),qt(a.shape,o.shape,"Error in absoluteDifference: ");var u=Jo(ao(a,o));return Ci(u,i,r)}});vr({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:yi.SUM_BY_NONZERO_WEIGHTS,o=hr(e,"labels","cosineDistance"),i=hr(t,"predictions","cosineDistance"),u=null;null!=r&&(u=hr(r,"weights","cosineDistance")),qt(o.shape,i.shape,"Error in cosineDistance: ");var s=Ja(1),c=ao(s,ri(qa(o,i),n,!0));return Ci(c,u,a)}});var Ei=vr({relu_:function(e){var t=hr(e,"x","relu"),n={x:t};return ir.runKernelFunc((function(e,n){return n([t]),"bool"===t.dtype?ra(t,"int32"):e.relu(t)}),n,null,Je)}});vr({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yi.SUM_BY_NONZERO_WEIGHTS,a=hr(e,"labels","hingeLoss"),o=hr(t,"predictions","hingeLoss"),i=null;null!=n&&(i=hr(n,"weights","hingeLoss")),qt(a.shape,o.shape,"Error in hingeLoss: ");var u=Ja(1);a=ao(qa(Ja(2),a),u);var s=Ei(ao(u,qa(a,o)));return Ci(s,i,r)}});var Si=vr({minimum_:function(e,t){var n=hr(e,"a","minimum"),r=hr(t,"b","minimum"),a=E(Zn(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=ra(n,"int32"),r=ra(r,"int32")),Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.minimum(n,r);return t([n,r]),a}),o,null,ze)}});vr({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:yi.SUM_BY_NONZERO_WEIGHTS,o=hr(e,"labels","huberLoss"),i=hr(t,"predictions","huberLoss"),u=null;null!=n&&(u=hr(n,"weights","huberLoss")),qt(o.shape,i.shape,"Error in huberLoss: ");var s=Ja(r),c=Jo(ao(i,o)),l=Si(c,s),f=ao(c,l),p=Ia(qa(Ja(.5),ni(l)),qa(s,f));return Ci(p,u,a)}});var Ni=vr({log_:function(e){var t=hr(e,"x","log"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.log(t);return n([t]),r}),n,null,"Log")}});vr({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:yi.SUM_BY_NONZERO_WEIGHTS,o=hr(e,"labels","logLoss"),i=hr(t,"predictions","logLoss"),u=null;null!=n&&(u=hr(n,"weights","logLoss")),qt(o.shape,i.shape,"Error in logLoss: ");var s=Ja(1),c=Ja(r),l=vi(qa(o,Ni(Ia(i,c)))),f=qa(ao(s,o),Ni(Ia(ao(s,i),c))),p=ao(l,f);return Ci(p,u,a)}});var Ti=vr({squaredDifference_:function(e,t){var n=hr(e,"a","squaredDifference"),r=hr(t,"b","squaredDifference"),a=E(Zn(n,r),2);n=a[0],r=a[1],Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.squaredDifference(n,r);return t([n,r]),a}),o,null,yt,{})}});vr({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:yi.SUM_BY_NONZERO_WEIGHTS,a=hr(e,"labels","meanSquaredError"),o=hr(t,"predictions","meanSquaredError"),i=null;null!=n&&(i=hr(n,"weights","meanSquaredError")),qt(a.shape,o.shape,"Error in meanSquaredError: ");var u=Ti(a,o);return Ci(u,i,r)}});var Ri=vr({exp_:function(e){var t=hr(e,"x","exp"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.exp(t);return n([r]),r}),n,null,"Exp")}});var Ii=vr({log1p_:function(e){var t=hr(e,"x","log1p"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.log1p(t);return n([t]),r}),n,null,Re)}});function _i(e,t){var n=hr(e,"labels","sigmoidCrossEntropyWithLogits"),r=hr(t,"logits","sigmoidCrossEntropyWithLogits");qt(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=Ei(r),o=qa(r,n),i=Ii(Ri(vi(Jo(r))));return Ia(ao(a,o),i)}vr({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:yi.SUM_BY_NONZERO_WEIGHTS,o=hr(e,"multiClassLabels","sigmoidCrossEntropy"),i=hr(t,"logits","sigmoidCrossEntropy"),u=null;if(null!=n&&(u=hr(n,"weights","sigmoidCrossEntropy")),qt(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){var s=Ja(r),c=Ja(1),l=Ja(.5);o=Ia(qa(o,ao(c,s)),qa(l,s))}var f=_i(o,i);return Ci(f,u,a)}});var Ai=vr({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"x","logSumExp"),a=nn(t,r.shape),o=Ka(r,a,!0),i=ao(r,o),u=Ri(i),s=ri(u,a),c=Ni(s),l=Ia(ja(o,c.shape),c);if(n){var f=za(l.shape,a);return ja(l,f)}return l}});function Oi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=xi((function(e,t,r){var a=Ai(t,[n],!0),o=ao(ra(t,"float32"),a);r([e,o]);var i=vi(qa(o,e));return{value:ri(i,[n]),gradFunc:function(e,t){var r=E(t,2),a=r[0],o=r[1],i=za(e.shape,[n]);return[qa(ja(e,i),ao(ra(a,"float32"),Ri(o))),qa(ja(e,i),ao(Ri(o),ra(a,"float32")))]}}}));return r(e,t)}vr({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:yi.SUM_BY_NONZERO_WEIGHTS,o=hr(e,"onehotLabels","softmaxCrossEntropy"),i=hr(t,"logits","softmaxCrossEntropy"),u=null;if(null!=n&&(u=hr(n,"weights","softmaxCrossEntropy")),qt(o.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){var s=Ja(r),c=Ja(1),l=Ja(o.shape[1]);o=Ia(qa(o,ao(c,s)),Pa(s,l))}var f=Oi(o,i);return Ci(f,u,a)}});var Di={flipLeftRight:ko,resizeNearestNeighbor:jo,resizeBilinear:Go,rotateWithOffset:Co,cropAndResize:wo,nonMaxSuppression:So,nonMaxSuppressionAsync:Lo,nonMaxSuppressionWithScore:Mo,nonMaxSuppressionWithScoreAsync:zo,nonMaxSuppressionPadded:Vo,nonMaxSuppressionPaddedAsync:Wo};function Fi(e,t,n,r,a,o){var i,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",s=zi(t),c=E(s,2),l=c[0],f=c[1];if("channelsLast"===u)i=[l,f,e[3],e[3]];else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));i=[l,f,e[1],e[1]]}return Li(e,i,n,r,a,o,!1,u)}function Pi(e,t,n,r,a,o){var i,u,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",c=Vi(t),l=E(c,3),f=l[0],p=l[1],d=l[2];if("NDHWC"===s)u="channelsLast",i=[f,p,d,e[4],e[4]];else{if("NCDHW"!==s)throw new Error("Unknown dataFormat ".concat(s));u="channelsFirst",i=[f,p,d,e[1],e[1]]}return Mi(e,i,n,r,a,!1,u,o)}function Li(e,t,n,r,a,o){var i=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",s=-1,c=-1,l=-1,f=-1;if("channelsLast"===u){var p=E(e,4);s=p[0],c=p[1],l=p[2],f=p[3]}else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));var d=E(e,4);s=d[0],f=d[1],c=d[2],l=d[3]}var h,m=E(t,4),v=m[0],g=m[1],y=m[3],x=zi(n),b=E(x,2),w=b[0],k=b[1],C=zi(r),S=E(C,2),N=S[0],T=S[1],R=Ui(v,N),I=Ui(g,T),_=Wi(a,c,l,w,k,R,I,o,u),A=_.padInfo,O=_.outHeight,D=_.outWidth,F=i?y*f:y;return"channelsFirst"===u?h=[s,F,O,D]:"channelsLast"===u&&(h=[s,O,D,F]),{batchSize:s,dataFormat:u,inHeight:c,inWidth:l,inChannels:f,outHeight:O,outWidth:D,outChannels:F,padInfo:A,strideHeight:w,strideWidth:k,filterHeight:v,filterWidth:g,effectiveFilterHeight:R,effectiveFilterWidth:I,dilationHeight:N,dilationWidth:T,inShape:e,outShape:h,filterShape:t}}function Mi(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",u=arguments.length>7?arguments[7]:void 0,s=-1,c=-1,l=-1,f=-1,p=-1;if("channelsLast"===i){var d=E(e,5);s=d[0],c=d[1],l=d[2],f=d[3],p=d[4]}else{if("channelsFirst"!==i)throw new Error("Unknown dataFormat ".concat(i));var h=E(e,5);s=h[0],p=h[1],c=h[2],l=h[3],f=h[4]}var m,v=E(t,5),g=v[0],y=v[1],x=v[2],b=v[4],w=Vi(n),k=E(w,3),C=k[0],S=k[1],N=k[2],T=Vi(r),R=E(T,3),I=R[0],_=R[1],A=R[2],O=Ui(g,I),D=Ui(y,_),F=Ui(x,A),P=Gi(a,c,l,f,C,S,N,O,D,F,u),L=P.padInfo,M=P.outDepth,B=P.outHeight,z=P.outWidth,V=o?b*p:b;return"channelsFirst"===i?m=[s,V,M,B,z]:"channelsLast"===i&&(m=[s,M,B,z,V]),{batchSize:s,dataFormat:i,inDepth:c,inHeight:l,inWidth:f,inChannels:p,outDepth:M,outHeight:B,outWidth:z,outChannels:V,padInfo:L,strideDepth:C,strideHeight:S,strideWidth:N,filterDepth:g,filterHeight:y,filterWidth:x,effectiveFilterDepth:O,effectiveFilterHeight:D,effectiveFilterWidth:F,dilationDepth:I,dilationHeight:_,dilationWidth:A,inShape:e,outShape:m,filterShape:t}}function Bi(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=Ui(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function zi(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function Vi(e){return"number"===typeof e?[e,e,e]:e}function Ui(e,t){return t<=1?e:e+(e-1)*(t-1)}function Wi(e,t,n,r,a,o,i,u,s){var c,l,f;if("number"===typeof e){c={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var p=function(e,t,n,r,a){null==r&&(r=Bi(e,t,n));var o=e[0],i=e[1],u=ji((o-t+2*r)/n+1,a);Kt(Jt(u),(function(){return"The output # of rows (".concat(u,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var s=ji((i-t+2*r)/n+1,a);return Kt(Jt(s),(function(){return"The output # of columns (".concat(s,") must be an integer. ")+"Change the stride and/or zero pad parameters"})),[u,s]}([t,n],o,r,e,u);l=p[0],f=p[1]}else if("same"===e){l=Math.ceil(t/r),f=Math.ceil(n/a);var d=Math.max(0,(l-1)*r+o-t),h=Math.max(0,(f-1)*a+i-n),m=Math.floor(d/2),v=d-m,g=Math.floor(h/2);c={top:m,bottom:v,left:g,right:h-g,type:"SAME"}}else if("valid"===e)c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((t-o+1)/r),f=Math.ceil((n-i+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var y="channelsLast"===s?e[1][0]:e[2][0],x="channelsLast"===s?e[1][1]:e[2][1],b="channelsLast"===s?e[2][0]:e[3][0],w="channelsLast"===s?e[2][1]:e[3][1];c={top:y,bottom:x,left:b,right:w,type:0===y&&0===x&&0===b&&0===w?"VALID":"EXPLICIT"},l=ji((t-o+y+x)/r+1,u),f=ji((n-i+b+w)/a+1,u)}return{padInfo:c,outHeight:l,outWidth:f}}function Gi(e,t,n,r,a,o,i,u,s,c,l){var f,p,d,h;if("number"===typeof e){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var m=function(e,t,n,r,a,o){null==a&&(a=Bi(e,t,r));var i=e[0],u=e[1],s=e[2],c=ji((i-t+2*a)/r+1,o);Kt(Jt(c),(function(){return"The output # of depths (".concat(c,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var l=ji((u-t+2*a)/r+1,o);Kt(Jt(l),(function(){return"The output # of rows (".concat(l,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var f=ji((s-t+2*a)/r+1,o);return Kt(Jt(f),(function(){return"The output # of columns (".concat(f,") must be an integer. ")+"Change the stride and/or zero pad parameters"})),[c,l,f,n]}([t,n,r,1],u,1,a,e,l);p=m[0],d=m[1],h=m[2]}else if("same"===e){var v=((p=Math.ceil(t/a))-1)*a+u-t,g=((d=Math.ceil(n/o))-1)*o+s-n,y=((h=Math.ceil(r/i))-1)*i+c-r,x=Math.floor(v/2),b=v-x,w=Math.floor(g/2),k=g-w,C=Math.floor(y/2);f={top:w,bottom:k,left:C,right:y-C,front:x,back:b,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: ".concat(e));f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},p=Math.ceil((t-u+1)/a),d=Math.ceil((n-s+1)/o),h=Math.ceil((r-c+1)/i)}return{padInfo:f,outDepth:p,outHeight:d,outWidth:h}}function ji(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function Hi(e){var t=E(zi(e),3),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function Ki(e,t){return Hi(e)||Hi(t)}function qi(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}var Xi=vr({elu_:function(e){var t=hr(e,"x","elu"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.elu(t);return n([r]),r}),n,null,"Elu")}});var Yi=vr({prelu_:function(e,t){var n=hr(e,"x","prelu"),r=hr(t,"alpha","prelu"),a={x:n,alpha:r};return ir.runKernelFunc((function(e,t){var a=e.prelu(n,r);return t([n,r]),a}),a,null,Xe)}});var Qi=vr({relu6_:function(e){var t=hr(e,"x","relu6"),n={x:t};return ir.runKernelFunc((function(e,n){return n([t]),"bool"===t.dtype?ra(t,"int32"):e.relu6(t)}),n,null,nt)}});var $i=vr({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=hr(e,"x","step"),r={x:n},a={alpha:t};return ir.runKernelFunc((function(e){return e.step(n,t)}),r,null,It,a)}});function Ji(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return qa(e,$i(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function Zi(e,t){var n=t,r=Ho(e.shape,t.shape);return r.length>0&&(n=ri(n,r)),ja(n,e.shape)}function eu(e,t,n){if("linear"===t)return e;if("relu"===t)return Ei(e);if("elu"===t)return Xi(e);if("relu6"===t)return Qi(e);if("prelu"===t)return Yi(e,n);throw new Error("Unknown fused activation ".concat(t,"."))}var tu=function(e,t){return!(e>0)||"linear"===t};function nu(e){return e<=30?e:pn(e,Math.floor(Math.sqrt(e)))}function ru(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var o=t.length,i=0;i<o;++i)a=a.concat([e[i+1]/t[i],t[i]]);a=a.concat(e.slice(o+1))}return a}function au(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var o=[],i=[],u=1;u<e;++u)u>=2*t+1||u%2===1?i.push(u):o.push(u);r.push.apply(r,o),r.push(0),r.push.apply(r,i)}return r}function ou(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var o=1;o<e.length;++o)o<=t.length?r?a.push(t[o-1]*e[o]):a.push(e[o]/t[o-1]):a.push(e[o]);return a}function iu(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}!function(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,o="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(o+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(o+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(o+" update.rank != ".concat(a+e.length-r));for(var i=0;i<a;++i)if(n.shape[i]!==t.shape[i])throw new Error(o+" updates.shape[".concat(i,"] (").concat(n.shape[i],") != indices.shape[").concat(i,"] (").concat(t.shape[i],")."));for(var u=0;u<n.rank-a;++u)if(n.shape[u+a]!==e[u+r])throw new Error(o+" updates.shape[".concat(u+a,"] (").concat(n.shape[u+a],") != shape[").concat(u+a,"] (").concat(e[u+a],")"))}(n,t,e)}function uu(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,o=n.length,i=1,u=a;u<o;++u)i*=n[u];var s=a<1?1:a;return{sliceRank:a,numUpdates:Qt(t.shape)/s,sliceSize:i,strides:[].concat(R(dn(n.slice(0,a))),[1]),outputSize:Qt(n)}}var su=1.7580993408473768,cu=1.0507009873554805;function lu(){var e;P().getBool("IS_TEST")||(e=console).warn.apply(e,arguments)}function fu(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function pu(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=pn(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=pn(e,n+1);return n}function du(e,t,n){for(var r=[],a=e.length,o=0;o<a;o++)o!==t?r.push(e[o]):r.push(n);return r}function hu(e,t,n){for(var r=e.shape[n],a=[],o=1,i=1,u=0;u<n;u++)a.push(e.shape[u]),o*=e.shape[u];for(var s=0;s<t.rank;s++)a.push(t.shape[s]);for(var c=n+1;c<e.rank;c++)a.push(e.shape[c]),i*=e.shape[c];return{batchSize:o,sliceSize:i,dimSize:r,outputShape:a}}function mu(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=Ya(e.shape),a=ra(e,"float32"),o=n.complex(a,r);return r.dispose(),a.dispose(),o}if(i=e.dtype,"complex64"===(u=t)||"float32"===u&&"complex64"!==i||"int32"===u&&"float32"!==i&&"complex64"!==i||"bool"===u&&"bool"===i)return ir.makeTensorFromDataId(e.dataId,e.shape,t);var i,u;if("complex64"===e.dtype){var s=n.real(e),c=ra(s,t);return s.dispose(),c}if("int32"===t)return n.int(e);if("bool"===t){var l=Ja(0,e.dtype),f=n.notEqual(e,l);return l.dispose(),f}throw new Error("Error in Cast: failed to cast ".concat(e.dtype," to ").concat(t))}function vu(e,t){return ir.makeTensorFromDataId(e.dataId,t,e.dtype)}function gu(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);for(var a=na(e,"int32"),o=na([n.length,e.length],"int32"),i=0;i<n.length;i++){var u=a.indexToLoc(n[i]),s=i*e.length;o.values.set(u,s)}return o.toTensor()}var yu=function(){function e(t,n){I(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return A(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),xu=function(){function e(){I(this,e)}return A(e,[{key:"time",value:function(e){return bu("time")}},{key:"read",value:function(e){return bu("read")}},{key:"readSync",value:function(e){return bu("readSync")}},{key:"numDataIds",value:function(){return bu("numDataIds")}},{key:"disposeData",value:function(e){return bu("disposeData")}},{key:"write",value:function(e,t,n){return bu("write")}},{key:"move",value:function(e,t,n,r){return bu("move")}},{key:"memory",value:function(){return bu("memory")}},{key:"floatPrecision",value:function(){return bu("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"batchMatMul",value:function(e,t,n,r){return bu("batchMatMul")}},{key:"fusedBatchMatMul",value:function(e){e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights;return bu("fusedBatchMatMul")}},{key:"slice",value:function(e,t,n){return bu("slice")}},{key:"stridedSlice",value:function(e,t,n,r){return bu("stridedSlice")}},{key:"unstack",value:function(e,t){return bu("unstack")}},{key:"reverse",value:function(e,t){return bu("reverse")}},{key:"concat",value:function(e,t){return bu("concat")}},{key:"neg",value:function(e){return bu("neg")}},{key:"add",value:function(e,t){return bu("add")}},{key:"addN",value:function(e){return bu("addN")}},{key:"subtract",value:function(e,t){return bu("subtract")}},{key:"multiply",value:function(e,t){return bu("multiply")}},{key:"realDivide",value:function(e,t){return bu("realDivide")}},{key:"floorDiv",value:function(e,t){return bu("floorDiv")}},{key:"sum",value:function(e,t){return bu("sum")}},{key:"prod",value:function(e,t){return bu("prod")}},{key:"unsortedSegmentSum",value:function(e,t,n){return bu("unsortedSegmentSum")}},{key:"argMin",value:function(e,t){return bu("argMin")}},{key:"argMax",value:function(e,t){return bu("argMax")}},{key:"equal",value:function(e,t){return bu("equal")}},{key:"notEqual",value:function(e,t){return bu("notEqual")}},{key:"less",value:function(e,t){return bu("less")}},{key:"lessEqual",value:function(e,t){return bu("lessEqual")}},{key:"greater",value:function(e,t){return bu("greater")}},{key:"greaterEqual",value:function(e,t){return bu("greaterEqual")}},{key:"logicalNot",value:function(e){return bu("logicalNot")}},{key:"logicalAnd",value:function(e,t){return bu("logicalAnd")}},{key:"logicalOr",value:function(e,t){return bu("logicalOr")}},{key:"where",value:function(e){return bu("where")}},{key:"select",value:function(e,t,n){return bu("select")}},{key:"topk",value:function(e,t,n){return bu("topk")}},{key:"min",value:function(e,t){return bu("min")}},{key:"minimum",value:function(e,t){return bu("minimum")}},{key:"mod",value:function(e,t){return bu("mod")}},{key:"max",value:function(e,t){return bu("max")}},{key:"maximum",value:function(e,t){return bu("maximum")}},{key:"all",value:function(e,t){return bu("all")}},{key:"any",value:function(e,t){return bu("any")}},{key:"squaredDifference",value:function(e,t){return bu("squaredDifference")}},{key:"ceil",value:function(e){return bu("ceil")}},{key:"floor",value:function(e){return bu("floor")}},{key:"round",value:function(e){return bu("round")}},{key:"sign",value:function(e){return bu("sign")}},{key:"isNaN",value:function(e){return bu("isNaN")}},{key:"isInf",value:function(e){return bu("isInf")}},{key:"isFinite",value:function(e){return bu("isFinite")}},{key:"pow",value:function(e,t){return bu("pow")}},{key:"exp",value:function(e){return bu("exp")}},{key:"expm1",value:function(e){return bu("expm1")}},{key:"softmax",value:function(e,t){return bu("softmax")}},{key:"log",value:function(e){return bu("log")}},{key:"log1p",value:function(e){return bu("log1p")}},{key:"sqrt",value:function(e){return bu("sqrt")}},{key:"rsqrt",value:function(e){return bu("rsqrt")}},{key:"square",value:function(e){return bu("square")}},{key:"reciprocal",value:function(e){return bu("reciprocal")}},{key:"relu",value:function(e){return bu("relu")}},{key:"relu6",value:function(e){return bu("relu6")}},{key:"prelu",value:function(e,t){return bu("prelu")}},{key:"elu",value:function(e){return bu("elu")}},{key:"eluDer",value:function(e,t){return bu("eluDer")}},{key:"selu",value:function(e){return bu("selu")}},{key:"int",value:function(e){return bu("int")}},{key:"clip",value:function(e,t,n){return bu("clip")}},{key:"abs",value:function(e){return bu("abs")}},{key:"complexAbs",value:function(e){return bu("complexAbs")}},{key:"sigmoid",value:function(e){return bu("sigmoid")}},{key:"softplus",value:function(e){return bu("softplus")}},{key:"sin",value:function(e){return bu("sin")}},{key:"cos",value:function(e){return bu("cos")}},{key:"tan",value:function(e){return bu("tan")}},{key:"asin",value:function(e){return bu("asin")}},{key:"acos",value:function(e){return bu("acos")}},{key:"atan",value:function(e){return bu("atan")}},{key:"atan2",value:function(e,t){return bu("atan2")}},{key:"sinh",value:function(e){return bu("sinh")}},{key:"cosh",value:function(e){return bu("cosh")}},{key:"tanh",value:function(e){return bu("tanh")}},{key:"asinh",value:function(e){return bu("asinh")}},{key:"acosh",value:function(e){return bu("acosh")}},{key:"atanh",value:function(e){return bu("atanh")}},{key:"erf",value:function(e){return bu("erf")}},{key:"step",value:function(e,t){return bu("step")}},{key:"fusedConv2d",value:function(e){e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights;return bu("fusedConv2d")}},{key:"conv2d",value:function(e,t,n){return bu("conv2d")}},{key:"conv2dDerInput",value:function(e,t,n){return bu("conv2dDerInput")}},{key:"conv2dDerFilter",value:function(e,t,n){return bu("conv2dDerFilter")}},{key:"fusedDepthwiseConv2D",value:function(e){e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights;return bu("fusedDepthwiseConv2D")}},{key:"depthwiseConv2D",value:function(e,t,n){return bu("depthwiseConv2D")}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){return bu("depthwiseConv2DDerInput")}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){return bu("depthwiseConv2DDerFilter")}},{key:"conv3d",value:function(e,t,n){return bu("conv3d")}},{key:"conv3dDerInput",value:function(e,t,n){return bu("conv3dDerInput")}},{key:"conv3dDerFilter",value:function(e,t,n){return bu("conv3dDerFilter")}},{key:"maxPool",value:function(e,t){return bu("maxPool")}},{key:"maxPoolBackprop",value:function(e,t,n,r){return bu("maxPoolBackprop")}},{key:"avgPool",value:function(e,t){return bu("avgPool")}},{key:"avgPoolBackprop",value:function(e,t,n){return bu("avgPoolBackprop")}},{key:"avgPool3d",value:function(e,t){return bu("avgPool3d")}},{key:"avgPool3dBackprop",value:function(e,t,n){return bu("avgPool3dBackprop")}},{key:"maxPool3d",value:function(e,t){return bu("maxPool3d")}},{key:"maxPool3dBackprop",value:function(e,t,n,r){return bu("maxPool3dBackprop")}},{key:"reshape",value:function(e,t){return bu("reshape")}},{key:"cast",value:function(e,t){return bu("cast")}},{key:"tile",value:function(e,t){return bu("tile")}},{key:"pad",value:function(e,t,n){return bu("pad")}},{key:"transpose",value:function(e,t){return bu("transpose")}},{key:"gather",value:function(e,t,n){return bu("gather")}},{key:"gatherND",value:function(e,t){return bu("gatherND")}},{key:"scatterND",value:function(e,t,n){return bu("scatterND")}},{key:"batchToSpaceND",value:function(e,t,n){return bu("batchToSpaceND")}},{key:"spaceToBatchND",value:function(e,t,n){return bu("spaceToBatchND")}},{key:"resizeBilinear",value:function(e,t,n,r){return bu("resizeBilinear")}},{key:"resizeBilinearBackprop",value:function(e,t,n){return bu("resizeBilinearBackprop")}},{key:"resizeNearestNeighbor",value:function(e,t,n,r){return bu("resizeNearestNeighbor")}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){return bu("resizeNearestNeighborBackprop")}},{key:"batchNorm",value:function(e,t,n,r,a,o){return bu("batchNorm")}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){return bu("localResponseNormalization4D")}},{key:"LRNGrad",value:function(e,t,n,r,a,o,i){return bu("LRNGrad")}},{key:"multinomial",value:function(e,t,n,r){return bu("multinomial")}},{key:"oneHot",value:function(e,t,n,r){return bu("oneHot")}},{key:"cumsum",value:function(e,t,n,r){return bu("cumsum")}},{key:"nonMaxSuppression",value:function(e,t,n,r,a){return bu("nonMaxSuppression")}},{key:"fft",value:function(e){return bu("fft")}},{key:"ifft",value:function(e){return bu("ifft")}},{key:"complex",value:function(e,t){return bu("complex")}},{key:"real",value:function(e){return bu("real")}},{key:"imag",value:function(e){return bu("imag")}},{key:"cropAndResize",value:function(e,t,n,r,a,o){return bu("cropAndResize")}},{key:"depthToSpace",value:function(e,t,n){return bu("depthToSpace")}},{key:"split",value:function(e,t,n){return bu("split")}},{key:"sparseToDense",value:function(e,t,n,r){return bu("sparseToDense")}},{key:"diag",value:function(e){return bu("diag")}},{key:"fill",value:function(e,t,n){return bu("fill")}},{key:"onesLike",value:function(e){return bu("onesLike")}},{key:"zerosLike",value:function(e){return bu("zerosLike")}},{key:"linspace",value:function(e,t,n){return bu("linspace")}},{key:"dispose",value:function(){return bu("dispose")}}]),e}();function bu(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"Did you forget to import the kernel?")}var wu={kernelName:"Abs",inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(e,$i(ra(n,"float32"),-1))}}}},ku={kernelName:V,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){var t=ni(ra(n,"float32")),r=ti(ao(Ja(1),t));return vi(Pa(e,r))}}}},Cu={kernelName:U,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){var t=ti(ao(ni(ra(n,"float32")),1));return Pa(e,t)}}}},Eu={kernelName:W,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=Ko(r.shape,a.shape);return{a:function(){var t=e,n=Ho(r.shape,o);return n.length>0&&(t=ri(t,n)),ja(t,r.shape)},b:function(){var t=e,n=Ho(a.shape,o);return n.length>0&&(t=ri(t,n)),ja(t,a.shape)}}}},Su={kernelName:G,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},Nu={kernelName:j,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return co(n)}}}},Tu={kernelName:H,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return co(n)}}}},Ru={kernelName:K,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Pa(e,ti(ao(Ja(1),ni(ra(n,"float32")))))}}}},Iu={kernelName:q,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){var t=ti(Ia(Ja(1),ni(ra(n,"float32"))));return Pa(e,t)}}}},_u={kernelName:Q,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=Ko(r.shape,a.shape);return{a:function(){var t=Ia(ni(r),ni(a)),n=qa(e,Pa(a,t)),i=Ho(r.shape,o);return i.length>0&&(n=ri(n,i)),ja(n,r.shape)},b:function(){var t=Ia(ni(r),ni(a)),n=vi(qa(e,Pa(r,t))),i=Ho(a.shape,o);return i.length>0&&(n=ri(n,i)),ja(n,a.shape)}}}},Au={kernelName:X,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Pa(e,Ia(ni(ra(n,"float32")),1))}}}},Ou={kernelName:Y,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Pa(e,ao(Ja(1),ni(ra(n,"float32"))))}}}};var Du=vr({avgPool3dBackprop_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1],o=arguments.length>5?arguments[5]:void 0,i=arguments.length>6?arguments[6]:void 0,u=hr(e,"dy","avgPool3dBackprop"),s=hr(t,"input","avgPool3dBackprop"),c=u,l=s,f=!1;4===s.rank&&(f=!0,c=ja(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]]),l=ja(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]])),Kt(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+"".concat(c.rank,".")})),Kt(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+"".concat(l.rank,".")})),Kt(Ki(r,a),(function(){return"Error in avgPool3dBackprop: Either strides or dilations "+"must be 1. Got strides ".concat(r," and dilations '").concat(a,"'")})),null!=i&&Kt(Jt(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when "+"using, dimRoundingMode ".concat(i," but got pad ").concat(o,".")}));var p=function(e){var t=Pi(l.shape,n,r,a,o,i);return e.avgPool3dBackprop(c,l,t)},d={dy:c,input:l},h={filterSize:n,strides:r,dilations:a,pad:o,dimRoundingMode:i},m=ir.runKernelFunc(p,d,null,Z,h);return f?ja(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}}),Fu={kernelName:J,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.filterSize,o=n.strides,i=n.dilations,u=n.pad,s=n.dimRoundingMode,c=null==i?[1,1,1]:i;return{x:function(){return Du(e,r,a,o,c,u,s)}}}};var Pu=vr({avgPoolBackprop_:function(e,t,n,r,a){var o=hr(e,"dy","avgPoolBackprop"),i=hr(t,"input","avgPoolBackprop");Kt(i.rank===o.rank,(function(){return"Rank of input (".concat(i.rank,") does not match rank of dy (").concat(o.rank,")")}));var u=i,s=o,c=!1;3===i.rank&&(c=!0,u=ja(i,[1,i.shape[0],i.shape[1],i.shape[2]]),s=ja(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Kt(4===s.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+"".concat(s.rank,".")})),Kt(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+"".concat(u.rank,".")}));var l={dy:s,input:u},f={filterSize:n,strides:r,pad:a},p=ir.runKernelFunc((function(e){var t=Fi(u.shape,n,r,1,a);return e.avgPoolBackprop(s,u,t)}),l,null,"AvgPoolBackprop",f);return c?ja(p,[p.shape[1],p.shape[2],p.shape[3]]):p}}),Lu={kernelName:$,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.filterSize,o=n.strides,i=n.pad;return{x:function(){return Pu(e,r,a,o,i)}}}},Mu={kernelName:ee,inputsToSave:["a","b"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],o=r[1],i=n.transposeA,u=n.transposeB;return i||u?!i&&u?{a:function(){return mi(e,o,!1,!1)},b:function(){return mi(e,a,!0,!1)}}:i&&!u?{a:function(){return mi(o,e,!1,!0)},b:function(){return mi(a,e,!1,!1)}}:{a:function(){return mi(o,e,!0,!0)},b:function(){return mi(e,a,!0,!0)}}:{a:function(){return mi(e,o,!1,!0)},b:function(){return mi(a,e,!0,!1)}}}};var Bu=vr({spaceToBatchND_:function(e,t,n){var r=hr(e,"x","spaceToBatchND");Kt(r.rank>=1+t.length,(function(){return"input rank ".concat(r.rank," should be > than [blockShape] ").concat(t.length)})),Kt(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),Kt(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(r.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var a={x:r},o={blockShape:t,paddings:n};return ir.runKernelFunc((function(e){return e.spaceToBatchND(r,t,n)}),a,null,mt,o)}}),zu={kernelName:te,gradFunc:function(e,t,n){var r=n.blockShape,a=n.crops;return{x:function(){return Bu(e,r,a)}}}},Vu={kernelName:ne,gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,o=r.shape,i=Array.from(o),u=a.length-1;u>=0;u--)if(a[u]===o[u])i[u]=1;else if(1!==a[u])throw new Error("broadcastTo(): [".concat(a,"] cannot be broadcast to [").concat(o,"]."));for(var s=[],c=0;c<i.length;c++)i[c]>1&&s.push(c);return{x:function(){return ri(e,s,!0)}}}},Uu={kernelName:re,gradFunc:function(e){return{x:function(){return e.clone()}}}},Wu={kernelName:ae,gradFunc:function(e){return{x:function(){return co(e)}}}},Gu={kernelName:oe,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.clipValueMin,o=n.clipValueMax;return{x:function(){return $o(Yo(qo(r,a),Xo(r,o)),e,co(e))}}}},ju={kernelName:ie,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),a=nn(n.axis,t[0].shape)[0],o=r.map((function(e){return e[a]}));return so(e,o,a).map((function(e){return function(){return e}}))}};var Hu=vr({conv2DBackpropFilter_:function(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0,u=e;3===e.rank&&(u=ja(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var s=t;3===s.rank&&(s=ja(t,[1,t.shape[0],t.shape[1],t.shape[2]])),Kt(4===u.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(u.shape,".")})),Kt(4===s.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(s.shape,".")})),Kt(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var c="NHWC"===o?u.shape[3]:u.shape[1],l="NHWC"===o?s.shape[3]:s.shape[1];Kt(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(c,") must ")+"match input depth in filter (".concat(n[2],".")})),Kt(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=i&&Kt(Jt(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(a,".")}));var f=function(e){var t=qi(o),c=Li(u.shape,n,r,1,a,i,!1,t);return e.conv2dDerFilter(u,s,c)},p={x:u,dy:s},d={strides:r,pad:a,dataFormat:o,dimRoundingMode:i};return ir.runKernelFunc(f,p,null,se,d)}});var Ku=vr({conv2DBackpropInput_:function(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=arguments.length>6?arguments[6]:void 0;Kt(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var u=e,s=t,c=!1;3===t.rank&&(c=!0,s=ja(t,[1,t.shape[0],t.shape[1],t.shape[2]]),u=[1,e[0],e[1],e[2]]),Kt(4===u.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(u.length,".")})),Kt(4===s.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(s.rank)})),Kt(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var l="NHWC"===o?u[3]:u[1],f="NHWC"===o?s.shape[3]:s.shape[1];Kt(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(l,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),Kt(f===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(f,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=i&&Kt(Jt(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(a,".")}));var p=function(e,t){var c=qi(o),l=Li(u,n.shape,r,1,a,i,!1,c),f=e.conv2dDerInput(s,n,l);return t([s,n]),f},d={dy:s,filter:n},h={strides:r,pad:a,dataFormat:o,dimRoundingMode:i,inputShape:u},m=ir.runKernelFunc(p,d,null,ce,h);return c?ja(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),qu={kernelName:ue,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],o=r[1],i=n.dilations,u=n.strides,s=n.pad,c=n.dataFormat;return Kt(Hi(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(i,"'")})),{x:function(){return Ku(a.shape,e,o,u,s,c)},filter:function(){return Hu(a,e,o.shape,u,s,c)}}}};var Xu=vr({conv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,u=hr(e,"x","conv2d"),s=hr(t,"filter","conv2d"),c=u,l=!1;3===u.rank&&(l=!0,c=ja(u,[1,u.shape[0],u.shape[1],u.shape[2]])),Kt(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(c.rank,".")})),Kt(4===s.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(s.rank,".")})),null!=i&&Kt(Jt(r),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(r,".")}));var f="NHWC"===a?c.shape[3]:c.shape[1];Kt(f===s.shape[2],(function(){return"Error in conv2d: depth of input (".concat(f,") must match ")+"input depth for filter ".concat(s.shape[2],".")})),Kt(Ki(n,o),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")}));var p=function(e,t){var u=qi(a),l=Li(c.shape,s.shape,n,o,r,i,!1,u),f=e.conv2d(c,s,l);return t([c,s]),f},d={x:c,filter:s},h={strides:n,pad:r,dataFormat:a,dilations:o,dimRoundingMode:i},m=ir.runKernelFunc(p,d,null,ue,h);return l?ja(m,[m.shape[1],m.shape[2],m.shape[3]]):m}}),Yu={kernelName:ce,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],o=r[1],i=n.strides,u=n.pad,s=n.dataFormat,c=n.dimRoundingMode;return{dy:function(){return Xu(e,o,i,u,s,1,c)},filter:function(){return Hu(e,a,o.shape,i,u,s,c)}}}};var Qu=vr({conv3DBackpropFilter_:function(e,t,n,r,a){var o=e;4===e.rank&&(o=ja(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var i=t;4===i.rank&&(i=ja(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),Kt(5===o.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(o.shape,".")})),Kt(5===i.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(i.shape,".")})),Kt(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),Kt(o.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(o.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),Kt(i.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(i.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var u={x:o,y:i},s={strides:r,pad:a};return ir.runKernelFunc((function(e){var t=Mi(o.shape,n,r,1,a);return e.conv3dDerFilter(o,i,t)}),u,null,"Conv3DBackpropFilterV2",s)}});var $u=vr({conv3DBackpropInput_:function(e,t,n,r,a){Kt(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var o=e,i=t,u=!1;4===t.rank&&(u=!0,i=ja(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),o=[1,e[0],e[1],e[2],e[3]]);var s=o[4],c=i.shape[4];Kt(5===o.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(o.length,".")})),Kt(5===i.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(i.rank)})),Kt(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),Kt(s===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(s,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),Kt(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(c,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var l={dy:i},f={pad:a},p=ir.runKernelFunc((function(e){var t=Mi(o,n.shape,r,1,a);return e.conv3dDerInput(i,n,t)}),l,null,"Conv3DBackpropInputV2",f);return u?ja(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}}),Ju={kernelName:le,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,o=n.pad;Kt(Hi(r),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(r,"'")}));var i=E(t,2),u=i[0],s=i[1];return{x:function(){return $u(u.shape,e,s,a,o)},filter:function(){return Qu(u,e,s.shape,a,o)}}}};var Zu=vr({sin_:function(e){var t=hr(e,"x","sin"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.sin(t);return n([t]),r}),n,null,"Sin")}}),es={kernelName:"Cos",inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(vi(Zu(ra(n,"float32"))),e)}}}};var ts=vr({sinh_:function(e){var t=hr(e,"x","sinh"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.sinh(t);return n([t]),r}),n,null,ct)}}),ns={kernelName:fe,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(ts(ra(n,"float32")),e)}}}};var rs=vr({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=hr(e,"x","cumsum"),o=function(e,o){var i=Ua([t],a.rank),u=a;null!=i&&(u=Ha(a,i));var s=Ga(1,a.rank)[0],c=e.cumsum(u,s,n,r);if(o([a]),null!=i){var l=Wa(i);c=Ha(c,l)}return c},i={x:a},u={axis:t,exclusive:n,reverse:r};return ir.runKernelFunc(o,i,null,pe,u)}}),as={kernelName:pe,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.axis,o=n.exclusive,i=n.reverse;return{x:function(){var t=Ua([a],r.rank),n=rs(e,a,o,!i);return null!=t&&(n=Ha(n,t)),n}}}};var os=vr({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r){var a=e;3===e.rank&&(a=ja(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var o=t;3===o.rank&&(o=ja(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var i={x:a,dy:o};return ir.runKernelFunc((function(e){return e.depthwiseConv2DDerFilter(a,o,r)}),i,null,"DepthwiseConv2dNativeBackpropFilter")}});var is=vr({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r){var a=t,o=!1;3===t.rank&&(o=!0,a=ja(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var i={dy:a},u=ir.runKernelFunc((function(e){return e.depthwiseConv2DDerInput(a,n,r)}),i,null,"DepthwiseConv2dNativeBackpropInput");return o?ja(u,[u.shape[1],u.shape[2],u.shape[3]]):u}}),us={kernelName:he,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=n.dilations,a=n.strides,o=n.pad,i=n.dimRoundingMode,u=null==r?[1,1]:r;Kt(Hi(u),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(u,"'")}));var s=E(t,2),c=s[0],l=s[1];Kt(4===c.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(c.rank,".")})),Kt(4===l.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(l.rank,".")})),Kt(c.shape[3]===l.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(c.shape[3],") must match the inChannels dimension ")+"in filter ".concat(l.shape[2],".")})),Kt(Ki(a,u),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(a," and dilations ")+"'".concat(u,"'.")})),null!=i&&Kt(Jt(o),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(o,".")}));var f=Li(c.shape,l.shape,a,u,o,i,!0);return{x:function(){return is(c.shape,e,l,f)},filter:function(){return os(c,e,l.shape,f)}}}},ss={kernelName:me,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],o=r[1],i={x:a,filter:o,dy:e},u={x:a,filter:o,dy:e};return{x:function(){return ir.runKernel("Dilation2DBackpropInput",i,n)},filter:function(){return ir.runKernel("Dilation2DBackpropFilter",u,n)}}}},cs={kernelName:ve,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=Ko(r.shape,a.shape);return{a:function(){var t=Pa(e,ra(a,"float32")),n=Ho(r.shape,o);return n.length>0?ja(ri(t,n),r.shape):t},b:function(){var t=qa(e,ra(r,"float32")),n=Ho(a.shape,o);n.length>0&&(t=ja(ri(t,n),a.shape));var i=ni(a);return vi(Pa(t,ra(i,"float32")))}}}},ls={kernelName:"Elu",outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,1)[0],r=function(t){return t.eluDer(e,n)},a={dy:e,y:n};return{x:function(){return ir.runKernelFunc(r,a,null,"EluGrad")}}}},fs={kernelName:"Erf",inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0],r=qa(Ri(vi(ni(n))),2/Math.sqrt(Math.PI));return{x:function(){return qa(e,r)}}}},ps={kernelName:"Exp",outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(e,n)}}}},ds={kernelName:ge,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(e,Ri(n))}}}},hs={kernelName:xe,gradFunc:function(e){return{x:function(){return co(e)}}}},ms={kernelName:be,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=Ko(r.shape,a.shape);return{a:function(){var t=Pa(e,ra(a,"float32")),n=Ho(r.shape,o);return n.length>0?ja(ri(t,n),r.shape):t},b:function(){var t=qa(e,ra(r,"float32")),n=Ho(a.shape,o);n.length>0&&(t=ja(ri(t,n),a.shape));var i=ni(a);return vi(Pa(t,ra(i,"float32")))}}}};var vs=vr({rsqrt_:function(e){var t=hr(e,"x","rsqrt"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.rsqrt(t);return n([t]),r}),n,null,ot)}}),gs={kernelName:we,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=E(t,4),o=a[0],i=a[1],u=a[2],s=a[3],c=null==s?Ja(1):s,l=Ho(i.shape,o.shape),f=[];if(1===i.rank){for(var p=0;p<o.shape.length-1;++p)f.push(o.shape[p]);f.push(1)}var d=ao(o,i),h=qa(e,c),m=vs(Ia(u,Ja(r))),v=qa(qa(qa(m,m),m),Ja(-.5));return{x:function(){return 1===i.rank?ja(qa(qa(e,pi(ja(m,[1,1,1,i.shape[0]]),f)),c),o.shape):ja(qa(qa(e,m),c),o.shape)},mean:function(){var e=qa(qa(m,Ja(-1)),h);return 1===i.rank&&(e=ri(e,l)),ja(e,i.shape)},variance:function(){var e=qa(qa(v,d),h);return 1===i.rank&&(e=ri(e,l)),ja(e,i.shape)},scale:function(){var t=qa(d,m),n=qa(e,t);return 1===i.rank&&(n=ri(n,l)),ja(n,i.shape)},offset:function(){var t=e;return 1===i.rank&&(t=ri(t,l)),ja(t,i.shape)}}}};var ys=vr({unsortedSegmentSum_:function(e,t,n){var r=hr(e,"x","unsortedSegmentSum"),a=hr(t,"segmentIds","unsortedSegmentSum","int32");Kt(Jt(n),(function(){return"numSegments must be of dtype int"}));var o={x:r,segmentIds:a},i={numSegments:n};return ir.runKernelFunc((function(e,t){var o=e.unsortedSegmentSum(r,a,n);return t([a]),o}),o,null,Tt,i)}}),xs={kernelName:ke,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],o=r[1],i=n.axis,u=nn(i,a.shape)[0];return{x:function(){var t=a.shape,n=o.size,r=t.slice(0,u),s=r.length,c=t.slice(i,t.length).slice(1),l=c.length,f=bs(0,s),p=bs(s+1,s+1+l),d=ws([r,[n],c]),h=ja(e,d),m=ja(o,[n]),v=ws([[s],f,p]),g=Ha(h,v),y=ys(g,m,a.shape[u]),x=Wa(v);return y=Ha(y,x)},indices:function(){return o}}}};function bs(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function ws(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var ks={kernelName:Ce,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1];return{a:function(){return co(r)},b:function(){return co(a)}}}},Cs={kernelName:Ee,gradFunc:function(e){return{x:function(){return ra(e,"float32")}}}},Es={kernelName:Se,gradFunc:function(e){return{x:function(){return co(e)}}}},Ss={kernelName:Ne,gradFunc:function(e){return{x:function(){return co(e)}}}},Ns={kernelName:Te,gradFunc:function(e){return{x:function(){return co(e)}}}},Ts={kernelName:Re,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Pa(e,Ia(n,1))}}}},Rs={kernelName:"Log",inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Pa(e,ra(n,"float32"))}}}},Is={kernelName:Ie,inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.axis;return{logits:function(){var t=Ri(r);return ao(e,qa(ri(e,a,!0),t))}}}};var _s=vr({localResponseNormalizationBackprop_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,u=function(u){return u.LRNGrad(n,e,t,r,a,o,i)},s={x:e,y:t,dy:n},c={depthRadius:r,bias:a,alpha:o,beta:i};return ir.runKernelFunc(u,s,null,Ae,c)}}),As={kernelName:_e,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],o=r[1],i=n.depthRadius,u=n.bias,s=n.alpha,c=n.beta;return{x:function(){return _s(a,o,e,i,u,s,c)}}}};var Os=vr({equal_:function(e,t){var n=hr(e,"a","equal"),r=hr(t,"b","equal"),a=E(Zn(n,r),2);n=a[0],r=a[1],Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e){return e.equal(n,r)}),o,null,"Equal")}});function Ds(e,t,n,r,a){return t.rank<n.rank&&(t=ja(t,za(t.shape,r))),e.rank<n.rank&&(e=ja(e,za(e.shape,r))),{x:function(){var r=qa(e,ra(Os(n,t),e.dtype));return null==a?r:Ha(r,a)}}}var Fs={kernelName:Oe,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.reductionIndices,a=E(t,2),o=a[0],i=a[1],u=nn(r,o.shape),s=Ua(u,o.rank),c=Ds(e,i,o,u,s);return{x:function(){var e=c.x();return null!=s&&(e=Ha(e)),e}}}};var Ps=vr({less_:function(e,t){var n=hr(e,"a","less"),r=hr(t,"b","less"),a=E(Zn(n,r),2);n=a[0],r=a[1],Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e){return e.less(n,r)}),o,null,"Less")}}),Ls={kernelName:De,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1];return{a:function(){return qa(e,ra(qo(r,a),"float32"))},b:function(){return qa(e,ra(Ps(r,a),"float32"))}}}};var Ms=vr({maxPool3dBackprop_:function(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],i=arguments.length>6?arguments[6]:void 0,u=arguments.length>7?arguments[7]:void 0,s=hr(e,"dy","maxPool3dBackprop"),c=hr(t,"input","maxPool3dBackprop"),l=hr(n,"output","maxPool3dBackprop"),f=s,p=c,d=l,h=!1;4===c.rank&&(h=!0,f=ja(s,[1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]]),p=ja(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),d=ja(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),Kt(5===f.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+"".concat(f.rank,".")})),Kt(5===p.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+"".concat(p.rank,".")})),Kt(5===d.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+"".concat(d.rank,".")})),Kt(Ki(a,o),(function(){return"Error in maxPool3dBackprop: Either strides or dilations "+"must be 1. Got strides ".concat(a," and dilations '").concat(o,"'")})),null!=u&&Kt(Jt(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when "+"using, dimRoundingMode ".concat(u," but got pad ").concat(i,".")}));var m=function(e){var t=Pi(p.shape,r,a,o,i,u);return e.maxPool3dBackprop(f,p,d,t)},v={dy:f,input:p,output:d},g={filterSize:r,strides:a,dilations:o,pad:i,dimRoundingMode:u},y=ir.runKernelFunc(m,v,null,Le,g);return h?ja(y,[y.shape[1],y.shape[2],y.shape[3],y.shape[4]]):y}}),Bs={kernelName:Pe,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],o=r[1],i=n.filterSize,u=n.strides,s=n.dilations,c=n.pad,l=n.dimRoundingMode,f=null==s?[1,1,1]:s;return{x:function(){return Ms(e,a,o,i,u,f,c,l)}}}};var zs=vr({maxPoolBackprop_:function(e,t,n,r,a,o,i){var u=hr(e,"dy","maxPoolBackprop"),s=hr(t,"input","maxPoolBackprop"),c=hr(n,"output","maxPoolBackprop");Kt(s.rank===u.rank,(function(){return"Rank of input (".concat(s.rank,") does not match rank of dy ")+"(".concat(u.rank,")")})),Kt(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+"".concat(u.rank,".")})),Kt(4===s.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+"".concat(s.rank,".")})),null!=i&&Kt(Jt(o),(function(){return"Error in maxPoolBackprop: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(o,".")}));var l={dy:u,input:s,output:c},f={filterSize:r,strides:a,pad:o,dimRoundingMode:i};return ir.runKernelFunc((function(e){var t=Fi(s.shape,r,a,1,o,i);return e.maxPoolBackprop(u,s,c,t)}),l,null,"MaxPoolBackprop",f)}}),Vs={kernelName:Fe,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,2),a=r[0],o=r[1],i=n.filterSize,u=n.strides,s=n.pad;return{x:function(){return zs(e,a,o,i,u,s)}}}},Us={kernelName:Be,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var r=n.axis,a=E(t,2),o=a[0],i=a[1],u=nn(r,o.shape),s=Ua(u,o.rank),c=Ds(e,i,o,u,s);return{x:function(){var e=c.x();return null!=s&&(e=Ha(e)),e}}}},Ws={kernelName:ze,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1];return{a:function(){return qa(e,ra(Xo(r,a),"float32"))},b:function(){return qa(e,ra(hi(r,a),"float32"))}}}};var Gs=vr({floor_:function(e){var t=hr(e,"x","floor"),n={x:t};return ir.runKernelFunc((function(e){return e.floor(t)}),n,null,xe)}}),js={kernelName:"Mod",inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=Ko(r.shape,a.shape);return{a:function(){var t=Ho(r.shape,o);return t.length>0?ja(ri(e,t),r.shape):e},b:function(){var t=qa(e,vi(Gs(Pa(r,a)))),n=Ho(a.shape,o);return n.length>0?ja(ri(t,n),a.shape):t}}}},Hs={kernelName:Ve,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=Ko(r.shape,a.shape);return{a:function(){var t=qa(e,ra(a,"float32")),n=Ho(r.shape,o);return n.length>0?ja(ri(t,n),r.shape):t},b:function(){var t=qa(e,ra(r,"float32")),n=Ho(a.shape,o);return n.length>0?ja(ri(t,n),a.shape):t}}}},Ks={kernelName:Ue,gradFunc:function(e){return{x:function(){return vi(e)}}}},qs={kernelName:Ke,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return Ya(n.shape,"float32")}}}},Xs={kernelName:He,gradFunc:function(e){return{x:function(){return co(e)}}}},Ys={kernelName:qe,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return eo(e,a,r.shape)}}}},Qs={kernelName:"Pow",inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,3),r=n[0],a=n[1],o=n[2],i=r,u=a,s=Ko(i.shape,u.shape);return{a:function(){var t=ra(u,"float32"),n=qa(e,qa(t,ei(i,ao(t,Ja(1))))),r=Ho(i.shape,s);return r.length>0&&(n=ri(n,r)),ja(n,i.shape)},b:function(){var t=hi(i,0),n=$o(t,Ni(i),co(i)),r=qa(e,qa(o,n)),a=Ho(u.shape,s);return a.length>0&&(r=ri(r,a)),ja(r,u.shape)}}}},$s={kernelName:Xe,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=hi(r,0);return{x:function(){return $o(o,e,qa(e,a))},alpha:function(){var t=$o(o,co(e),qa(e,r)),n=Ho(a.shape,e.shape);return n.length>0&&(t=ri(t,n)),ja(t,a.shape)}}}},Js={kernelName:$e,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Pa(e,vi(ni(n)))}}}},Zs={kernelName:nt,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0],r=qa(Xo(n,6),$i(n));return{x:function(){return qa(e,ra(r,"float32"))}}}},ec={kernelName:Je,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(e,ra($i(n),"float32"))}}}},tc={kernelName:Ze,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return ja(e,n.shape)}}}},nc={kernelName:tt,inputsToSave:["images"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=function(t){var a=n.alignCorners;return t.resizeBilinearBackprop(e,r,a)},o={images:r};return{images:function(){return ir.runKernelFunc(a,o,null,"ResizeBilinearGrad",n)}}}},rc={kernelName:et,inputsToSave:["images"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=function(t){var a=n.alignCorners;return t.resizeNearestNeighborBackprop(e,r,a)},o={images:r};return{images:function(){return ir.runKernelFunc(a,o,null,"ResizeNearestNeighborGrad",n)}}}},ac={kernelName:rt,gradFunc:function(e,t,n){var r=nn(n.dims,e.shape);return{x:function(){return ho(e,r)}}}},oc={kernelName:at,gradFunc:function(e){return{x:function(){return co(e)}}}},ic={kernelName:ot,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return vi(Pa(e,qa(ei(n,1.5),2)))}}}};var uc=vr({logicalNot_:function(e){var t=hr(e,"x","logicalNot","bool"),n={x:t};return ir.runKernelFunc((function(e){return e.logicalNot(t)}),n,null,"LogicalNot")}}),sc={kernelName:it,inputsToSave:["condition"],gradFunc:function(e,t){var n=E(t,1)[0];return{condition:function(){return ra(co(n),"float32")},t:function(){return qa(e,ra(n,e.dtype))},e:function(){return qa(e,ra(uc(n),e.dtype))}}}},cc={kernelName:ut,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){var t=hi(n,Ja(0)),r=Ja(su),a=Ja(cu),o=qa(e,a),i=qa(qa(e,r),Ri(ra(n,"float32")));return $o(t,o,i)}}}},lc={kernelName:ft,outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(e,qa(n,ao(Ja(1),n)))}}}},fc={kernelName:lt,gradFunc:function(e){return{x:function(){return co(e)}}}};var pc=vr({cos_:function(e){var t=hr(e,"x","cos"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.cos(t);return n([t]),r}),n,null,"Cos")}}),dc={kernelName:"Sin",inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(pc(ra(n,"float32")),e)}}}};var hc=vr({cosh_:function(e){var t=hr(e,"x","cosh"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.cosh(t);return n([t]),r}),n,null,fe)}}),mc={kernelName:ct,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(hc(ra(n,"float32")),e)}}}};var vc=vr({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=hr(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a=function(e,a){return a([r]),e.pad(r,t,n)},o={paddings:t,constantValue:n},i={x:r};return ir.runKernelFunc(a,i,null,qe,o)}}),gc={kernelName:st,inputsToSave:["x"],gradFunc:function(e,t,n){for(var r=E(t,1)[0],a=n.begin,o=n.size,i=r.shape,u=E(Ra(r,a,o),2),s=u[0],c=u[1],l=[],f=0;f<e.rank;f++)l.push([s[f],i[f]-s[f]-c[f]]);return{x:function(){return vc(e,l)}}}},yc={kernelName:gt,outputsToSave:[!0],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.dim,o=qa(e,r);return{logits:function(){return ao(o,qa(ri(o,[a],true),r))}}}},xc={kernelName:pt,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(e,Za(n))}}}};var bc=vr({batchToSpaceND_:function(e,t,n){var r=hr(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));Kt(r.rank>=1+t.length,(function(){return"input rank is ".concat(r.rank," but should be > than blockShape.length ").concat(t.length)})),Kt(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),Kt(r.shape[0]%a===0,(function(){return"input tensor batch is ".concat(r.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(a)}));var o={x:r},i={blockShape:t,crops:n};return ir.runKernelFunc((function(e){return e.batchToSpaceND(r,t,n)}),o,null,te,i)}}),wc={kernelName:mt,gradFunc:function(e,t,n){var r=n.blockShape,a=n.paddings;return{x:function(){return bc(e,r,a)}}}},kc={kernelName:vt,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return Oa(e,r)}}}},Cc={kernelName:dt,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Pa(e,qa(ti(ra(n,"float32")),2))}}}},Ec={kernelName:xt,inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(e,qa(ra(n,"float32"),2))}}}},Sc={kernelName:yt,inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=Ja(2);return{a:function(){return qa(e,qa(o,ao(r,a)))},b:function(){return qa(e,qa(o,ao(a,r)))}}}},Nc={kernelName:It,gradFunc:function(e){return{x:function(){return co(e)}}}},Tc={kernelName:"Sub",inputsToSave:["a","b"],gradFunc:function(e,t){var n=E(t,2),r=n[0],a=n[1],o=Ko(r.shape,a.shape);return{a:function(){var t=e,n=Ho(r.shape,o);return n.length>0&&(t=ri(t,n)),ja(t,r.shape)},b:function(){var t=e,n=Ho(a.shape,o);return n.length>0&&(t=ri(t,n)),ja(vi(t),a.shape)}}}},Rc={kernelName:ht,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=r.shape.slice();nn(n.axis,r.shape).forEach((function(e){a[e]=1}));var o=ja(e,a),i=qa(o,bi(r.shape,"float32"));return{x:function(){return i}}}},Ic={kernelName:"Tan",inputsToSave:["x"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return Pa(e,ni(pc(n)))}}}},_c={kernelName:kt,outputsToSave:[!0],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return qa(ao(Ja(1),ni(n)),e)}}}},Ac={kernelName:Ct,inputsToSave:["x"],gradFunc:function(e,t,n){var r=E(t,1)[0],a=n.reps;return{x:function(){var t=co(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=Ia(t,eo(e,[n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(var o=0;o<a[0];++o)for(var i=0;i<a[1];++i)t=Ia(t,eo(e,[o*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(var u=0;u<a[0];++u)for(var s=0;s<a[1];++s)for(var c=0;c<a[2];++c)t=Ia(t,eo(e,[u*r.shape[0],s*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(r.rank," tensors yet."));for(var l=0;l<a[0];++l)for(var f=0;f<a[1];++f)for(var p=0;p<a[2];++p)for(var d=0;d<a[3];++d)t=Ia(t,eo(e,[l*r.shape[0],f*r.shape[1],p*r.shape[2],d*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},Oc={kernelName:St,gradFunc:function(e,t,n){var r=Wa(n.perm);return{x:function(){return Ha(e,r)}}}},Dc={kernelName:Nt,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return ro(e,r)}}}};var Fc=vr({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=hr(e,"x","gather"),a=hr(t,"indices","gather","int32"),o={x:r,indices:a},i={axis:n},u=function(e,t){var o=nn(n,r.shape)[0],i=hu(r,a,o),u=e.gather(r,ja(a,[a.size]),o);return t([r,a]),ja(u,i.outputShape)};return ir.runKernelFunc(u,o,null,ke,i)}});var Pc=vr({maximum_:function(e,t){var n=hr(e,"a","maximum"),r=hr(t,"b","maximum"),a=E(Zn(n,r),2);n=a[0],r=a[1],"bool"===n.dtype&&(n=ra(n,"int32"),r=ra(r,"int32")),Ko(n.shape,r.shape);var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.maximum(n,r);return t([n,r]),a}),o,null,De)}}),Lc={kernelName:Tt,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=E(t,1)[0];return{x:function(){return function(e,t){for(var n=Pc(t,co(t)),r=Fc(e,n),a=qo(t,Ja(0,"int32")),o=r.rank-a.rank,i=0;i<o;++i)a=no(a,i+1);a=Yo(a,bi(r.shape,"bool"));var u=co(r);return $o(a,r,u)}(e,n)}}}};for(var Mc=0,Bc=[wu,ku,Cu,Eu,Su,Nu,Tu,Ru,Iu,_u,Au,Ou,Fu,Lu,Mu,zu,Vu,Uu,Wu,Gu,ju,Yu,qu,Ju,es,ns,as,us,ss,cs,ls,fs,ps,ds,ms,hs,gs,xs,ks,Cs,Es,Ss,Ns,Ts,Rs,Is,As,Fs,Fs,Ls,Bs,Vs,Us,Ws,js,Hs,Ks,qs,Xs,Ys,Ys,Qs,$s,Js,Zs,ec,tc,nc,rc,ac,oc,ic,sc,cc,lc,fc,dc,mc,gc,yc,xc,wc,wc,kc,kc,Cc,Sc,Ec,Nc,Tc,Rc,Ic,_c,Ac,Oc,Dc,Lc,{kernelName:Rt,gradFunc:function(e){return{x:function(){return co(e)}}}}];Mc<Bc.length;Mc++){Ut(Bc[Mc])}Gn.prototype.abs=function(){return this.throwIfDisposed(),Jo(this)};var zc=vr({acos_:function(e){var t=hr(e,"x","acos"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.acos(t);return n([t]),r}),n,null,V)}});Gn.prototype.acos=function(){return this.throwIfDisposed(),zc(this)};var Vc=vr({acosh_:function(e){var t=hr(e,"x","acosh"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.acosh(t);return n([t]),r}),n,null,U)}});Gn.prototype.acosh=function(){return this.throwIfDisposed(),Vc(this)};var Uc=vr({mod_:function(e,t){var n=hr(e,"a","mod"),r=hr(t,"b","mod"),a=E(Zn(n,r),2);n=a[0],r=a[1];var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.mod(n,r);return t([n,r]),a}),o,null,"Mod")}});var Wc=vr({addStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","addStrict"),r=hr(t,"b","addStrict");return qt(n.shape,r.shape,"Error in addStrict: "),Ia(n,r)}}),Gc=vr({divStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","div"),r=hr(t,"b","div");return qt(n.shape,r.shape,"Error in divideStrict: "),Pa(n,r)}}),jc=vr({maximumStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","maximumStrict"),r=hr(t,"b","maximumStrict");return qt(n.shape,r.shape,"Error in maximumStrict: "),Pc(n,r)}}),Hc=vr({minimumStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","minimumStrict"),r=hr(t,"b","minimumStrict");return qt(n.shape,r.shape,"Error in minimumStrict: "),Si(n,r)}}),Kc=vr({modStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","modStrict"),r=hr(t,"b","modStrict");return qt(n.shape,r.shape,"Error in modStrict: "),Uc(n,r)}}),qc=vr({mulStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","mul"),r=hr(t,"b","mul");return qt(n.shape,r.shape,"Error in multiplyStrict: "),qa(n,r)}}),Xc=vr({powStrict_:function(e,t){return ui("strict variants of ops have been deprecated and will be removed in future"),qt(e.shape,t.shape,"Error in powStrict: "),ei(e,t)}}),Yc=vr({squaredDifferenceStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","squaredDifferenceStrict"),r=hr(t,"b","squaredDifferenceStrict");return qt(n.shape,r.shape,"Error in squaredDifferenceStrict: "),Ti(n,r)}}),Qc=vr({subStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","subStrict"),r=hr(t,"b","subStrict");return qt(n.shape,r.shape,"Error in subStrict: "),ao(n,r)}});Gn.prototype.addStrict=function(e){return this.throwIfDisposed(),Wc(this,e)},Gn.prototype.add=function(e){return this.throwIfDisposed(),Ia(this,e)};var $c=vr({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"x","all","bool"),a=function(e){var a=nn(t,r.shape),o=a,i=Ua(o,r.rank);null!=i&&(r=Ha(r,i),o=Ga(o.length,r.rank));var u=e.all(r,o);if(n){var s=za(u.shape,a);return ja(u,s)}return u},o={x:r},i={axis:t,keepDims:n};return ir.runKernelFunc(a,o,null,"All",i)}});Gn.prototype.all=function(e,t){return this.throwIfDisposed(),$c(this,e,t)};var Jc=vr({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"x","any","bool"),a=function(e){var a=nn(t,r.shape),o=a,i=Ua(o,r.rank);null!=i&&(r=Ha(r,i),o=Ga(o.length,r.rank));var u=e.any(r,o);if(n){var s=za(u.shape,a);return ja(u,s)}return u},o={x:r},i={axis:t,keepDims:n};return ir.runKernelFunc(a,o,null,"Any",i)}});Gn.prototype.any=function(e,t){return this.throwIfDisposed(),Jc(this,e,t)};var Zc=vr({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=hr(e,"x","argMax"),r=function(e,r){r([n]);var a=nn(t,n.shape),o=Ua(a,n.rank);return null!=o&&(n=Ha(n,o),a=Ga(a.length,n.rank)),e.argMax(n,a[0])},a={x:n},o={axis:t};return ir.runKernelFunc(r,a,null,j,o)}});Gn.prototype.argMax=function(e){return this.throwIfDisposed(),Zc(this,e)};var el=vr({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=hr(e,"x","argMin"),r=function(e,r){r([n]),null==t&&(t=0);var a=nn(t,n.shape),o=Ua(a,n.rank);return null!=o&&(n=Ha(n,o),a=Ga(a.length,n.rank)),e.argMin(n,a[0])},a={x:n},o={axis:t};return ir.runKernelFunc(r,a,null,H,o)}});Gn.prototype.argMin=function(e){return this.throwIfDisposed(),el(this,e)},Gn.prototype.asScalar=function(){return this.throwIfDisposed(),Kt(1===this.size,(function(){return"The array must have only 1 element."})),ja(this,[])},Gn.prototype.asType=function(e){return this.throwIfDisposed(),ra(this,e)},Gn.prototype.as1D=function(){return this.throwIfDisposed(),ja(this,[this.size])},Gn.prototype.as2D=function(e,t){return this.throwIfDisposed(),ja(this,[e,t])},Gn.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),ja(this,[e,t,n])},Gn.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),ja(this,[e,t,n,r])},Gn.prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),ja(this,[e,t,n,r,a])};var tl=vr({asin_:function(e){var t=hr(e,"x","asin"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.asin(t);return n([t]),r}),n,null,K)}});Gn.prototype.asin=function(){return this.throwIfDisposed(),tl(this)};var nl=vr({asinh_:function(e){var t=hr(e,"x","asinh"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.asinh(t);return n([t]),r}),n,null,q)}});Gn.prototype.asinh=function(){return this.throwIfDisposed(),nl(this)};var rl=vr({atan_:function(e){var t=hr(e,"x","atan"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.atan(t);return n([t]),r}),n,null,X)}});Gn.prototype.atan=function(){return this.throwIfDisposed(),rl(this)};var al=vr({atan2_:function(e,t){var n=hr(e,"a","atan2"),r=hr(t,"b","atan2"),a=E(Zn(n,r),2);n=a[0],r=a[1];var o={a:n,b:r};return ir.runKernelFunc((function(e,t){var a=e.atan2(n,r);return t([n,r]),a}),o,null,Q)}});Gn.prototype.atan2=function(e){return this.throwIfDisposed(),al(this,e)};var ol=vr({atanh_:function(e){var t=hr(e,"x","atanh"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.atanh(t);return n([t]),r}),n,null,Y)}});Gn.prototype.atanh=function(){return this.throwIfDisposed(),ol(this)};var il=vr({avgPool_:function(e,t,n,r,a){var o=hr(e,"x","avgPool","float32");Kt(Ki(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var i=o,u=!1;3===o.rank&&(u=!0,i=ja(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Kt(4===i.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(i.rank,".")})),null!=a&&Kt(Jt(r),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var s={x:i},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=ir.runKernelFunc((function(e,o){var u=Fi(i.shape,t,n,1,r,a);return o([i]),1===u.filterWidth&&1===u.filterHeight&&$t(u.inShape,u.outShape)?i.clone():e.avgPool(i,u)}),s,null,$,c);return l=ra(l,o.dtype),u?ja(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});function ul(e){return null==e?null:0===e.rank?ja(e,[e.size]):1===e.rank?e:2===e.rank?ja(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?ja(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}Gn.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),il(this,e,t,n,r)},Gn.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),bc(this,e,t)};var sl=vr({batchNorm_:function(e,t,n,r,a,o){null==o&&(o=.001);var i,u,s=hr(e,"x","batchNorm"),c=hr(t,"mean","batchNorm"),l=hr(n,"variance","batchNorm");null!=a&&(i=hr(a,"scale","batchNorm")),null!=r&&(u=hr(r,"offset","batchNorm")),Kt(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),Kt(null==u||c.rank===u.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),Kt(null==i||c.rank===i.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var f=function(e){return 0===e.rank||1===e.rank?ja(e,[1,1,1,e.size]):2===e.rank?ja(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?ja(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(s),p={x:f,scale:i,offset:u,mean:c,variance:l},d={varianceEpsilon:o},h=ir.runKernelFunc((function(e,t){return t([f,c,l,i]),e.batchNorm(f,ul(c),ul(l),ul(u),ul(i),o)}),p,null,we,d);return ja(h,s.shape)}});Gn.prototype.batchNorm=function(e,t,n,r,a){return this.throwIfDisposed(),sl(this,e,t,n,r,a)},Gn.prototype.broadcastTo=function(e){return this.throwIfDisposed(),Qo(this,e)},Gn.prototype.cast=function(e){return this.throwIfDisposed(),ra(this,e)};var cl=vr({ceil_:function(e){var t=hr(e,"x","ceil"),n={x:t};return ir.runKernelFunc((function(e){return e.ceil(t)}),n,null,ae)}});Gn.prototype.ceil=function(){return this.throwIfDisposed(),cl(this)};var ll=vr({clipByValue_:function(e,t,n){var r=hr(e,"x","clipByValue");Kt(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")}));var a={x:r},o={clipValueMin:t,clipValueMax:n};return ir.runKernelFunc((function(e,a){var o=e.clip(r,t,n);return a([r]),o}),a,null,oe,o)}});Gn.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),ll(this,e,t)},Gn.prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof Gn&&(e=[e]),Oa([this].concat(R(e)),t)};var fl=vr({conv1d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,i=arguments.length>6?arguments[6]:void 0,u=hr(e,"x","conv1d"),s=hr(t,"filter","conv1d"),c=u,l=!1;2===u.rank&&(l=!0,c=ja(u,[1,u.shape[0],u.shape[1]])),Kt(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(c.rank,".")})),Kt(3===s.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(s.rank,".")})),null!=i&&Kt(Jt(r),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(r,".")})),Kt(c.shape[2]===s.shape[1],(function(){return"Error in conv1d: depth of input (".concat(c.shape[2],") must match ")+"input depth for filter ".concat(s.shape[1],".")})),Kt(Ki(n,o),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(o,"'")})),Kt("NWC"===a,(function(){return"Error in conv1d: got dataFormat of ".concat(a," but only NWC is currently supported.")}));var f=ja(s,[1,s.shape[0],s.shape[1],s.shape[2]]),p=ja(c,[c.shape[0],1,c.shape[1],c.shape[2]]),d=[1,n],h=[1,o],m="NHWC",v=Xu(p,f,d,r,m,h,i);return ja(v,l?[v.shape[2],v.shape[3]]:[v.shape[0],v.shape[2],v.shape[3]])}});Gn.prototype.conv1d=function(e,t,n,r,a,o){return this.throwIfDisposed(),fl(this,e,t,n,r,a,o)};var pl=vr({conv2dTranspose_:function(e,t,n,r,a,o){var i=hr(e,"x","conv2dTranspose"),u=hr(t,"filter","conv2dTranspose");return Ku(n,i,u,r,a,"NHWC",o)}});Gn.prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),pl(this,e,t,n,r,a)},Gn.prototype.conv2d=function(e,t,n,r,a,o){return this.throwIfDisposed(),Xu(this,e,t,n,r,a,o)},Gn.prototype.cos=function(){return this.throwIfDisposed(),pc(this)},Gn.prototype.cosh=function(){return this.throwIfDisposed(),hc(this)},Gn.prototype.cumsum=function(e,t,n){return this.throwIfDisposed(),rs(this,e,t,n)};var dl=vr({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",r=hr(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],o="NHWC"===n?r.shape[2]:r.shape[3],i="NHWC"===n?r.shape[3]:r.shape[1];Kt(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(a," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(r.shape)})),Kt(o*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(o," and ").concat(t," for depthToSpace with input shape\n        ").concat(r.shape)})),Kt(i%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(i," for depthToSpace with input shape ").concat(r.shape)}));var u=function(e){return e.depthToSpace(r,t,n)},s={x:r},c={blockSize:t,dataFormat:n};return ir.runKernelFunc(u,s,null,de,c)}});Gn.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),dl(this,e,t)};var hl=vr({depthwiseConv2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6?arguments[6]:void 0,u=hr(e,"x","depthwiseConv2d"),s=hr(t,"filter","depthwiseConv2d"),c=u,l=!1;3===u.rank&&(l=!0,c=ja(u,[1,u.shape[0],u.shape[1],u.shape[2]])),Kt(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(c.rank,".")})),Kt(4===s.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(s.rank,".")})),Kt(c.shape[3]===s.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(c.shape[3],") must match the inChannels dimension in ")+"filter ".concat(s.shape[2],".")})),null!=i&&Kt(Jt(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(i," but got pad ").concat(r,".")}));var f=function(e,t){null==o&&(o=[1,1]),Kt(Ki(n,o),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(n," and dilations '").concat(o,"'")}));var a=Li(c.shape,s.shape,n,o,r,i,!0),u=e.depthwiseConv2D(c,s,a);return t([c,s]),u},p={x:c,filter:s},d={strides:n,pad:r,dataFormat:a,dilations:o,dimRoundingMode:i},h=ir.runKernelFunc(f,p,null,he,d);return l?ja(h,[h.shape[1],h.shape[2],h.shape[3]]):h}});Gn.prototype.depthwiseConv2D=function(e,t,n,r,a,o){return ui("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),hl(this,e,t,n,r,a,o)},Gn.prototype.depthwiseConv2d=function(e,t,n,r,a,o){return this.throwIfDisposed(),hl(this,e,t,n,r,a,o)};var ml=vr({dilation2d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",i=hr(e,"x","dilation2d"),u=hr(t,"filter","dilation2d");Kt(3===i.rank||4===i.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(i.rank,".")})),Kt(3===u.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(u.rank,".")})),Kt("NHWC"===o,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(o)}));var s=i,c=!1;3===i.rank&&(s=ja(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0);var l={x:s,filter:u},f={strides:n,pad:r,dilations:a},p=ir.runKernel(me,l,f);return c?ja(p,[p.shape[1],p.shape[2],p.shape[3]]):p}});Gn.prototype.dilation2d=function(e,t,n,r,a){return this.throwIfDisposed(),ml(this,e,t,n,r,a)};var vl=vr({divNoNan_:function(e,t){var n=hr(e,"a","div"),r=hr(t,"b","div"),a=E(Zn(n,r),2);n=a[0],r=a[1];var o=Pa(n,r),i=co(o),u=Os(r,i);return $o(u,i,o)}});Gn.prototype.divNoNan=function(e){return this.throwIfDisposed(),vl(this,e)},Gn.prototype.divStrict=function(e){return this.throwIfDisposed(),Gc(this,e)},Gn.prototype.div=function(e){return this.throwIfDisposed(),Pa(this,e)};var gl=vr({dot_:function(e,t){var n=hr(e,"t1","dot"),r=hr(t,"t2","dot");Kt((1===n.rank||2===n.rank)&&(1===r.rank||2===r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(r.rank,".")}));var a=1===n.rank?n.size:n.shape[1],o=1===r.rank?r.size:r.shape[0];if(Kt(a===o,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(a," and ").concat(o,".")})),1===n.rank&&1===r.rank){var i=ja(n,[1,-1]),u=ja(r,[-1,1]),s=mi(i,u);return ja(s,[])}if(1===n.rank&&2===r.rank){var c=ja(n,[1,-1]),l=ja(r,[r.shape[0],r.shape[1]]),f=mi(c,l);return ja(f,[f.size])}if(2===n.rank&&1===r.rank){var p=ja(r,[-1,1]),d=mi(n,p);return ja(d,[d.size])}var h=ja(r,[r.shape[0],r.shape[1]]);return mi(n,h)}});Gn.prototype.dot=function(e){return this.throwIfDisposed(),gl(this,e)},Gn.prototype.elu=function(){return this.throwIfDisposed(),Xi(this)};var yl=vr({equalStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","equalStrict"),r=hr(t,"b","equalStrict");return qt(n.shape,r.shape,"Error in equalStrict: "),Os(n,r)}}),xl=vr({greaterEqualStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","greaterEqualStrict"),r=hr(t,"b","greaterEqualStrict");return qt(n.shape,r.shape,"Error in greaterEqualStrict: "),qo(n,r)}}),bl=vr({greaterStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","greaterStrict"),r=hr(t,"b","greaterStrict");return qt(n.shape,r.shape,"Error in greaterStrict: "),hi(n,r)}}),wl=vr({lessEqualStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","lessEqualStrict"),r=hr(t,"b","lessEqualStrict");return qt(n.shape,r.shape,"Error in lessEqualStrict: "),Xo(n,r)}}),kl=vr({lessStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","lessStrict"),r=hr(t,"b","lessStrict");return qt(n.shape,r.shape,"Error in lessStrict: "),Ps(n,r)}}),Cl=vr({notEqualStrict_:function(e,t){ui("strict variants of ops have been deprecated and will be removed in future");var n=hr(e,"a","notEqualStrict"),r=hr(t,"b","notEqualStrict");return qt(n.shape,r.shape,"Error in notEqualStrict: "),ki(n,r)}});Gn.prototype.equalStrict=function(e){return this.throwIfDisposed(),yl(this,e)},Gn.prototype.equal=function(e){return this.throwIfDisposed(),Os(this,e)};var El=vr({erf_:function(e){var t=hr(e,"x","erf");Kt("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=ra(t,"float32"));var n={x:t};return ir.runKernelFunc((function(e,n){var r=e.erf(t);return n([t]),r}),n,null,"Erf")}});Gn.prototype.erf=function(){return this.throwIfDisposed(),El(this)},Gn.prototype.exp=function(){return this.throwIfDisposed(),Ri(this)},Gn.prototype.expandDims=function(e){return this.throwIfDisposed(),no(this,e)};var Sl=vr({expm1_:function(e){var t=hr(e,"x","expm1"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.expm1(t);return n([t]),r}),n,null,ge)}});Gn.prototype.expm1=function(){return this.throwIfDisposed(),Sl(this)},Gn.prototype.fft=function(){return this.throwIfDisposed(),lo(this)},Gn.prototype.flatten=function(){return this.throwIfDisposed(),ja(this,[this.size])},Gn.prototype.floor=function(){return this.throwIfDisposed(),Gs(this)},Gn.prototype.floorDiv=function(e){return this.throwIfDisposed(),Fa(this,e)},Gn.prototype.gather=function(e,t){return this.throwIfDisposed(),Fc(this,e,t)},Gn.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),xl(this,e)},Gn.prototype.greaterEqual=function(e){return this.throwIfDisposed(),qo(this,e)},Gn.prototype.greaterStrict=function(e){return this.throwIfDisposed(),bl(this,e)},Gn.prototype.greater=function(e){return this.throwIfDisposed(),hi(this,e)},Gn.prototype.ifft=function(){return this.throwIfDisposed(),po(this)},Gn.prototype.irfft=function(){return this.throwIfDisposed(),mo(this)};var Nl=vr({isFinite_:function(e){var t=hr(e,"x","isFinite"),n={x:t};return ir.runKernelFunc((function(e){return e.isFinite(t)}),n,null,Se)}});Gn.prototype.isFinite=function(){return this.throwIfDisposed(),Nl(this)};var Tl=vr({isInf_:function(e){var t=hr(e,"x","isInf"),n={x:t};return ir.runKernelFunc((function(e){return e.isInf(t)}),n,null,Ne)}});Gn.prototype.isInf=function(){return this.throwIfDisposed(),Tl(this)};var Rl=vr({isNaN_:function(e){var t=hr(e,"x","isNaN"),n={x:t};return ir.runKernelFunc((function(e){return e.isNaN(t)}),n,null,Te)}});Gn.prototype.isNaN=function(){return this.throwIfDisposed(),Rl(this)};var Il=vr({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=hr(e,"x","leakyRelu");return Pc(qa(Ja(t),n),n)}});Gn.prototype.leakyRelu=function(e){return this.throwIfDisposed(),Il(this,e)},Gn.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),wl(this,e)},Gn.prototype.lessEqual=function(e){return this.throwIfDisposed(),Xo(this,e)},Gn.prototype.lessStrict=function(e){return this.throwIfDisposed(),kl(this,e)},Gn.prototype.less=function(e){return this.throwIfDisposed(),Ps(this,e)};var _l=vr({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,o=hr(e,"x","localResponseNormalization");Kt(4===o.rank||3===o.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(o.rank,".")})),Kt(Jt(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var i=o,u=!1;3===o.rank&&(u=!0,i=ja(o,[1,o.shape[0],o.shape[1],o.shape[2]]));var s=function(e,o){var u=e.localResponseNormalization4D(i,t,n,r,a);return o([i,u]),u},c={x:i},l={depthRadius:t,bias:n,alpha:r,beta:a},f=ir.runKernelFunc(s,c,null,_e,l);return u?ja(f,[f.shape[1],f.shape[2],f.shape[3]]):f}});Gn.prototype.localResponseNormalization=function(e,t,n,r){return this.throwIfDisposed(),_l(this,e,t,n,r)};var Al=vr({softplus_:function(e){var t=hr(e,"x","softplus"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.softplus(t);return n([t]),r}),n,null,pt)}});var Ol=vr({logSigmoid_:function(e){var t=hr(e,"x","logSigmoid"),n=xi((function(e){return{value:vi(Al(vi(e))),gradFunc:function(t){return qa(t,Za(vi(e)))}}}));return n(t)}});Gn.prototype.logSigmoid=function(){return this.throwIfDisposed(),Ol(this)};var Dl=vr({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=hr(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var r=function(n,r){var a=Ka(e,t,!0),o=ao(e,a),i=ao(ra(o,"float32"),Ni(ri(Ri(o),t,!0)));return r([i]),i},a={logits:n},o={axis:t};return ir.runKernelFunc(r,a,null,Ie,o)}});Gn.prototype.logSoftmax=function(e){return this.throwIfDisposed(),Dl(this,e)},Gn.prototype.logSumExp=function(e,t){return this.throwIfDisposed(),Ai(this,e,t)},Gn.prototype.log=function(){return this.throwIfDisposed(),Ni(this)},Gn.prototype.log1p=function(){return this.throwIfDisposed(),Ii(this)},Gn.prototype.logicalAnd=function(e){return this.throwIfDisposed(),Yo(this,e)},Gn.prototype.logicalNot=function(){return this.throwIfDisposed(),uc(this)};var Fl=vr({logicalOr_:function(e,t){var n=hr(e,"a","logicalOr","bool"),r=hr(t,"b","logicalOr","bool");Ko(n.shape,r.shape);var a={a:n,b:r};return ir.runKernelFunc((function(e){return e.logicalOr(n,r)}),a,null,"LogicalOr")}});Gn.prototype.logicalOr=function(e){return this.throwIfDisposed(),Fl(this,e)};var Pl=vr({logicalXor_:function(e,t){var n=hr(e,"a","logicalXor","bool"),r=hr(t,"b","logicalXor","bool");return Ko(n.shape,r.shape),Yo(Fl(e,t),uc(Yo(e,t)))}});Gn.prototype.logicalXor=function(e){return this.throwIfDisposed(),Pl(this,e)},Gn.prototype.matMul=function(e,t,n){return this.throwIfDisposed(),mi(this,e,t,n)};var Ll=vr({maxPool_:function(e,t,n,r,a){var o=hr(e,"x","maxPool"),i=o,u=!1;3===o.rank&&(u=!0,i=ja(o,[1,o.shape[0],o.shape[1],o.shape[2]])),Kt(4===i.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(i.rank,".")})),Kt(Ki(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),null!=a&&Kt(Jt(r),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var s={x:i},c={filterSize:t,strides:n,pad:r,dimRoundingMode:a},l=ir.runKernelFunc((function(e,o){var u,s=Fi(i.shape,t,n,1,r,a);return u=1===s.filterWidth&&1===s.filterHeight&&$t(s.inShape,s.outShape)?i.clone():e.maxPool(i,s),o([i,u]),u}),s,null,Fe,c);return u?ja(l,[l.shape[1],l.shape[2],l.shape[3]]):l}});Gn.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),Ll(this,e,t,n,r)},Gn.prototype.max=function(e,t){return this.throwIfDisposed(),Ka(this,e,t)},Gn.prototype.maximumStrict=function(e){return this.throwIfDisposed(),jc(this,e)},Gn.prototype.maximum=function(e){return this.throwIfDisposed(),Pc(this,e)},Gn.prototype.mean=function(e,t){return this.throwIfDisposed(),wi(this,e,t)},Gn.prototype.min=function(e,t){return this.throwIfDisposed(),Zo(this,e,t)},Gn.prototype.minimumStrict=function(e){return this.throwIfDisposed(),Hc(this,e)},Gn.prototype.minimum=function(e){return this.throwIfDisposed(),Si(this,e)},Gn.prototype.modStrict=function(e){return this.throwIfDisposed(),Kc(this,e)},Gn.prototype.mod=function(e){return this.throwIfDisposed(),Uc(this,e)},Gn.prototype.mulStrict=function(e){return this.throwIfDisposed(),qc(this,e)},Gn.prototype.mul=function(e){return this.throwIfDisposed(),qa(this,e)},Gn.prototype.neg=function(){return this.throwIfDisposed(),vi(this)},Gn.prototype.norm=function(e,t,n){return this.throwIfDisposed(),oi(this,e,t,n)},Gn.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),Cl(this,e)},Gn.prototype.notEqual=function(e){return this.throwIfDisposed(),ki(this,e)};var Ml=vr({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var a=hr(e,"indices","oneHot","int32"),o=[].concat(R(a.shape),[t]),i=function(e,i){return i([a]),ja(e.oneHot(ja(a,[a.size]),t,n,r),o)},u={indices:a},s={depth:t,onValue:n,offValue:r};return ir.runKernelFunc(i,u,null,Ke,s)}});Gn.prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),Ml(this,e,t,n)};var Bl=vr({onesLike_:function(e){var t=hr(e,"x","onesLike"),n={x:t};return ir.runKernelFunc((function(e,n){if("complex64"===t.dtype){var r=Bl($a(t)),a=co(La(t));return gr(r,a)}return e.onesLike(t)}),n,null,He)}});Gn.prototype.onesLike=function(){return this.throwIfDisposed(),Bl(this)},Gn.prototype.pad=function(e,t){return this.throwIfDisposed(),vc(this,e,t)};var zl=vr({pool_:function(e,t,n,r,a,o){null==a&&(a=[1,1]),null==o&&(o=1),0===r&&(r="valid");var i=hr(e,"x","maxPool"),u=i,s=!1;3===i.rank&&(s=!0,u=ja(i,[1,i.shape[0],i.shape[1],i.shape[2]])),Kt(Ki(o,a),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(a,"'")}));var c,l=Fi(u.shape,t,o,a,r),f=[l.dilationHeight,l.dilationWidth];c="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([l.filterHeight,l.filterWidth],f):[[0,0],[0,0]];var p=1===f[0]&&1===f[1],d=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),o=e.concat(r,a),i=t.map((function(e,t){return(e-o[t]%e)%e})),u=a.map((function(e,t){return e+i[t]})),s=t.map((function(e,t){return[r[t],u[t]]})),c=t.map((function(e,t){return[0,i[t]]}));return[s,c]}([l.inHeight,l.inWidth],f,c),h=E(d,2),m=h[0],v=h[1],g=p?r:"valid",y=p?u:Bu(u,f,m),x=("avg"===n?function(){return il(y,t,o,g)}:function(){return Ll(y,t,o,g)})(),b=p?x:bc(x,f,v);return s?ja(b,[b.shape[1],b.shape[2],b.shape[3]]):b}});Gn.prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),zl(this,e,t,n,r,a)},Gn.prototype.powStrict=function(e){return this.throwIfDisposed(),Xc(this,e)},Gn.prototype.pow=function(e){return this.throwIfDisposed(),ei(this,e)},Gn.prototype.prelu=function(e){return this.throwIfDisposed(),Yi(this,e)};var Vl=vr({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=hr(e,"x","prod"),a=function(e){"bool"===r.dtype&&(r=ra(r,"int32"));var a=nn(t,r.shape),o=Ua(a,r.rank),i=a,u=r;null!=o&&(u=Ha(r,o),i=Ga(i.length,r.rank));var s=e.prod(u,i);if(n){var c=za(s.shape,a);s=ja(s,c)}return s},o={x:r},i={axis:t,keepDims:n};return ir.runKernelFunc(a,o,null,Ye,i)}});Gn.prototype.prod=function(e,t){return this.throwIfDisposed(),Vl(this,e,t)};var Ul=vr({reciprocal_:function(e){var t=hr(e,"x","reciprocal"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.reciprocal(t);return n([t]),r}),n,null,$e)}});Gn.prototype.reciprocal=function(){return this.throwIfDisposed(),Ul(this)},Gn.prototype.relu=function(){return this.throwIfDisposed(),Ei(this)},Gn.prototype.relu6=function(){return this.throwIfDisposed(),Qi(this)},Gn.prototype.reshapeAs=function(e){return this.throwIfDisposed(),ja(this,e.shape)},Gn.prototype.reshape=function(e){return this.throwIfDisposed(),ja(this,e)},Gn.prototype.resizeBilinear=function(e,t){return this.throwIfDisposed(),Go(this,e,t)},Gn.prototype.resizeNearestNeighbor=function(e,t){return this.throwIfDisposed(),jo(this,e,t)},Gn.prototype.reverse=function(e){return this.throwIfDisposed(),ho(this,e)},Gn.prototype.rfft=function(){return this.throwIfDisposed(),fo(this)};var Wl=vr({round_:function(e){var t=hr(e,"x","round"),n={x:t};return ir.runKernelFunc((function(e){return e.round(t)}),n,null,at)}});Gn.prototype.round=function(){return this.throwIfDisposed(),Wl(this)},Gn.prototype.rsqrt=function(){return this.throwIfDisposed(),vs(this)};var Gl=vr({selu_:function(e){var t=hr(e,"x","selu"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.selu(t);return n([t]),r}),n,null,ut)}});Gn.prototype.selu=function(){return this.throwIfDisposed(),Gl(this)};var jl=vr({separableConv2d_:function(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",u=hr(e,"x","separableConv2d"),s=hr(t,"depthwiseFilter","separableConv2d"),c=hr(n,"pointwiseFilter","separableConv2d"),l=u,f=!1;if(3===u.rank&&(f=!0,l=ja(u,[1,u.shape[0],u.shape[1],u.shape[2]])),"NCHW"===i)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Kt(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(l.rank,".")})),Kt(4===s.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(s.rank,".")})),Kt(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(s.rank,".")})),Kt(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(c.shape[0],".")})),Kt(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(c.shape[1],".")}));var p=s.shape[2],d=s.shape[3];Kt(c.shape[2]===p*d,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(p*d,", ")+"but got ".concat(c.shape[2],".")}));var h=hl(l,s,r,a,i,o),m=1,v=Xu(h,c,m,"valid",i);return f?ja(v,[v.shape[1],v.shape[2],v.shape[3]]):v}});Gn.prototype.separableConv2d=function(e,t,n,r,a,o){return this.throwIfDisposed(),jl(this,e,t,n,r,a,o)},Gn.prototype.sigmoid=function(){return this.throwIfDisposed(),Za(this)};var Hl=vr({sign_:function(e){var t=hr(e,"x","sign"),n={x:t};return ir.runKernelFunc((function(e){return e.sign(t)}),n,null,lt)}});Gn.prototype.sign=function(){return this.throwIfDisposed(),Hl(this)},Gn.prototype.sin=function(){return this.throwIfDisposed(),Zu(this)},Gn.prototype.sinh=function(){return this.throwIfDisposed(),ts(this)},Gn.prototype.slice=function(e,t){return this.throwIfDisposed(),eo(this,e,t)},Gn.prototype.softmax=function(e){return this.throwIfDisposed(),to(this,e)},Gn.prototype.softplus=function(){return this.throwIfDisposed(),Al(this)},Gn.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),Bu(this,e,t)},Gn.prototype.split=function(e,t){return this.throwIfDisposed(),so(this,e,t)},Gn.prototype.sqrt=function(){return this.throwIfDisposed(),ti(this)},Gn.prototype.square=function(){return this.throwIfDisposed(),ni(this)},Gn.prototype.squaredDifference=function(e){return this.throwIfDisposed(),Ti(this,e)},Gn.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),Yc(this,e)},Gn.prototype.squeeze=function(e){return this.throwIfDisposed(),ii(this,e)},Gn.prototype.stack=function(e,t){this.throwIfDisposed();var n=e instanceof Gn?[this,e]:[this].concat(R(e));return ro(n,t)},Gn.prototype.step=function(e){return this.throwIfDisposed(),$i(this,e)};var Kl=vr({stridedSlice_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,c=hr(e,"x","stridedSlice"),l=function(e){null==r&&(r=new Array(t.length));var l=ba(i);if(l.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==i&&0!==u)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==i&&0!==s)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var f=c.rank-t.length,p=ba(u),d=c.shape.slice();p.forEach((function(e){t[e]=0,n[e]=1,d.splice(e,0,1)}));var h=Ea((c=ja(c,d)).shape,l,f,t,n,r,a,o,i),m=h.begin,v=h.end,g=h.strides;t=m,n=v,r=g;var y=ba(s);y.forEach((function(e){n[e]=t[e]+1,r[e]=1}));var x=wa(t,n,r),b=x.filter((function(e,t){return-1===y.indexOf(t)})),w=r.every((function(e){return 1===e}));if(w)return ja(eo(c,t,x),b);var k=e.stridedSlice(c,t,n,r);return ja(k,b)},f={x:c},p={begin:t,end:n,strides:r,beginMask:a,endMask:o,ellipsisMask:i,newAxisMask:u,shrinkAxisMask:s};return ir.runKernelFunc(l,f,null,wt,p)}});Gn.prototype.stridedSlice=function(e,t,n,r,a,o,i,u){return this.throwIfDisposed(),Kl(this,e,t,n,r,a,o,i,u)},Gn.prototype.subStrict=function(e){return this.throwIfDisposed(),Qc(this,e)},Gn.prototype.sub=function(e){return this.throwIfDisposed(),ao(this,e)},Gn.prototype.sum=function(e,t){return this.throwIfDisposed(),ri(this,e,t)};var ql=vr({tan_:function(e){var t=hr(e,"x","tan"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.tan(t);return n([t]),r}),n,null,"Tan")}});Gn.prototype.tan=function(){return this.throwIfDisposed(),ql(this)};var Xl=vr({tanh_:function(e){var t=hr(e,"x","tanh"),n={x:t};return ir.runKernelFunc((function(e,n){var r=e.tanh(t);return n([r]),r}),n,null,kt)}});Gn.prototype.tanh=function(){return this.throwIfDisposed(),Xl(this)},Gn.prototype.tile=function(e){return this.throwIfDisposed(),pi(this,e)},Gn.prototype.toBool=function(){return this.throwIfDisposed(),ra(this,"bool")},Gn.prototype.toFloat=function(){return this.throwIfDisposed(),ra(this,"float32")},Gn.prototype.toInt=function(){return this.throwIfDisposed(),ra(this,"int32")};var Yl=vr({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=hr(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(a,") ")+"but got ".concat(t));var o={x:r},i={k:t,sorted:n},u=ir.runKernelFunc((function(e){return e.topk(r,t,n)}),o,null,Et,i),s=E(u,2),c=s[0],l=s[1];return{values:c,indices:l}}});Gn.prototype.topk=function(e,t){return this.throwIfDisposed(),Yl(this,e,t)},Gn.prototype.transpose=function(e){return this.throwIfDisposed(),Ha(this,e)},Gn.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),ys(this,e,t)},Gn.prototype.unstack=function(e){return this.throwIfDisposed(),io(this,e)},Gn.prototype.where=function(e,t){return this.throwIfDisposed(),$o(e,this,t)},Gn.prototype.zerosLike=function(){return this.throwIfDisposed(),co(this)};var Ql,$l,Jl,Zl={},ef={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function tf(e){e in Zl||(Zl[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);if(t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete Zl[e]}),!1),1===e)return t.getContext("webgl",ef)||t.getContext("experimental-webgl",ef);return t.getContext("webgl2",ef)}(e));var t=Zl[e];return t.isContextLost()?(delete Zl[e],tf(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),Zl[e])}function nf(e,t){return[t,e]}function rf(e){var t=Qt(e);return Zt(Math.ceil(t/4))}function af(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function of(e,t){var n,r,a,o,i,u,s,c,l,f=e;return 2===P().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,a=f.RGBA16F,o=f.RGBA32F,i=f.RED,u=4,s=1,c=f.HALF_FLOAT,l=f.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,o=f.RGBA,i=e.RGBA,u=4,s=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:o,textureFormatFloat:i,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:u,defaultNumChannels:s,textureTypeHalfFloat:c,textureTypeFloat:l}}function uf(e,t){var n=t();return P().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Ql||(Ql={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}($l||($l={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Jl||(Jl={}));function sf(e){return!!(P().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function cf(e,t){return kf(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function lf(e,t){var n=kf(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(uf(e,(function(){return e.shaderSource(n,t)})),uf(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=df.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),o=a.length.toString().length+2,i=a.map((function(e,t){return en((t+1).toString(),o)+e})),u=0,s=0;s<i.length;s++)u=Math.max(i[s].length,u);var c=i.slice(0,r-1),l=i.slice(r-1,r),f=i.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(en(l[0],u)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var ff,pf,df=/ERROR: [0-9]+:([0-9]+):/g;function hf(e,t){if(uf(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function mf(e,t,n,r,a,o,i){var u=e.getAttribLocation(t,n);return-1!==u&&(uf(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),uf(e,(function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,o,i)})),uf(e,(function(){return e.enableVertexAttribArray(u)})),!0)}function vf(e,t,n){return kf(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function gf(e,t,n){return e.getUniformLocation(t,n)}function yf(e,t,n,r){uf(e,(function(){return function(e,t,n){Cf(e,n),uf(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),uf(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),uf(e,(function(){return e.uniform1i(n,r)}))}function xf(e,t,n){uf(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),uf(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function bf(e,t){uf(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),uf(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function wf(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function kf(e,t,n){var r=uf(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function Cf(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function Ef(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Qt(e.slice(0,e.length-t))}function Sf(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Nf(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[Ef(e)].concat(R(Sf(e)))),t}function Tf(e){return e%2===0}function Rf(e,t){if($t(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(Tf(n)&&Tf(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&Tf(e[0])&&Tf(t[0])}function If(e,t){return null!=e.getExtension(t)}function _f(e){try{if(null!=tf(e))return!0}catch(t){return!1}return!1}function Af(e){if(0===e)return!1;var t=tf(e);if(1!==e){if(If(t,"EXT_color_buffer_float"))return Of(t);var n="EXT_color_buffer_half_float";if(If(t,n)){var r=t.getExtension(n);return function(e,t){var n=of(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,o=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var i=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,i),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var u=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(i),u}(t,r)}return!1}return!!If(t,"OES_texture_float")&&(!!If(t,"WEBGL_color_buffer_float")&&Of(t))}function Of(e){var t=of(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}var Df=P();Df.registerFlag("HAS_WEBGL",(function(){return Df.getNumber("WEBGL_VERSION")>0})),Df.registerFlag("WEBGL_VERSION",(function(){return _f(2)?2:_f(1)?1:0})),Df.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),Df.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Df.get("WEBGL_VERSION")})),Df.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Df.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Df.registerFlag("WEBGL_PACK",(function(){return Df.getBool("HAS_WEBGL")})),Df.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_PACK_CLIP",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Df.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_PACK_REDUCE",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_CONV_IM2COL",(function(){return Df.getBool("WEBGL_PACK")})),Df.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==ff){var t=tf(e);ff=t.getParameter(t.MAX_TEXTURE_SIZE)}return ff}(Df.getNumber("WEBGL_VERSION"))})),Df.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==pf){var t=tf(e);pf=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,pf)}(Df.getNumber("WEBGL_VERSION"))})),Df.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=Df.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=tf(e);return If(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:If(t,"EXT_disjoint_timer_query")?1:0}(e)})),Df.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Df.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!sr()})),Df.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=tf(e);if(1===e){if(!If(t,"OES_texture_float"))return!1}else if(!If(t,"EXT_color_buffer_float"))return!1;return Of(t)}(Df.getNumber("WEBGL_VERSION"))})),Df.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Df.getBool("WEBGL_FORCE_F16_TEXTURES")&&Df.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Df.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return Af(Df.getNumber("WEBGL_VERSION"))})),Df.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=Df.getNumber("WEBGL_VERSION"))&&null!=tf(e).fenceSync;var e})),Df.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Df.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Df.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))}));var Ff=A((function e(t,n){I(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),Pf=A((function e(t,n){I(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")})),Lf=A((function e(t,n,r){I(this,e),this.variableNames=["A"];var a=t.windowSize,o=t.batchSize,i=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];var u="max"===n?">":"<",s=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(u," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")}));function Mf(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function Bf(e,t){return 1===t?[e]:Mf(e,t)}function zf(){var e,t,n,r,a,o,i,u,s,c;return 2===P().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",o="outputColor",i="out vec4 outputColor;",u="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",s="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",o="gl_FragColor",i="",u="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",s="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:o,defineOutput:i,defineSpecialNaN:u,defineSpecialInf:s,defineRound:c}}function Vf(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=dn(t);return r.map((function(t,a){var o="int ".concat(e[a]," = ").concat(n," / ").concat(t),i=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(o,"; ").concat(i,";")})).join("")}function Uf(e){var t=dn(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}var Wf="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",Gf=function(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var o=n-1-a,i=e[o]||1;(t[t.length-1-a]||1)>1&&1===i&&r.unshift(o)}return r};function jf(e,t,n,r){var a=[];e.forEach((function(e){var t=Qt(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";")))}));var o,i,u=a.join("\n"),s=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";r+=n?Kf(e):Hf(e);var a=e.shapeInfo.logicalShape,o=t.logicalShape;a.length<=o.length&&(r+=n?Zf(e,t):ep(e,t));return r}(e,t,r)})).join("\n"),c=t.texShape,l=zf(),f=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(l),p=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(qf,"\n    ").concat(Xf,"\n    ").concat(Yf,"\n  ")}(l);return t.isPacked?(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===n[0])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    ");if(1===n[1])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if($t(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),o=a,i="",u="b, r, c",s=2;s<e.length-1;s++)o*=e[e.length-s-1],i="\n      int b".concat(s," = index / ").concat(o,";\n      index -= b").concat(s," * ").concat(o,";\n    ")+i,u="b".concat(s,", ")+u;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(i,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(u,");\n    }\n  ")}(e,t)}}(t.logicalShape,c),i=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(l)):(o=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){if(1===t[0])return"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t);case 2:return function(e,t){if($t(e,t))return"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=Vf(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=Vf(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=Vf(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=Vf(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,c),i=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(l)),r&&(p+=Qf),[p,f,i,u,o,s,n].join("\n")}function Hf(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=E(e.shapeInfo.texShape,2),a=r[0],o=r[1];if(1===a&&1===o)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var i=E(e.shapeInfo.texShape,2),u=i[0],s=i[1],c=$f(t);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(u,", ").concat(s,", ").concat(c,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(Jf(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],o=r[1];if(1===o&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var i=$f(t);if(1===o)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(i,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(1===a)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(i,") + 0.5) / ").concat(o,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");return"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(o,", index + ").concat(i,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&$t(t,a)){var o=a[0],i=a[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(i,".0, ").concat(o,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}var u=rn(t),s=u.newShape,c=u.keptDims,l=s;if(l.length<t.length){var f=np(e,l),p=["row","col"];return"\n      ".concat(Hf(f),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(rp(p,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(Jf(e),"\n      }\n    ");var d=a[0],h=a[1],m=$f(n);if(1===h)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(d,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");if(1===d)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(m,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(h,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(m,";\n    vec2 uv = uvFromFlat(").concat(d,", ").concat(h,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],o=t[2],i=rn(t),u=i.newShape,s=i.keptDims,c=u;if(c.length<t.length){var l=np(e,c),f=["row","col","depth"];return"\n        ".concat(Hf(l),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(rp(f,s),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(a,", ").concat(o,", 1)));\n        ").concat(Jf(e),"\n      }\n    ");var p=e.shapeInfo.texShape,d=p[0],h=p[1],m=e.shapeInfo.flatOffset;if(h===a&&null==m)return"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(o,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(h,".0, ").concat(d,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(h===o&&null==m)return"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,".0, ").concat(d,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var v=$f(n);return"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a," + col * ").concat(o," + depth + ").concat(v,";\n        vec2 uv = uvFromFlat(").concat(d,", ").concat(h,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],o=t[2]*a,i=t[1]*o,u=rn(t),s=u.newShape,c=u.keptDims;if(s.length<t.length){var l=np(e,s),f=["row","col","depth","depth2"];return"\n      ".concat(Hf(l),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(rp(f,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(i,", ").concat(o,", ").concat(a,", 1)));\n        ").concat(Jf(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,d=e.shapeInfo.texShape,h=d[0],m=d[1];if(m===i&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===a&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var v=$f(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(i," + col * ").concat(o," +\n          depth * ").concat(a," + depth2;\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(m,", index + ").concat(v,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],o=t[3]*a,i=t[2]*o,u=t[1]*i,s=rn(t),c=s.newShape,l=s.keptDims;if(c.length<t.length){var f=np(e,c),p=["row","col","depth","depth2","depth3"];return"\n      ".concat(Hf(f),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(rp(p,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(i,", ").concat(o,", ").concat(a,")) +\n          depth3;\n        ").concat(Jf(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,m=h[0],v=h[1];if(v===u&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(i,", ").concat(o,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=$f(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(i," + depth * ").concat(o," +\n          depth2 * ").concat(a," + depth3 + ").concat(g,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=rn(t),o=a.newShape,i=a.keptDims;if(o.length<t.length){var u=np(e,o),s=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(Hf(u),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(rp(s,i),");\n      }\n    ")}var c=t[5],l=t[4]*c,f=t[3]*l,p=t[2]*f,d=t[1]*p;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(d,", ").concat(p,", ").concat(f,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(Jf(e),"\n      }\n    ");var h=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,v=m[0],g=m[1];if(g===d&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(p,", ").concat(f,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===c&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=$f(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(d," + col * ").concat(p," + depth * ").concat(f," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function Kf(e){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=zf();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=zf();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(o.texture2D,"(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,o=a[0],i=a[1],u=zf();if(null!=a&&$t(t,a))return"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(i,".0, ").concat(o,".0);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    ");var s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=Math.ceil(t[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(c,", ").concat(s[0],", ").concat(s[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,o=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0]){var i=[1,2],u=np(e,t.slice(1)),s=["b","row","col"];return"\n        ".concat(Kf(u),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(rp(s,i),");\n        }\n      ")}var c=o[0],l=o[1],f=Math.ceil(t[2]/2),p=f*Math.ceil(t[1]/2),d=zf();return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(l,", ").concat(p,", ").concat(f,", b, row, col);\n      return ").concat(d.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),o=e.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=i[0],s=i[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),f="int b, int row, int col",p="b * ".concat(l," + (row / 2) * ").concat(c," + (col / 2)"),d=2;d<n-1;d++)f="int b".concat(d,", ")+f,l*=t[n-d-1],p="b".concat(d," * ").concat(l," + ")+p;var h=zf();return"\n    vec4 ".concat(a,"(").concat(f,") {\n      int index = ").concat(p,";\n      int texR = index / ").concat(s,";\n      int texC = index - texR * ").concat(s,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(s,", ").concat(u,");\n      return ").concat(h.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e)}}var qf="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Xf="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Yf="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Qf="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function $f(e){return"offset".concat(e)}function Jf(e){var t=e.name,n=Qt(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function Zf(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),o="get"+a+"AtOutCoords",i=e.shapeInfo.logicalShape.length,u=t.logicalShape.length,s=Gf(e.shapeInfo.logicalShape,t.logicalShape),c=tp(u),l=u-i,f=["x","y","z","w","u","v"];n=0===i?"":u<2&&s.length>=1?"coords = 0;":s.map((function(e){return"coords.".concat(f[e+l]," = 0;")})).join("\n");var p="";p=u<2&&i>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+l])})).join(", ");var d="return outputValue;",h=1===Qt(e.shapeInfo.logicalShape),m=1===Qt(t.logicalShape);if(1!==i||h||m){if(h&&!m)d=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){var v=i-2,g=i-1;s.indexOf(v)>-1&&s.indexOf(g)>-1?d="return vec4(outputValue.x);":s.indexOf(v)>-1?d="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(g)>-1&&(d="return vec4(outputValue.xx, outputValue.zz);")}}else d="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(o,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(p,");\n      ").concat(d,"\n    }\n  ")}function ep(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",o=t.texShape,i=e.shapeInfo.texShape,u=e.shapeInfo.logicalShape.length,s=t.logicalShape.length;if(!e.shapeInfo.isUniform&&u===s&&null==e.shapeInfo.flatOffset&&$t(i,o))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=tp(s),f=Gf(e.shapeInfo.logicalShape,t.logicalShape),p=s-u,d=["x","y","z","w","u","v"];c=0===u?"":s<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords.".concat(d[e+p]," = 0;")})).join("\n");var h="";return h=s<2&&u>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(d[t+p])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(h,");\n    }\n  ")}function tp(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function np(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function rp(e,t){return t.map((function(t){return e[t]})).join(", ")}var ap=A((function e(t,n,r,a){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Kt(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var o=t[t.length-1],i=Math.ceil(o/n);this.outputShape=t.slice(0,-1),i>1&&this.outputShape.push(i),a||this.variableNames.push("bestIndicesA");var u,s,c=this.outputShape,l=c.length,f=tp(l),p=Bf("coords",l);if(1===i){var d=tp(s=l+1);u="\n        ".concat(d," sourceLocR = ").concat(d,"(").concat(p.join(),", 0);\n        ++").concat(p[l-1],";\n        ").concat(d," sourceLocG = ").concat(d,"(").concat(p.join(),", 0);\n        ++").concat(p[l-2],";\n        ").concat(d," sourceLocA = ").concat(d,"(").concat(p.join(),", 0);\n        --").concat(p[l-1],";\n        ").concat(d," sourceLocB = ").concat(d,"(").concat(p.join(),", 0);\n        --").concat(p[l-2],";")}else s=l,u="\n        ".concat(f," sourceLocR = coords;\n        ++").concat(p[l-1],";\n        ").concat(f," sourceLocG = coords;\n        ++").concat(p[l-2],";\n        ").concat(f," sourceLocA = coords;\n        --").concat(p[l-1],";\n        ").concat(f," sourceLocB = coords;\n        --").concat(p[l-2],";");var h=["x","y","z","w","u","v"].slice(0,s),m="."+h[s-1],v=h.map((function(e){return"int "+e})),g=Bf("sourceLocR",s-1).concat("inIdx.r"),y=Bf("sourceLocG",s-1).concat("inIdx.g"),x=Bf("sourceLocB",s-1).concat("inIdx.b"),b=Bf("sourceLocA",s-1).concat("inIdx.a"),w="max"===r?"greaterThan":"lessThan",k=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(g.join(),"),\n                             getBestIndicesAChannel(").concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),")));"),C="vec4(\n            getAChannel(".concat(g.join(),"),\n            hasNextCol ? getAChannel(").concat(y.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(x.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(b.join(),") : 0.)"),E=a?"":"\n      float getBestIndicesAChannel(".concat(v.join(),") {\n        return getChannel(getBestIndicesA(").concat(h.join(),"),\n                                          vec2(").concat(h.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(v.join(),") {\n        return getChannel(getA(").concat(h.join(),"),\n                               vec2(").concat(h.slice(-2).join(),"));\n      }\n      ").concat(E,"\n      void main() {\n        ").concat(f," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[l-1]," < ").concat(c[l-1]-1,";\n        bool hasNextRow = ").concat(p[l-2]," < ").concat(c[l-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(m,", sourceLocG").concat(m,",\n          sourceLocB").concat(m,", sourceLocA").concat(m,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(C,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(k,"\n          vec4 candidate = ").concat(C,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(w,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")})),op=A((function e(t){I(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,o=t.strideWidth,i=t.dilationHeight,u=t.dilationWidth,s=t.effectiveFilterHeight,c=t.effectiveFilterWidth,l=s-1-t.padInfo.top,f=c-1-t.padInfo.left,p=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(f,");\n      const float avgMultiplier = float(").concat(p,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(i,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(c,";\n            wC+= ").concat(u,") {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),ip=A((function e(t){I(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,o=t.strideDepth,i=t.strideHeight,u=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterDepth,p=t.effectiveFilterHeight,d=t.effectiveFilterWidth,h=f-1-t.padInfo.front,m=p-1-t.padInfo.top,v=d-1-t.padInfo.left,g=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(h,", ").concat(m,", ").concat(v,");\n      const float avgMultiplier = float(").concat(g,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(f,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(o,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(p,";\n              wR += ").concat(c,") {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(d,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),up=A((function e(t,n,r,a,o,i){I(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],Ko(t,n),Ko(t,r);var u="0.0";null!=a&&(Ko(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var s="1.0";null!=o&&(Ko(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(u,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(i,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")})),sp=A((function e(t,n,r,a,o,i){I(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Ko(t,n),Ko(t,r);var u="vec4(0.0)";null!=a&&(Ko(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=o&&(Ko(t,o),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(u,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(i,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")})),cp="return areal * breal - aimag * bimag;",lp="return areal * bimag + aimag * breal;",fp=A((function e(t,n,r){I(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Ko(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")})),pp="return a + b;",dp="return a - b;",hp="return a * b;",mp="return (a < 0.) ? b * a : a;",vp=A((function e(t,n,r){I(this,e),this.variableNames=["A","B"],this.outputShape=Ko(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")})),gp="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",yp=A((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];I(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Ko(n,r);var o=this.outputShape.length,i="";if(a)if(0===o||1===Qt(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var u=tp(o);if(i="\n          ".concat(u," coords = getOutputCoords();\n        "),1===o)i+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var s=Bf("coords",o);i+="\n            bool nextRowOutOfBounds =\n              (".concat(s[o-2]," + 1) >= ").concat(this.outputShape[o-2],";\n            bool nextColOutOfBounds =\n              (").concat(s[o-1]," + 1) >= ").concat(this.outputShape[o-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")})),xp=function(){function e(t){I(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return A(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),bp=function(){function e(t){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return A(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),wp=A((function e(t){I(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "})),kp=A((function e(t){I(this,e),this.outputShape=[],this.outputShape=Aa(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],o=1;o<n.length;o++){var i=n[o-1];a.push("else if (yC < ".concat(n[o],") ")+"setOutput(getT".concat(o,"(yR, yC-").concat(i,"));"))}var u=n.length,s=n[n.length-1];a.push("else setOutput(getT".concat(u,"(yR, yC-").concat(s,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")})),Cp=A((function e(t,n){I(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Aa(t,n);var r=this.outputShape,a=r.length,o=tp(a),i=Bf("coords",a),u=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var s=new Array(t.length-1);s[0]=t[0][n];for(var c=1;c<s.length;c++)s[c]=s[c-1]+t[c][n];for(var l=u[n],f=u.slice(-2),p=u.join(),d="if (".concat(l," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(f.join(),"));\n        }"),h=1;h<s.length;h++){var m=s[h-1];d+="\n        if (".concat(l," < ").concat(s[h],"  && ").concat(l," >= ").concat(s[h-1],") {\n          return getChannel(\n            getT").concat(h,"(").concat(Ep(u,l,m),"),\n            vec2(").concat(Ep(f,l,m),"));\n        }")}var v=s.length,g=s[s.length-1];d+="\n        return getChannel(\n          getT".concat(v,"(").concat(Ep(u,l,g),"),\n          vec2(").concat(Ep(f,l,g),"));"),this.userCode="\n      float getValue(".concat(u.map((function(e){return"int "+e})),") {\n        ").concat(d,"\n      }\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(i,"), 0., 0., 0.);\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," + 1;\n        if (").concat(i[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-2]," = ").concat(i[a-2]," + 1;\n        if (").concat(i[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(i,");\n        }\n\n        ").concat(i[a-1]," = ").concat(i[a-1]," - 1;\n        if (").concat(i[a-2]," < ").concat(r[a-2]," &&\n            ").concat(i[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(i,");\n        }\n        setOutput(result);\n      }\n    ")}));function Ep(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}var Sp=A((function e(t){I(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,o=t.padInfo.left,i="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(i,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Np=A((function e(t){I(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,o=t.strideWidth,i="channelsLast"===t.dataFormat,u=n-1-t.padInfo.top,s=r-1-t.padInfo.left,c=i?1:2,l=i?2:3,f=i?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(f,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(c,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(i,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Tp=A((function e(t){I(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,o=t.padInfo.front,i=t.padInfo.top,u=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(o,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(i,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(u,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Rp=A((function e(t){I(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,o=t.strideDepth,i=t.strideHeight,u=t.strideWidth,s=n-1-t.padInfo.front,c=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(c,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(o,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(i,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Ip=A((function e(t){I(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,o=t.padInfo.left,i=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(i," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(o,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),_p=A((function e(t){I(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,o=t.strideWidth,i=n-1-t.padInfo.top,u=r-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(i,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(o,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Ap=A((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];I(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,i=t.padInfo.left,u=t.strideHeight,s=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,d=4*Math.floor(t.inChannels/4),h=t.inChannels%4,m="channelsLast"===t.dataFormat,v=m?1:2,g=m?2:3,y=m?3:1,x="",b="";r&&(x=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),b="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(x,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(i,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(y,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(v,"], coords[").concat(g,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(f,"; wR++) {\n          int xR = xRCorner + wR * ").concat(c,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(d,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(m,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===h,") {\n\n              if (").concat(m,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(d,") *\n                    getW(wR, wC, ").concat(d,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(d,", xR, xC) *\n                    getW(wR, wC, ").concat(d,", d2);\n              }\n\n            } else if (").concat(2===h,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2)\n              );\n\n              if (").concat(m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===h,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(d,", d2),\n                getW(wR, wC, ").concat(d," + 1, d2),\n                getW(wR, wC, ").concat(d," + 2, d2)\n              );\n\n              if (").concat(m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(d,"),\n                  getX(batch, xR, xC, ").concat(d," + 1),\n                  getX(batch, xR, xC, ").concat(d," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(d,", xR, xC),\n                  getX(batch, ").concat(d," + 1, xR, xC),\n                  getX(batch, ").concat(d," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(b,"\n        setOutput(result);\n      }\n    ")})),Op=A((function e(t){I(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,o=t.strideDepth,i=t.strideHeight,u=t.strideWidth,s=t.dilationDepth,c=t.dilationHeight,l=t.dilationWidth,f=t.filterDepth,p=t.filterHeight,d=t.filterWidth,h=4*Math.floor(t.inChannels/4),m=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(o,", ").concat(i,", ").concat(u,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(f,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,"; wR++) {\n            int xR = xRCorner + wR * ").concat(c,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(d,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(h,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===m,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(h,") *\n                  getW(wF, wR, wC, ").concat(h,", d2);\n              } else if (").concat(2===m,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(h,"),\n                  getX(batch, xF, xR, xC, ").concat(h," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(h,", d2),\n                  getW(wF, wR, wC, ").concat(h," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===m,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(h,"),\n                  getX(batch, xF, xR, xC, ").concat(h," + 1),\n                  getX(batch, xF, xR, xC, ").concat(h," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(h,", d2),\n                  getW(wF, wR, wC, ").concat(h," + 1, d2),\n                  getW(wF, wR, wC, ").concat(h," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),Dp=A((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];I(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,i=t.inWidth,u=t.padInfo.top,s=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,f=t.dilationHeight,p=t.dilationWidth,d=t.filterHeight,h=t.filterWidth,m=t.outChannels/t.inChannels,v="",g="";r&&(v=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),g="result = activation(result);");var y=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(v,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(m,";\n        int q = d2 - d1 * ").concat(m,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(f,";\n\n          if (xR < 0 || xR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(h,"; wC++) {\n            int xC = xCCorner + wC * ").concat(p,";\n\n            if (xC < 0 || xC >= ").concat(i,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(y,"\n        ").concat(g,"\n        setOutput(result);\n      }\n    ")})),Fp=A((function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];I(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var o=t.inHeight,i=t.inWidth,u=t.padInfo.top,s=t.padInfo.left,c=t.strideHeight,l=t.strideWidth,f=t.dilationHeight,p=t.dilationWidth,d=t.filterHeight,h=t.filterWidth,m=h,v="int xR; int xC; int xCOffset;",g=0;g<d;g++)for(var y=0;y<h;y++)v+="\n          vec4 xTexelR".concat(g,"C").concat(2*y," = vec4(0.);\n          vec4 wR").concat(g,"C").concat(y," = vec4(0.);\n          vec4 xR").concat(g,"C").concat(y," = vec4(0.);");for(var x=0;x<d;x++)for(var b=0;b<m;b++){var w=2*b;if(v+="\n          xR = xRCorner + ".concat(x*f,";\n          xC = xCCorner + ").concat(w*p,";\n        "),1===l){if(w<h&&(v+=s%2===1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(o," && xCOffset >= 0 && xCOffset < ").concat(i,") {\n                  xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(i,") {\n                    xTexelR").concat(x,"C").concat(w,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(o," && xCOffset >= 0 && xCOffset < ").concat(i,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(i,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(x,"C").concat(w," = vec4(previous.zw, xTexelR").concat(x,"C").concat(w,".xy);\n                } else {\n                  xR").concat(x,"C").concat(w," = vec4(0, 0, xTexelR").concat(x,"C").concat(w,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(o," && xC >= 0 && xC < ").concat(i,") {\n                  xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(w," = xTexelR").concat(x,"C").concat(w,";\n              "),w+1<h)){var k=s%2===0?jt(p):p;p%2===0&&s%2===1||p%2!==0&&s%2!==1?(v+="\n                  xCOffset = xC + ".concat(s%2," + ").concat(k,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(i,") {\n                    xTexelR").concat(x,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),p>1&&(v+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(o," &&\n                      xCOffset >= 0 && xCOffset < ").concat(i,") {\n                      xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                    }\n                  ")),v+="\n                  xR".concat(x,"C").concat(w+1," = vec4(\n                    xTexelR").concat(x,"C").concat(w,".zw, xTexelR").concat(x,"C").concat(w+2,".xy);\n                ")):v+="\n                  xCOffset = xC + ".concat(k,";\n\n                  if(xR >= 0 && xR < ").concat(o," &&\n                    xCOffset >= 0 && xCOffset < ").concat(i,") {\n                    xTexelR").concat(x,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(x,"C").concat(w+1," = xTexelR").concat(x,"C").concat(w+2,";\n                ")}}else w<h&&(v+="\n              if(xR >= 0 && xR < ".concat(o,") {\n            "),s%2===1?(v+="\n                xCOffset = xC + 1 - ".concat(l,";\n                if(xCOffset >= 0 && xCOffset < ").concat(i,") {\n                  xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(i,") {\n                  xTexelR").concat(x,"C").concat(w+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w+2," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(w," = vec4(\n                  xTexelR").concat(x,"C").concat(w,".zw, xTexelR").concat(x,"C").concat(w+2,".zw);\n              "),w+1<h&&(v+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(l,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(i,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(x,"C").concat(w+1," = vec4(xTexelR").concat(x,"C").concat(w+2,".xy, final.xy);\n                "))):(v+="\n                if(xC >= 0 && xC < ".concat(i,") {\n                  xTexelR").concat(x,"C").concat(w," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(l,";\n                if(xCOffset >= 0 && xCOffset < ").concat(i,") {\n                  xTexelR").concat(x,"C").concat(w+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(x,"C").concat(w+2," = vec4(0.);\n                }\n\n                xR").concat(x,"C").concat(w," = vec4(\n                  xTexelR").concat(x,"C").concat(w,".xy, xTexelR").concat(x,"C").concat(w+2,".xy);\n              "),w+1<h&&(v+="\n                  xR".concat(x,"C").concat(w+1," = vec4(\n                    xTexelR").concat(x,"C").concat(w,".zw, xTexelR").concat(x,"C").concat(w+2,".zw);\n                "))),v+="}");w<h&&(v+="\n            vec4 wTexelR".concat(x,"C").concat(w," = getW(").concat(x,", ").concat(w,", d1, q);\n            wR").concat(x,"C").concat(w," = vec4(wTexelR").concat(x,"C").concat(w,".xz, wTexelR").concat(x,"C").concat(w,".xz);\n          "),w+1<h&&(v+="\n              vec4 wTexelR".concat(x,"C").concat(w+1," = getW(").concat(x,", ").concat(w+1,", d1, q);\n              wR").concat(x,"C").concat(w+1," =\n                vec4(wTexelR").concat(x,"C").concat(w+1,".xz, wTexelR").concat(x,"C").concat(w+1,".xz);")))}for(var C=0;C<d;C++)for(var E=0;E<h;E++)v+="dotProd += xR".concat(C,"C").concat(E," * wR").concat(C,"C").concat(E,";");var S="",N="";r&&(S=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),N="result = activation(result);");var T=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(S,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(l,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(s,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(v,"\n\n        vec4 result = dotProd;\n        ").concat(T,"\n        ").concat(N,"\n        setOutput(result);\n      }\n    ")})),Pp=A((function e(t,n,r,a,o){I(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=E(t,4),u=i[0],s=i[1],c=i[2],l=i[3],f=E(n,1)[0],p=E(r,2),d=p[0],h=p[1];this.outputShape=[f,d,h,l];var m="bilinear"===a?1:0,v="".concat(s-1,".0"),g="".concat(c-1,".0"),y=E(d>1?["".concat((s-1)/(d-1)),"(y2-y1) * height_ratio","y1*".concat(v," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(v)],3),x=y[0],b=y[1],w=y[2],k=E(h>1?["".concat((c-1)/(h-1)),"(x2-x1) * width_ratio","x1*".concat(g," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(g)],3),C=k[0],S=k[1],N=k[2];this.userCode="\n      const float height_ratio = float(".concat(x,");\n      const float width_ratio = float(").concat(C,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(u,") {\n          return;\n        }\n\n        float height_scale = ").concat(b,";\n        float width_scale = ").concat(S,";\n\n        float in_y = ").concat(w,";\n        if( in_y < 0.0 || in_y > ").concat(v," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n        float in_x = ").concat(N,";\n        if( in_x < 0.0 || in_x > ").concat(g," ) {\n          setOutput(float(").concat(o,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(m," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")})),Lp=function(){function e(t,n,r){I(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,o=n?"0.0":"getX(".concat(Mp(a,"coords"),")"),i=t[t.length-1],u="",s="";n?(u=r?"end != ".concat(i-1):"end != 0",s=r?"end + 1":"end - 1"):(u=r?"end + pow2 < ".concat(i):"end >= pow2",s=r?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(tp(a)," coords = getOutputCoords();\n        int end = ").concat(Bp(a,"coords"),";\n        float val = ").concat(o,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(u,") {\n          int idx = ").concat(s,";\n          ").concat(Bp(a,"coords")," = idx;\n          val += getX(").concat(Mp(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}return A(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.index&&(t.index=n.getUniformLocation(r,"index")),n.gl.uniform1f(t.index,e)}}}]),e}();function Mp(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}function Bp(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}var zp=A((function e(t){I(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ql.DENSE;var n=rf(t),r=zf();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(Vf(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")})),Vp=A((function e(t){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ql.DENSE;var n=rf(t),r=zf();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(Vf(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")})),Up=function(){function e(t,n,r){I(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return A(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}(),Wp=A((function e(t){I(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "})),Gp=A((function e(t){I(this,e),this.variableNames=["A"],this.outTexUsage=$l.DOWNLOAD;var n=zf();this.outputShape=t,this.userCode="\n      ".concat(Wf,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),jp=A((function e(t){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=$l.DOWNLOAD;var n=zf();this.outputShape=t,this.userCode="\n      ".concat(Wf,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")})),Hp=A((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];I(this,e),this.variableNames=["A"];var a=zf(),o=E(n,2),i=o[0],u=o[1];this.outputShape=t;var s="result";r&&(s="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(Uf(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(u,";\n        int c = imod(flatIndex, ").concat(u,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(u,".0, ").concat(i,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(s,", 0., 0., 0.);\n      }\n    ")})),Kp=A((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];I(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=zf(),o=E(n,2),i=o[0],u=o[1];this.outputShape=t;var s="",c="result";r&&(c="floor(result * 255. + 0.5)");for(var l=0;l<=1;l++)for(var f=0;f<=1;f++){var p=2*l+f;s+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(f," < ").concat(t[2],") {\n            localCoords[2] += ").concat(f,";\n            if(localCoords[1] + ").concat(l," < ").concat(t[1],") {\n              localCoords[1] += ").concat(l,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(u,";\n              c = imod(flatIndex, ").concat(u,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(u,".0, ").concat(i,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(p,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(p,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(p,"] = values[2];\n              } else {\n                result[").concat(p,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(Uf(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(s,"\n\n        ").concat(a.output," = ").concat(c,";\n      }\n    ")})),qp="return real * expR - imag * expI;",Xp="return real * expI + imag * expR;",Yp=A((function e(t,n,r){I(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),i=r?"".concat(a,".0"):"1.0";this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(t,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(i,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")})),Qp=function(){function e(t,n){I(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return A(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),$p=A((function e(t,n,r){I(this,e),this.variableNames=["A","indices"];var a=t.slice();a[r]=n,this.outputShape=a,this.rank=a.length;var o=tp(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank ".concat(n," is not yet supported"));if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],o=0;o<e.length;o++)o===t?a.push("int(getIndices(".concat(r[o],"))")):a.push("".concat(r[o]));return a.join()}(t,r);this.userCode="\n      void main() {\n        ".concat(o," resRC = getOutputCoords();\n        setOutput(getA(").concat(i,"));\n      }\n    ")}));var Jp=A((function e(t,n,r){I(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=tp(n.length),o=tp(r.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(o," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(i,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")}));function Zp(e){var t=zf();return function(e,t){var n=kf(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(uf(e,(function(){return e.shaderSource(n,t)})),uf(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function ed(e){return function(e,t){var n=kf(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return uf(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),uf(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function td(e){return function(e,t){var n=kf(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return uf(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),uf(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function nd(e,t,n,r,a,o){!function(e,t){var n=P().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),o="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+o+".")}}(t,n);var i=function(e){return kf(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),u=e.TEXTURE_2D;return uf(e,(function(){return e.bindTexture(u,i)})),uf(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),uf(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),uf(e,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),uf(e,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),uf(e,(function(){return e.texImage2D(u,0,r,t,n,0,a,o,null)})),uf(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),i}function rd(e){return e.internalFormatFloat}function ad(e){return e.internalFormatHalfFloat}function od(e){return e.downloadTextureFormat}function id(e){return e.internalFormatPackedFloat}function ud(e){return e.internalFormatPackedHalfFloat}function sd(e,t,n,r,a,o,i,u){var s=e,c=new Float32Array(function(e,t){var n=E(af(e,t),2);return n[0]*n[1]*4}(o,i));return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,c),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),c}var cd=function(){function e(t){I(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=P().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){Zl[e]=t}(n,t)):this.gl=tf(n);var r="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(1===P().getNumber("WEBGL_VERSION")){var o="OES_texture_half_float";if(this.textureFloatExtension=cf(this.gl,"OES_texture_float"),If(this.gl,o))this.textureHalfFloatExtension=cf(this.gl,o);else if(P().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),If(this.gl,a))this.colorBufferHalfFloatExtension=cf(this.gl,a);else if(P().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",If(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!If(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=ed(this.gl),this.indexBuffer=td(this.gl),this.framebuffer=function(e){return kf(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=of(this.gl,this.textureHalfFloatExtension)}return A(e,[{key:"debug",get:function(){return P().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;uf(t,(function(){return t.finish()})),uf(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),uf(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),uf(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),uf(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),uf(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(nf(t,n),2);return nd(e,a[0],a[1],rd(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(nf(t,n),2);return nd(e,a[0],a[1],ad(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(nf(t,n),2);return nd(e,a[0],a[1],od(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){uf(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?uf(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):uf(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),uf(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,o){var i,u,s;uf(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(i=new Uint8Array(n*r*4),u=e.UNSIGNED_BYTE,s=e.RGBA):(i=new Float32Array(n*r*4),u=e.FLOAT,s=o.internalFormatPackedFloat),i.set(a),uf(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,s,n,r,0,e.RGBA,u,i)})),uf(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(af(t,n),2);return nd(e,a[0],a[1],ud(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=E(af(t,n),2);return nd(e,a[0],a[1],id(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(bf(this.gl,this.framebuffer),this.outputTexture=null),uf(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=E(nf(t,n),2),o=a[0],i=a[1],u=new Uint8Array(t*n*4);return uf(e,(function(){return e.readPixels(0,0,o,i,r.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,o){return sd(this.gl,e,0,0,0,a,o,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();uf(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var o=16*t*n;return uf(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)})),uf(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),uf(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(P().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,o=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(o,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=o}else P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return uf(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){this.throwIfDisposed();var t=this.gl,n=lf(t,e),r=Zp(t),a=function(e){return kf(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(t);return uf(t,(function(){return t.attachShader(a,r)})),uf(t,(function(){return t.attachShader(a,n)})),function(e,t){if(uf(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,a),this.debug&&hf(t,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(e,t,n){return uf(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),mf(e,t,"clipSpacePos",n,3,20,0)&&mf(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&uf(this.gl,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&hf(this.gl,this.program),uf(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?vf(this.gl,e,t):gf(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),uf(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),yf(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=E(af(t,n),2),a=r[0],o=r[1];this.setOutputMatrixTextureDriver(e,a,o)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&hf(this.gl,this.program),wf(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),uf(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),uf(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=cf(this.gl,2===P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=w(N().mark((function e(t){var n=this;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,tn((function(){return n.disposed||n.isQueryAvailable(t,P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var o=this.getQueryTimerExtensionWebGL1(),i=o.getQueryObjectEXT(e,o.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(o.GPU_DISJOINT_EXT)),i&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||tn((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),xf(this.gl,e,this.framebuffer),this.debug&&wf(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(xf(this.gl,this.outputTexture,this.framebuffer),this.debug&&wf(this.gl)):bf(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;xf(r,e,this.framebuffer),this.debug&&wf(r),this.outputTexture=e,uf(r,(function(){return r.viewport(0,0,t,n)})),uf(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),uf(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();function ld(e,t,n,r){var a=t.userCode,o=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),i=o.map((function(e){return e.shapeInfo})),u={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=jf(o,u,a,t.packedInputs),c=e.createProgram(s),l=null,f=e.getUniformLocation(c,"NAN",!1);1===P().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(c,"INFINITY",!1));for(var p={},d=0;d<t.variableNames.length;d++){var h=t.variableNames[d];p[h]=e.getUniformLocation(c,h,false),p["offset".concat(h)]=e.getUniformLocation(c,"offset".concat(h),false)}return{program:t,source:s,webGLProgram:c,uniformLocations:p,inShapeInfos:i,outShapeInfo:u,infLoc:l,nanLoc:f}}function fd(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],o=a.shape;if(!$t(r,o))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(o," must match"));if(!e.isUniform||!a.isUniform){var i=e.texShape,u=a.isUniform?null:a.texData.texShape;if(!$t(i,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(i," and ").concat(u," must match"))}}))}function pd(e,t,n,r,a){fd(t.inShapeInfos,n),fd([t.outShapeInfo],[r]);var o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(o,i[0],i[1]):e.setOutputMatrixTexture(o,i[0],i[1]),e.setProgram(t.webGLProgram),1===P().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],o=t.uniformLocations[a],i=t.uniformLocations["offset".concat(a)];if(null!=o)if(n.isUniform)if(Qt(n.shape)<2)e.gl.uniform1f(o,n.uniformValues[0]);else{var u=n.uniformValues;u instanceof Float32Array||(u=new Float32Array(u)),e.gl.uniform1fv(o,u)}else null!=n.texData.slice&&null!=i&&e.gl.uniform1i(i,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,o,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}function dd(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(n,"_").concat(t)}));var a=e.userCode,o=e.constructor.name;return o+="_"+r+"_"+a}var hd=A((function e(t,n,r){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,o=r.inChannels,i=r.strideWidth,u=r.strideHeight,s=r.padInfo,c=r.outWidth,l=r.dilationWidth,f=r.dilationHeight,p=r.dataFormat,d=s.left,h=s.top,m=o*a,v=zf(),g="channelsLast"===p,y=g?0:1,x=g?1:2,b="",w=0;w<=1;w++)for(var k=0;k<=1;k++)b+="\n          blockIndex = rc.y + ".concat(k,";\n          pos = rc.x + ").concat(w,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(c,")) * ").concat(u," - ").concat(h,";\n            d0 = offsetY + ").concat(f," * (pos / ").concat(m,");\n\n            if(d0 < ").concat(n[y]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(c,".) * ").concat(i,". - ").concat(d,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(m,".) / ").concat(o,".));\n\n              if(d1 < ").concat(n[x]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(o,".));\n\n                if (").concat(g,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*w+k,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*w+k,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(b,"\n\n        ").concat(v.output," = result;\n      }\n    ")})),md=A((function e(t,n,r,a,o){I(this,e),this.variableNames=["x"],this.outputShape=[];var i,u=n,s=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");i=.5===o?"inversesqrt(".concat(c,")"):1===o?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(u,"; j <= ").concat(u,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(s,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(i,";\n        setOutput(val);\n      }\n    ")})),vd=A((function e(t,n,r,a,o){I(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=o,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(o,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(o,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")})),gd=A((function e(t,n,r,a,o){I(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,u=n,s=t[3]-1;this.outputShape=t;var c="float(".concat(r,") + float(").concat(a,") * sum");i=.5===o?"inversesqrt(".concat(c,")"):1===o?"1.0/(".concat(c,")"):"exp(log(".concat(c,") * float(-").concat(o,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(u,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(u,"; j <= ").concat(u,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(s,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(i,";\n        setOutput(result);\n      }\n    ")})),yd=A((function e(t){I(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,o=t.effectiveFilterHeight,i=t.effectiveFilterWidth,u=o-1-t.padInfo.top,s=i-1-t.padInfo.left,c=o*i-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(o,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(i,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(c," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(i," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),xd=A((function e(t){I(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,o=t.dilationDepth,i=t.dilationHeight,u=t.dilationWidth,s=t.effectiveFilterDepth,c=t.effectiveFilterHeight,l=t.effectiveFilterWidth,f=s-1-t.padInfo.front,p=c-1-t.padInfo.top,d=l-1-t.padInfo.left,h=s*c*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(f,", ").concat(p,", ").concat(d,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(o,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(c,";\n              wR += ").concat(i,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(u,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(h," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(c," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")})),bd=A((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];I(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;var s=r?t[1]:t[2],c=Math.ceil(s/2),l=r?"i * 2, rc.y":"rc.y, i * 2",f=a?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],d=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],h="",m="";i&&(h=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(i,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(i,"\n        }"),m="result = activation(result);");var v=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(h,"\n\n      const float sharedDimension = ").concat(c,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(c,"; i++) {\n          vec4 a = getMatrixA(rc.x, ").concat(l,");\n          vec4 b = getMatrixB(rc.x, ").concat(f,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(d[0],");\n          result += (").concat(p[1]," * ").concat(d[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(v,"\n\n        ").concat(m,"\n\n        setOutput(result);\n      }\n    ")})),wd=function(){function e(t,n,r){I(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return A(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}(),kd=A((function e(t,n,r,a){I(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")})),Cd=A((function e(t){I(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=Bf("rc",n),a=tp(n),o=function(e,t,n){if(1===e)return"rc > ".concat(t[0]);for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),i=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),u=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var o="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),i=2;i<e;i++)o="".concat(t[t.length-1-i],",")+o;n.push(o)}return n}(n,t);if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0");return"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(o,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(i,"\n\n            setOutput(vec4(").concat(u,"));\n          }\n        }\n      ")}}));var Ed=A((function e(t,n,r){I(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,o=tp(a),i=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(o," start = ").concat(o,"(").concat(i,");\n      ").concat(o," end = ").concat(o,"(").concat(u,");\n\n      void main() {\n        ").concat(o," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(").concat(r,"));\n        } else {\n          ").concat(o," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(i,";\n        int end = ").concat(u,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(").concat(r,"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")})),Sd=A((function e(t,n,r){I(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,o=tp(a),i=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),s=Bf("rc",a),c=Bf("source",a),l="".concat(s[a-1]," < ").concat(this.outputShape[a-1]),f=1===a?"source":"vec2(".concat(c.slice(-2).join(),")"),p=["".concat(o," rc = outputLoc;"),"".concat(s[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(s[a-2]," += 1;\n       if(").concat(s[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(s[a-1]," += 1;\n         if(").concat(l,") {")],d=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",h="",m=0,v=1===a?2:4;m<v;m++)h+="\n        ".concat(p[m],"\n        if (").concat(d,") {\n          result[").concat(m,"] = float(").concat(r,");\n        } else {\n          ").concat(o," source = rc - start;\n          result[").concat(m,"] = getChannel(getX(").concat(c.join(),"), ").concat(f,");\n        }\n      ");h+=1===a?"} ":"}}",this.userCode="\n      const ".concat(o," start = ").concat(o,"(").concat(i,");\n      const ").concat(o," end = ").concat(o,"(").concat(u,");\n\n      void main() {\n        ").concat(o," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(h,"\n        setOutput(result);\n      }\n    ")})),Nd=A((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(I(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var i=t.filterWidth,u=t.strideHeight,s=t.strideWidth,c=t.dilationHeight,l=t.dilationWidth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,d=t.padInfo.top,h=t.padInfo.left;this.outputShape=t.outShape;var m="avg"===n,v="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),g="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="0.0";if(m||(y="-1.0 / 1e-20"),r){var x=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(u,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(d,", ").concat(h,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(c,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(x," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?o?v:g:"wR * ".concat(p," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var b="max",w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / count");var k=4*Math.floor(i/4),C=i%4,E="\n      if (".concat(m,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(b,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(u,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(h,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(f,";\n            wR += ").concat(c,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(k,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(E,"\n          }\n\n          int xC = xCCorner + ").concat(k,";\n          if (").concat(1===C,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(E,"\n          } else if (").concat(2===C,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(E,"\n          } else if (").concat(3===C,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(E,"\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}})),Td=A((function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(I(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var i=t.filterWidth,u=t.strideDepth,s=t.strideHeight,c=t.strideWidth,l=t.dilationDepth,f=t.dilationHeight,p=t.dilationWidth,d=t.effectiveFilterDepth,h=t.effectiveFilterHeight,m=t.effectiveFilterWidth,v=t.padInfo.front,g=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var x="avg"===n,b="0.0";if(x||(b="-1.0 / 1e-20"),r){var w=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(u,", ").concat(s,", ").concat(c,");\n        const ivec3 pads = ivec3(").concat(v,", ").concat(g,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(d,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(h,";\n                wR += ").concat(f,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(m,";\n                  wC += ").concat(p,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(w," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?o?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(h," * ").concat(m," +\n                      wR * ").concat(m," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="max",C="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(C="avgValue / count");var E=4*Math.floor(i/4),S=i%4,N="\n      if (".concat(x,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(k,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(u,", ").concat(s,", ").concat(c,");\n      const ivec3 pads = ivec3(").concat(v,", ").concat(g,", ").concat(y,");\n      const float initializationValue = ").concat(b,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(b,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(h,";\n            wR += ").concat(f,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(E,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(p,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(p,", ch)\n              );\n\n              ").concat(N,"\n            }\n\n            int xC = xCCorner + ").concat(E,";\n            if (").concat(1===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(2===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(3===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                initializationValue\n              );\n\n              ").concat(N,"\n            }\n          }\n          setOutput(").concat(C,");\n        }\n      }\n    ")}})),Rd=A((function e(t,n){I(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,o=t.inSize,i=t.outSize;this.outputShape=[a,i];var u="0.0",s="";"prod"===n?u="1.0":"min"===n?(u="1.0 / 1e-20",s="min"):"max"===n&&(u="-1.0 / 1e-20",s="max");var c="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?c="sumValue":"prod"===n?c="prodValue":"all"===n?c="allValue":"any"===n&&(c="anyValue");var l=4*Math.floor(r/4),f=r%4,p="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n      }\n    "),d="vec4";"all"===n?(u="1.0",p="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",d="bvec4"):"any"===n&&(u="0.0",p="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",d="bvec4");var h="";o%r>0&&(h="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(u,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(h,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(u,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(p,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(2===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(3===f,") {\n          ").concat(d," values = ").concat(d,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(p,"\n        }\n        setOutput(").concat(c,");\n      }\n    ")})),Id=A((function e(t,n){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r="",a=0;a<4;a++){var o="thisRC = rc;";a%2===1&&(o+="thisRC.z += 1;"),a>1&&(o+="thisRC.y += 1;"),r+="\n        ".concat(o,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e){var t=Vf(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t,"\n      return ivec3(r, c, d);\n    }\n  ")}(n),"\n      ").concat(Uf(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")}));var _d=A((function e(t,n,r){I(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var a=E(n.shape,3),o=a[1],i=a[2],u=E(t.shape,3),s=u[1],c=u[2],l=[r&&s>1?o-1:o,r&&c>1?i-1:i],f=[r&&s>1?s-1:s,r&&c>1?c-1:c],p=l[0]/f[0],d=l[1]/f[1],h=1/p,m=1/d,v=2*Math.ceil(h)+2,g=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(v,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(o-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(i-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")})),Ad=A((function e(t,n,r,a){I(this,e),this.variableNames=["A"],this.outputShape=[];var o=E(t,4),i=o[0],u=o[1],s=o[2],c=o[3];this.outputShape=[i,n,r,c];var l=[a&&n>1?u-1:u,a&&r>1?s-1:s],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/f[0],",\n          ").concat(l[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")})),Od=A((function e(t,n,r,a){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=E(t,4),i=o[0],u=o[1],s=o[2],c=o[3];this.outputShape=[i,n,r,c];var l=[a&&n>1?u-1:u,a&&r>1?s-1:s],f=[a&&n>1?n-1:n,a&&r>1?r-1:r];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(l[0]/f[0],",\n          ").concat(l[1]/f[1],",\n          ").concat(l[1]/f[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(c-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")})),Dd=A((function e(t,n,r){I(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var a=E(n.shape,3),o=a[1],i=a[2],u=E(t.shape,3),s=u[1],c=u[2],l=[r&&s>1?o-1:o,r&&c>1?i-1:i],f=[r&&s>1?s-1:s,r&&c>1?c-1:c],p=l[0]/f[0],d=l[1]/f[1],h=1/p,m=1/d,v=2*Math.ceil(h)+2,g=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(d,");\n\n        const float invHeightScale = float(").concat(h,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(v,");\n        const int winWidth = int(").concat(g,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(c,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(l[0],") *\n                (float(dyR) / float(").concat(f[0],"));\n\n            float sourceFracCol =\n                float(").concat(l[1],") *\n                  (float(dyC) / float(").concat(f[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")})),Fd=A((function e(t,n,r,a){I(this,e),this.variableNames=["A"],this.outputShape=[];var o=E(t,4),i=o[0],u=o[1],s=o[2],c=o[3];this.outputShape=[i,n,r,c];var l=[a&&n>1?u-1:u,a&&r>1?s-1:s],f=[a&&n>1?n-1:n,a&&r>1?r-1:r],p=a?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(l[0]/f[0],",\n          ").concat(l[1]/f[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(p,")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")})),Pd=A((function e(t,n){I(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),o=tp(r);this.userCode="\n      void main() {\n        ".concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")})),Ld=A((function e(t,n){I(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=Bf("rc",r),o="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),i="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),u=tp(r);function s(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),o=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(o,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(o,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(u," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return s(e)}(a.slice()),";\n          if(").concat(o,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",s(e)}(a.slice()),";\n          }\n          if(").concat(i,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",s(e)}(a.slice()),";\n            if(").concat(o,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",s(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")})),Md=A((function e(t,n,r,a,o,i){I(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var u=tp(o.length),s=tp(i.length),c="";1===r?c="i":2===r&&(c="i, j");var l="getIndices(".concat(c,")"),f="";1===a?f="i":2===a&&(f="i, coords[1]");var p="getUpdates(".concat(f,")"),d=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(o,");\n\n        void main() {\n          ").concat(s," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(d,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(p,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")})),Bd=A((function e(t,n){I(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,o=t.inSize,i=t.numSegments,u=i*Math.ceil(o/r);this.outputShape=[a,u];var s=4*Math.floor(r/4),c=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",f="";o%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return initializationValue;\n        }\n      "));var p="";o%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(o,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(p,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(i,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(i,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===c,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")})),zd=A((function e(t,n,r){var a,o;if(I(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)o="resRC",a="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],s=[],c=0;c<n.length;c++)s.push("".concat(i[c])),c<t&&u.push("".concat(i[c]));a=u.join(),o=s.join()}var l=tp(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(o,"));\n        } else {\n          setOutput(getB(").concat(o,"));\n        }\n      }\n    ")})),Vd=function(){function e(t){I(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=tp(this.rank),a="uniform int start[".concat(this.rank,"];"),o=function(e){if(1===e)return"sourceLoc";if(e<=6)return Ud.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),i=t.map((function(e,t){return"sourceLoc.".concat(Ud[t]," = start[").concat(t,"] + coords.").concat(Ud[t],";")}));n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(i.join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(o,"));\n      }\n    ")}return A(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),Ud=["x","y","z","w","u","v"];var Wd=function(){function e(t){I(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=tp(this.rank),r=Bf("coords",this.rank),a=Bf("sourceLoc",this.rank),o=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),i="getChannel(getSource(".concat(a.join(),"), ").concat(o,")"),u="\n      result.x = ".concat(i,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(i,";\n        --").concat(a[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(i,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(i,";\n        }\n      }\n    "),c=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(c,"\n        vec4 result = vec4(0.);\n        ").concat(u,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}return A(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),Gd=A((function e(t,n,r){I(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,o=tp(r.length),i=tp(r.length),u="";if(1===a)u="coords * strides + begin";else{var s=0;u=r.map((function(e,t){return s++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(s-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(o," begin = ").concat(o,"(").concat(t,");\n      ").concat(o," strides = ").concat(o,"(").concat(n,");\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(u,"));\n      }\n    ")})),jd=function(){function e(t){I(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return A(e,[{key:"acquireTexture",value:function(e,t,n){var r=Kd(t,n),a=qd(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var o,i=Hd(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();var u=this.freeTextures[a].shift();return this.usedTextures[a].push(u),u}return r===Jl.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Jl.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Jl.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Jl.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Jl.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),o}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=Kd(n,r),o=qd(t,a,r);o in this.freeTextures||(this.freeTextures[o]=[]);var i=Hd(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),u=P().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==u&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=i):(this.freeTextures[o].push(e),this.numFreeTextures++,this._numBytesFree+=i),this.numUsedTextures--;var s=this.usedTextures[o],c=s.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(c,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function Hd(e,t,n,r,a){var o,i=function(e,t){switch(e){case Jl.PACKED_2X2_FLOAT32:return id(t);case Jl.PACKED_2X2_FLOAT16:return ud(t);case Jl.UNPACKED_FLOAT32:return rd(t);case Jl.UNPACKED_FLOAT16:return ad(t);case Jl.PACKED_4X1_UNSIGNED_BYTE:return od(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var u=E(af(e[0],e[1]),2);o=u[0]*u[1]}else{var s=E(nf(e[0],e[1]),2);o=s[0]*s[1]}var c=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(t))}(n,i);return o*c}function Kd(e,t){if(e===$l.UPLOAD)return Jl.PACKED_2X2_FLOAT32;if(e===$l.RENDER||null==e)return function(e){return P().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Jl.PACKED_2X2_FLOAT32:Jl.UNPACKED_FLOAT32:e?Jl.PACKED_2X2_FLOAT16:Jl.UNPACKED_FLOAT16}(t);if(e===$l.DOWNLOAD||e===$l.PIXELS)return Jl.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function qd(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var Xd=A((function e(t,n){I(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var o=tp(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(o," resRC = getOutputCoords();\n        setOutput(getA(").concat(i,"));\n      }\n    ")}));var Yd=A((function e(t,n){I(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),Qd="if (isnan(x)) return x;",$d="return x;",Jd="return abs(x);",Zd="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",eh="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",th="return (x >= 0.0) ? x : (exp(x) - 1.0);",nh="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(su,";\n  float scale = ").concat(cu,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");var rh="return -x;",ah="return ceil(x);",oh="return floor(x);",ih="return exp(x);",uh="return exp(x) - 1.0;",sh='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(.3275911,";\n  float a1 = ").concat(.254829592,";\n  float a2 = ").concat(-.284496736,";\n  float a3 = ").concat(1.421413741,";\n  float a4 = ").concat(-1.453152027,";\n  float a5 = ").concat(1.061405429,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),ch="return x;",lh="return x;",fh="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",ph="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",dh="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",hh=A((function e(t,n){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")})),mh=A((function e(t){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=Bf("rc",n),a=tp(n),o=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),i=r.slice(-2),u=n<=1?"rc":"vec2(".concat(i.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(o,");\n\n        setOutput(getChannel(packedInput, ").concat(u,"));\n      }\n    ")})),vh=e,gh=function(e,t,n){var r=new Array(e.rank).fill(0),a=e.shape.slice();return t.map((function(t){var o=R(a);o[n]=t;var i=eo(e,r,o);return r[n]+=t,i}))},yh=function(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=na(n,e.dtype),o=0;o<a.values.length;++o){for(var i=a.indexToLoc(o),u=new Array(e.rank),s=0;s<u.length;s++)u[s]=i[s]%e.shape[s];var c=e.locToIndex(u);a.values[o]=e.values[c]}return a.toTensor()},xh=function(e,t,n,r,a){for(var o=t[t.length-1],i=e.length/o,u=o,s=an(n,i*r),c=an("int32",i*r),l=0;l<i;l++){for(var f=l*u,p=e.subarray(f,f+u),d=[],h=0;h<p.length;h++)d.push({value:p[h],index:h});d.sort((function(e,t){return t.value-e.value}));for(var m=l*r,v=s.subarray(m,m+r),g=c.subarray(m,m+r),y=0;y<r;y++)v[y]=d[y].value,g[y]=d[y].index}var x=t.slice();return x[x.length-1]=r,[xr(s,x,n),xr(c,x,"int32")]},bh=gu,wh={};function kh(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?lh:$d;if("relu"===e)return t?fh:Zd;if("elu"===e)return t?dh:th;if("relu6"===e)return t?ph:eh;if("prelu"===e)return t?gp:mp;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var Ch=function(e){In(n,e);var t=Fn(n);function n(e){var r,a;if(I(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.warnedAboutCPUBackend=!1,r.pendingDeletes=0,r.disposed=!1,!P().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var o=tf(P().getNumber("WEBGL_VERSION"));r.binaryCache=((a=P().getNumber("WEBGL_VERSION"))in wh||(wh[a]={}),wh[a]),r.gpgpu=new cd(o),r.canvas=o.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new jd(r.gpgpu),r.numMBBeforeWarning=null==P().global.screen?1024:P().global.screen.height*P().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new yu(On(r),si()),r}return A(n,[{key:"numDataIds",value:function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}},{key:"write",value:function(e,t,n){if((P().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||P().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:$l.UPLOAD}),r}},{key:"move",value:function(e,t,n,r){if(P().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:$l.UPLOAD})}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensors,o=t.slice,i=t.shape,u=t.isPacked;if(null!=o){var s;s=u?new hh(i,ch):new Yd(i,ch);var c=this.runWebGLProgram(s,[{dataId:e,shape:i,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,p,d=null!=this.activeTimers;(d&&(f=xn()),"complex64"===r)?p=fu(a.real.dataSync(),a.imag.dataSync()):p=this.getValuesFromTexture(e);return d&&(this.downloadWaitMs+=xn()-f),this.convertAndCacheOnCPU(e,p)}},{key:"read",value:function(){var e=w(N().mark((function e(t){var n,r,a,o,i,u,s,c,l,f,p,d,h,m,v,g,y,x,b,w,k,C;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,o=r.shape,i=r.slice,u=r.dtype,s=r.complexTensors,c=r.isPacked,null==i){e.next=11;break}return l=c?new hh(o,ch):new Yd(o,ch),f=this.runWebGLProgram(l,[{dataId:t,shape:o,dtype:u}],u),p=this.read(f.dataId),this.disposeData(f.dataId),e.abrupt("return",p);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(P().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==P().getNumber("WEBGL_VERSION")){e.next=15;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 15:if(d=null,"complex64"!==u&&P().get("WEBGL_BUFFER_SUPPORTED")&&(h=this.decode(t),v=this.texData.get(h.dataId),d=(m=this.gpgpu).createBufferFromTexture.apply(m,[v.texture].concat(R(rf(o))))),this.pendingRead.set(t,[]),"complex64"===u){e.next=21;break}return e.next=21,this.gpgpu.createAndWaitForFence();case 21:if("complex64"!==u){e.next=30;break}return e.next=24,Promise.all([s.real.data(),s.imag.data()]);case 24:y=e.sent,x=y[0],b=y[1],g=fu(x,b),e.next=31;break;case 30:null==d?g=this.getValuesFromTexture(t):(w=Qt(o),g=this.gpgpu.downloadFloat32MatrixFromBuffer(d,w));case 31:return null!=h&&this.disposeData(h.dataId),k=this.convertAndCacheOnCPU(t,g),C=this.pendingRead.get(t),this.pendingRead.delete(t),C.forEach((function(e){return e(k)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t),this.pendingDeletes--),e.abrupt("return",k);case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!sf(n)){if(P().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,o=Qt(n);if(P().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var i,u=this.decode(e),s=this.texData.get(u.dataId),c=(i=this.gpgpu).downloadMatrixFromPackedTexture.apply(i,[s.texture].concat(R(rf(n)))).subarray(0,o);return this.disposeData(u.dataId),c}var l=P().getBool("WEBGL_PACK")&&!0===a,f=l?Nf(n):n,p=l?new jp(f):new Gp(f),d=this.runWebGLProgram(p,[{shape:f,dtype:r,dataId:e}],"float32"),h=this.texData.get(d.dataId),m=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture,h.texShape[0],h.texShape[1]).subarray(0,o);return this.disposeData(d.dataId),m}},{key:"time",value:function(){var e=w(N().mark((function e(t){var n,r,a,o,i,u,s;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeTimers,r=[],a=!1,null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,t(),o=Yt(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),i=Yt(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,a&&(this.programTimersStack=null),u={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=19;break}return e.next=14,Promise.all(o);case 14:s=e.sent,u.kernelMs=Ht(s),u.getExtraProfileInfo=function(){return s.map((function(e,t){return{name:i[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=20;break;case 19:u.kernelMs={error:"WebGL query timers are not supported in this environment."};case 20:return this.uploadWaitMs=0,this.downloadWaitMs=0,e.abrupt("return",u);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:xn(),endMs:null}}},{key:"endTimer",value:function(e){return P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=xn(),e)}},{key:"getQueryTime",value:function(){var e=w(N().mark((function e(t){var n;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(P().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,o=t.usage,i=t.isPacked,u=t.slice,s=u&&u.origDataId||e,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,o,i)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"getCPUBackend",value:function(){return P().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=si().findBackend("cpu")),this.cpuBackend):null}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128,r=this.getCPUBackend();return this.warnedAboutCPUBackend||null!=r||P().getBool("IS_TEST")||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=r&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&Qt(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"complex",value:function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:si().keep(e.clone()),imag:si().keep(t.clone())},n}},{key:"real",value:function(e){return this.texData.get(e.dataId).complexTensors.real.clone()}},{key:"imag",value:function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()}},{key:"slice",value:function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===Qt(n))return xr([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,a=function(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var o=r+1;o<n.length;o++)if(t[o]>0||n[o]!==e[o])return!1;return!0}(e.shape,t,n);if(r||!a){var o=P().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wd(n):new Vd(n),i=o.getCustomSetupFunc(t);return this.compileAndRun(o,[e],null,i)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)}},{key:"shallowSlice",value:function(e,t,n){var r=this.texData.get(e.dataId),a=this.makeOutput(n,e.dtype),o=this.texData.get(a.dataId);Object.assign(o,r),o.shape=n,o.dtype=e.dtype;var i=function(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}(t,e.strides);r.slice&&(i+=r.slice.flatOffset),o.slice={flatOffset:i,origDataId:r.slice&&r.slice.origDataId||e.dataId};var u=this.dataRefCount.get(o.slice.origDataId)||1;return this.dataRefCount.set(o.slice.origDataId,u+1),a}},{key:"stridedSlice",value:function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var a=wa(t,n,r);if(a.some((function(e){return 0===e})))return xr([],a);var o=new Gd(t,r,a);return this.compileAndRun(o,[e])}},{key:"reverse",value:function(e,t){var n=P().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ld(e.shape,t):new Pd(e.shape,t);return this.compileAndRun(n,[e])}},{key:"concat",value:function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return $a(e)})),r=e.map((function(e){return La(e)}));return gr(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>P().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(e.length/2),o=this.concat(e.slice(0,a),t),i=this.concat(e.slice(a),t);return this.concat([o,i],t)}if(P().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var u=new Cp(e.map((function(e){return e.shape})),t);return this.compileAndRun(u,e)}var s=Aa(e.map((function(e){return e.shape})),t),c=e.map((function(e){return e.as2D(-1,Qt(e.shape.slice(t)))})),l=new kp(c.map((function(e){return e.shape})));return this.compileAndRun(l,c).reshape(s)}},{key:"neg",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(P().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,rh,e.dtype);var t=new Yd(e.shape,rh);return this.compileAndRun(t,[e])}},{key:"batchMatMul",value:function(e,t,n,r){var a=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],i=n?e.shape[1]:e.shape[2],u=E(e.shape,2)[0];if((1===a||1===o)&&i>1e3){n&&(e=Ha(e,[0,2,1])),r&&(t=Ha(t,[0,2,1]));var s=1===o?e:e.as3D(u,i,1),c=1===o?2:1,l=1===o?t.as3D(u,1,i):t;return this.multiply(s,l).sum(c,!0)}var f=$n(e.dtype,t.dtype),p=new bd(e.shape,[u,a,o],n,r);return this.compileAndRun(p,[e,t],f)}},{key:"fusedBatchMatMul",value:function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,o=e.bias,i=e.activation,u=e.preluActivationWeights,s=r?t.shape[2]:t.shape[1],c=a?n.shape[1]:n.shape[2],l=E(t.shape,2)[0],f=$n(t.dtype,n.dtype),p=null!=o,d=null!=u,h=i?kh(i,!0):null,m=new bd(t.shape,[l,s,c],r,a,p,h,d),v=[t,n];return o&&v.push(o),u&&v.push(u),this.compileAndRun(m,v,f)}},{key:"multiply",value:function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),a=new fp(cp,e.shape,t.shape),o=new fp(lp,e.shape,t.shape),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],u=this.compileAndRun(a,i),s=this.compileAndRun(o,i),c=this.complex(u,s);return u.dispose(),s.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,hp,e.dtype);var l=new vp(hp,e.shape,t.shape);return this.compileAndRun(l,[e,t],e.dtype)}},{key:"batchNorm",value:function(e,t,n,r,a,o){var i=[e,t,n],u=null;null!=r&&(u=r.shape,i.push(r));var s=null;if(null!=a&&(s=a.shape,i.push(a)),P().getBool("WEBGL_PACK_NORMALIZATION")){var c=new sp(e.shape,t.shape,n.shape,u,s,o);return this.compileAndRun(c,i)}var l=new up(e.shape,t.shape,n.shape,u,s,o);return this.compileAndRun(l,i)}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){var o=P().getBool("WEBGL_PACK_NORMALIZATION")?new gd(e.shape,t,n,r,a):new md(e.shape,t,n,r,a);return this.compileAndRun(o,[e])}},{key:"LRNGrad",value:function(e,t,n,r,a,o,i){var u=new vd(t.shape,r,a,o,i);return this.compileAndRun(u,[t,n,e])}},{key:"tile",value:function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return wn(e)})),r=na(e.shape,e.dtype,n);return yh(r,t)}var a=new Xd(e.shape,t);return this.compileAndRun(a,[e])}},{key:"pad",value:function(e,t,n){var r=P().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Sd(e.shape,t,n):new Ed(e.shape,t,n);return this.compileAndRun(r,[e])}},{key:"gather",value:function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new $p(e.shape,t.size,n);return this.compileAndRun(r,[e,t])}},{key:"batchToSpaceND",value:function(e,t,n){Kt(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),a=ru(e.shape,t,r),o=au(a.length,t.length),i=ou(e.shape,t,r),u=function(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}(n,t.length),s=function(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}(i,n,t.length);return Ha(e.reshape(a),o).reshape(i).slice(u,s)}},{key:"spaceToBatchND",value:function(e,t,n){Kt(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),a=[[0,0]];a.push.apply(a,R(n));for(var o=1+t.length;o<e.shape.length;++o)a.push([0,0]);var i=e.pad(a),u=ru(i.shape,t,r,!1),s=au(u.length,t.length,!1),c=ou(i.shape,t,r,!1),l=Ha(i.reshape(u),s);return ja(l,c)}},{key:"reduce",value:function(e,t,n){var r=e.shape[0],a=e.shape[1],o=nu(a),i=Math.ceil(a/o),u=new Rd({windowSize:o,inSize:a,batchSize:r,outSize:i},t),s=this.compileAndRun(u,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)}},{key:"argReduce",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.shape[0],a=e.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var o=nu(a),i={windowSize:o,inSize:a,batchSize:r,outSize:Math.ceil(a/o)},u=new Lf(i,t,null==n),s=[e];null!=n&&s.push(n);var c=this.compileAndRun(u,s,"int32");return 1===c.shape[1]?c:this.argReduce(e,t,c)}},{key:"argReducePacked",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!=n?n.shape:e.shape,a=r[r.length-1],o=nu(a),i=new ap(r,o,t,null==n),u=null==n?[e]:[e,n],s=this.compileAndRun(i,u,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s}},{key:"sum",value:function(e,t){Va("sum",t,e.rank);var n=E(Ba(e.shape,t),2),r=n[0],a=Qt(n[1]),o=e.as2D(-1,a),i=Jn(e.dtype);return this.reduce(o,"sum",i).reshape(r)}},{key:"prod",value:function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=E(Ba(e.shape,t),2),r=n[0],a=Qt(n[1]),o=e.as2D(-1,a),i=Jn(e.dtype);return this.reduce(o,"prod",i).reshape(r)}},{key:"unsortedSegmentSum",value:function(e,t,n){var r=0,a=Ua([r],e.rank),o=e;null!=a&&(o=Ha(e,a),r=Ga(1,e.rank)[0]);var i=vh.computeOutShape(o.shape,r,n),u=Qt([o.shape[r]]),s=o.as2D(-1,u),c=Jn(e.dtype),l=this.segOpCompute(s,"unsortedSegmentSum",t,c,n).reshape(i);return null!=a&&(l=Ha(l,Wa(a))),l}},{key:"segOpCompute",value:function(e,t,n,r,a){var o=e.shape[0],i=e.shape[1],u=vh.segOpComputeOptimalWindowSize(i,a),s=new Bd({windowSize:u,inSize:i,batchSize:o,numSegments:a},t),c=this.compileAndRun(s,[e,n],r);return c.shape[1]===a?c:(n=Qa(0,a).tile([i/u]),this.segOpCompute(c,t,n,r,a))}},{key:"argMinMaxReduce",value:function(e,t,n){var r=[t];if(Va("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!P().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var a=E(Ba(e.shape,r),2),o=a[0],i=Qt(a[1]),u=e.as2D(-1,i);return this.argReduce(u,n).reshape(o)}return this.argReducePacked(e,n)}},{key:"argMin",value:function(e,t){return this.argMinMaxReduce(e,t,"min")}},{key:"argMax",value:function(e,t){return this.argMinMaxReduce(e,t,"max")}},{key:"cumsum",value:function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(e.rank-1," ")+"but got axis=".concat(t));for(var a=e.shape[t],o=e,i=0;i<=Math.ceil(Math.log2(a))-1;i++){var u=new Lp(e.shape,!1,r),s=u.getCustomSetupFunc(i),c=o;o=this.compileAndRun(u,[o],o.dtype,s),c.dispose()}if(n){var l=new Lp(e.shape,n,r),f=o;o=this.compileAndRun(l,[o]),f.dispose()}return o}},{key:"equal",value:function(e,t){if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new vp("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"notEqual",value:function(e,t){if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new vp("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"less",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new vp("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"lessEqual",value:function(e,t){if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new vp("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"greater",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new vp("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"greaterEqual",value:function(e,t){if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new vp("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"logicalNot",value:function(e){var t=new Yd(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])}},{key:"logicalAnd",value:function(e,t){if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new vp("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"logicalOr",value:function(e,t){if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new vp("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"select",value:function(e,t,n){var r=new zd(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],$n(t.dtype,n.dtype))}},{key:"where",value:function(e){lu("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return bh(e.shape,t)}},{key:"topk",value:function(e,t,n){var r=e.dataSync();return xh(r,e.shape,e.dtype,t,n)}},{key:"min",value:function(e,t){Va("min",t,e.rank);var n=E(Ba(e.shape,t),2),r=n[0],a=Qt(n[1]),o=e.as2D(-1,a);return this.reduce(o,"min",o.dtype).reshape(r)}},{key:"minimum",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=P().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yp("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new vp("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"mod",value:function(e,t){var n=P().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yp("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new vp("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"maximum",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=P().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yp("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new vp("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"all",value:function(e,t){Va("all",t,e.rank);var n=E(Ba(e.shape,t),2),r=n[0],a=Qt(n[1]),o=e.as2D(-1,a);return this.reduce(o,"all",o.dtype).reshape(r)}},{key:"any",value:function(e,t){Va("any",t,e.rank);var n=E(Ba(e.shape,t),2),r=n[0],a=Qt(n[1]),o=e.as2D(-1,a);return this.reduce(o,"any",o.dtype).reshape(r)}},{key:"floorDiv",value:function(e,t){var n="int32";if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",n);var r=new vp("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(r,[e,t],n)}},{key:"add",value:function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,pp);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=$n(e.dtype,t.dtype);if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,pp,n);var r=new vp(pp,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new hh(e.shape,t);return this.compileAndRun(r,[e],n)}},{key:"packedBinaryOp",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=new yp(n,e.shape,t.shape,a);return this.compileAndRun(o,[e,t],r)}},{key:"complexSeparableBinaryOp",value:function(e,t,n){var r=this,a=this.texData.get(e.dataId),o=this.texData.get(t.dataId),i=[[a.complexTensors.real,o.complexTensors.real],[a.complexTensors.imag,o.complexTensors.imag]].map((function(a){var o=E(a,2),i=o[0],u=o[1],s=r.makeComplexComponentTensorInfo(e,i),c=r.makeComplexComponentTensorInfo(t,u),l=new vp(n,e.shape,t.shape);return r.compileAndRun(l,[s,c],$n(i.dtype,u.dtype))})),u=E(i,2),s=u[0],c=u[1],l=this.complex(s,c);return s.dispose(),c.dispose(),l}},{key:"makeComplexComponentTensorInfo",value:function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}},{key:"addN",value:function(e){if(1===e.length)return e[0];if(e.length>P().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var a=e.map((function(e){return e.dtype})).reduce((function(e,t){return $n(e,t)})),o=e.map((function(e){return e.shape})),i=P().getBool("WEBGL_PACK")?new Pf(e[0].shape,o):new Ff(e[0].shape,o);return this.compileAndRun(i,e,a)}},{key:"subtract",value:function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,dp);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=$n(e.dtype,t.dtype);if(P().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,dp,e.dtype);var r=new vp(dp,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)}},{key:"pow",value:function(e,t){var n=P().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yp("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new vp("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=$n(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)}},{key:"ceil",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(P().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ah,e.dtype);var t=new Yd(e.shape,ah);return this.compileAndRun(t,[e])}},{key:"floor",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(P().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,oh,e.dtype);var t=new Yd(e.shape,oh);return this.compileAndRun(t,[e])}},{key:"sign",value:function(e){var t=new Yd(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])}},{key:"isNaN",value:function(e){var t=new Yd(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")}},{key:"isInf",value:function(e){var t=new Yd(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")}},{key:"isFinite",value:function(e){var t=new Yd(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")}},{key:"round",value:function(e){var t=new Yd(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])}},{key:"exp",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(P().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ih,e.dtype);var t=new Yd(e.shape,ih);return this.compileAndRun(t,[e])}},{key:"expm1",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(P().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,uh,e.dtype);var t=new Yd(e.shape,uh);return this.compileAndRun(t,[e])}},{key:"softmax",value:function(e,t){var n=nn([t],e.shape),r=Ka(e,n),a=za(r.shape,n),o=this.subtract(e,r.reshape(a)),i=this.exp(o),u=this.sum(i,n).reshape(a);return Pa(i,u)}},{key:"log",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(P().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new Yd(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])}},{key:"log1p",value:function(e){var t=new Yd(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])}},{key:"sqrt",value:function(e){var t=new Yd(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])}},{key:"rsqrt",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new Yd(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])}},{key:"reciprocal",value:function(e){var t=new Yd(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])}},{key:"relu",value:function(e){var t;return t=P().getBool("WEBGL_PACK")?new hh(e.shape,fh):new Yd(e.shape,Zd),this.compileAndRun(t,[e])}},{key:"relu6",value:function(e){var t;return t=P().getBool("WEBGL_PACK")?new hh(e.shape,ph):new Yd(e.shape,eh),this.compileAndRun(t,[e])}},{key:"prelu",value:function(e,t){var n=P().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yp(gp,e.shape,t.shape):new vp(mp,e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"elu",value:function(e){if(P().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,dh,e.dtype);var t=new Yd(e.shape,th);return this.compileAndRun(t,[e])}},{key:"eluDer",value:function(e,t){var n=P().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yp("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new vp("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"selu",value:function(e){var t=new Yd(e.shape,nh);return this.compileAndRun(t,[e])}},{key:"int",value:function(e){var t=new Yd(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")}},{key:"clip",value:function(e,t,n){var r,a=(r=P().getBool("WEBGL_PACK_CLIP")?new bp(e.shape):new xp(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(P().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Jd,e.dtype);var t=new Yd(e.shape,Jd);return this.compileAndRun(t,[e])}},{key:"complexAbs",value:function(e){var t=this.texData.get(e.dataId),n=new wp(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)}},{key:"sigmoid",value:function(e){var t=new Yd(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])}},{key:"softplus",value:function(e){var t=new Yd(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])}},{key:"sin",value:function(e){var t=new Yd(e.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(t,[e])}},{key:"cos",value:function(e){var t=new Yd(e.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(t,[e])}},{key:"tan",value:function(e){var t=new Yd(e.shape,"return tan(x);");return this.compileAndRun(t,[e])}},{key:"asin",value:function(e){var t=new Yd(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(t,[e])}},{key:"acos",value:function(e){var t=new Yd(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(t,[e])}},{key:"atan",value:function(e){var t=new Yd(e.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(t,[e])}},{key:"atan2",value:function(e,t){var n=P().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yp("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new vp("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"sinh",value:function(e){var t=new Yd(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])}},{key:"cosh",value:function(e){var t=new Yd(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])}},{key:"tanh",value:function(e){var t=new Yd(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])}},{key:"asinh",value:function(e){var t=new Yd(e.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(t,[e])}},{key:"acosh",value:function(e){var t=new Yd(e.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(t,[e])}},{key:"atanh",value:function(e){var t=new Yd(e.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(t,[e])}},{key:"erf",value:function(e){var t=new Yd(e.shape,sh);return this.compileAndRun(t,[e])}},{key:"step",value:function(e,t){var n=new Yd(e.shape,function(){return Qd+"\n    return x > 0.0 ? 1.0 : float(".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,");\n  ")}(t));return this.compileAndRun(n,[e])}},{key:"conv2dByMatMul",value:function(e,t,n,r,a,o){var i=e.shape,u=this.texData.get(e.dataId),s=n.inChannels,c=i[0]*i[1]*i[2],l=n.outChannels,f="channelsLast"===n.dataFormat,p=(1===c||1===l)&&s>1e3,d=i[2]%2!==0&&!!u.isPacked;if(p||!P().getBool("WEBGL_LAZILY_UNPACK")||!P().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!d){var h=f?i[0]*i[1]*i[2]:i[0]*i[2]*i[3],m=this.reshape(e,[1,h,n.inChannels]),v=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:m,b:v,transposeA:false,transposeB:false,bias:r,activation:a,preluActivationWeights:o}),n.outShape)}var g=f?i[0]*i[1]*(i[2]+1):i[0]*i[2]*(i[3]+1),y={dataId:e.dataId,shape:[1,g,n.inChannels],dtype:e.dtype},x=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,Kt(Rf(u.shape,y.shape),(function(){return"packed reshape ".concat(u.shape," to ").concat(y.shape," isn't free")}));var b=this.reshape(t,[1,n.inChannels,n.outChannels]),w=this.fusedBatchMatMul({a:y,b:b,transposeA:false,transposeB:false,bias:r,activation:a,preluActivationWeights:o}),k=this.texData.get(w.dataId);return Kt(k.isPacked,(function(){return"batchMatMul result is expected to be packed"})),u.shape=x,k.shape=n.outShape,si().makeTensorFromDataId(w.dataId,n.outShape,w.dtype)}},{key:"conv2dWithIm2Row",value:function(e,t,n,r,a,o){var i=n.filterWidth,u=n.filterHeight,s=n.inChannels,c=n.outWidth,l=n.outHeight,f="channelsLast"===n.dataFormat,p=i*u*s,d=l*c,h=[p,d],m=e.squeeze([0]),v=t.reshape([1,p,-1]),g=new hd(h,m.shape,n),y=this.compileAndRun(g,[m]).reshape([1,h[0],h[1]]),x=null!=r,b=null!=o,w=a?kh(a,!0):null,k=new bd(y.shape,[1,d,n.outChannels],!0,!1,x,w,b),C=[y,v];r&&C.push(r),b&&C.push(o);var E=this.compileAndRun(k,C);return f?E.reshape([1,l,c,n.outChannels]):E.reshape([1,n.outChannels,l,c])}},{key:"fusedConv2d",value:function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,o=e.activation,i=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,a,o,i);if(P().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,a,o,i);var u=null!=a,s=null!=i,c=o?kh(o,!1):null,l=new Ap(r,u,c,s),f=[t,n];return a&&f.push(a),i&&f.push(i),this.compileAndRun(l,f)}},{key:"conv2d",value:function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(P().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new Ap(n);return this.compileAndRun(r,[e,t])}},{key:"conv2dDerInput",value:function(e,t,n){var r=new Np(n);return this.compileAndRun(r,[e,t])}},{key:"conv2dDerFilter",value:function(e,t,n){var r=new Sp(n);return this.compileAndRun(r,[e,t])}},{key:"fusedDepthwiseConv2D",value:function(e){var t,n=e.input,r=e.filter,a=e.convInfo,o=e.bias,i=e.activation,u=e.preluActivationWeights,s=P().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels===1,c=i?kh(i,s):null,l=[n,r],f=null!=o,p=null!=u;return f&&l.push(o),p&&l.push(u),s?(t=new Fp(a,f,c,p),this.compileAndRun(t,l)):(t=new Dp(a,f,c,p),this.compileAndRun(t,l))}},{key:"depthwiseConv2D",value:function(e,t,n){var r;return P().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels===1?(r=new Fp(n),this.compileAndRun(r,[e,t])):(r=new Dp(n),this.compileAndRun(r,[e,t]))}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){var r=new _p(n);return this.compileAndRun(r,[e,t])}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){var r=new Ip(n);return this.compileAndRun(r,[e,t])}},{key:"conv3d",value:function(e,t,n){var r=new Op(n);return this.compileAndRun(r,[e,t])}},{key:"conv3dDerInput",value:function(e,t,n){var r=new Rp(n);return this.compileAndRun(r,[e,t])}},{key:"conv3dDerFilter",value:function(e,t,n){var r=new Tp(n);return this.compileAndRun(r,[e,t])}},{key:"maxPool",value:function(e,t){var n=new Nd(t,"max",!1);return this.compileAndRun(n,[e])}},{key:"avgPool",value:function(e,t){var n=new Nd(t,"avg",!1);return this.compileAndRun(n,[e],"float32")}},{key:"maxPoolBackprop",value:function(e,t,n,r){var a=new Nd(r,"max",!0),o=this.compileAndRun(a,[t]),i=new yd(r),u=this.compileAndRun(i,[e,o],t.dtype);return o.dispose(),u}},{key:"avgPoolBackprop",value:function(e,t,n){var r=new op(n);return this.compileAndRun(r,[e],t.dtype)}},{key:"cast",value:function(e,t){return mu(e,t,this)}},{key:"unstack",value:function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,o=0;o<e.rank;o++)o!==t&&(r[a++]=e.shape[o]);var i=new Array(e.rank).fill(0),u=e.shape.slice();u[t]=1;for(var s=new Array(n),c=0;c<s.length;c++)i[t]=c,s[c]=this.slice(e,i,u).reshape(r);return s}},{key:"avgPool3d",value:function(e,t){var n=new Td(t,"avg",!1);return this.compileAndRun(n,[e],"float32")}},{key:"avgPool3dBackprop",value:function(e,t,n){var r=new ip(n);return this.compileAndRun(r,[e],t.dtype)}},{key:"maxPool3d",value:function(e,t){var n=new Td(t,"max",!1);return this.compileAndRun(n,[e],"float32")}},{key:"maxPool3dBackprop",value:function(e,t,n,r){var a=new Td(r,"max",!0),o=this.compileAndRun(a,[t]),i=new xd(r),u=this.compileAndRun(i,[e,o],t.dtype);return o.dispose(),u}},{key:"reshape",value:function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!Rf(e.shape,t)&&(null===n.texture||!Rf(n.shape,t))){var r=this.packedReshape(e,t);return si().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return vu(e,t)}},{key:"resizeBilinear",value:function(e,t,n,r){var a=P().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Od(e.shape,t,n,r):new Ad(e.shape,t,n,r);return this.compileAndRun(a,[e],"float32")}},{key:"resizeBilinearBackprop",value:function(e,t,n){var r=new _d(e,t,n);return this.compileAndRun(r,[e])}},{key:"resizeNearestNeighbor",value:function(e,t,n,r){var a=new Fd(e.shape,t,n,r);return this.compileAndRun(a,[e])}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){var r=new Dd(e,t,n);return this.compileAndRun(r,[e])}},{key:"multinomial",value:function(e,t,n,r){var a=t?e:to(e),o=a.shape[0],i=a.shape[1],u=new wd(o,i,n),s=u.getCustomSetupFunc(r);return this.compileAndRun(u,[a],"int32",s)}},{key:"oneHot",value:function(e,t,n,r){var a=new kd(e.size,t,n,r);return this.compileAndRun(a,[e])}},{key:"diag",value:function(e){var t=new Wp(e.size);return this.compileAndRun(t,[e])}},{key:"cropAndResize",value:function(e,t,n,r,a,o){var i=new Pp(e.shape,t.shape,r,a,o);return this.compileAndRun(i,[e,t,n],"float32")}},{key:"depthToSpace",value:function(e,t,n){Kt(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)}));var r=e.shape[0],a="NHWC"===n?e.shape[1]:e.shape[2],o="NHWC"===n?e.shape[2]:e.shape[3],i="NHWC"===n?e.shape[3]:e.shape[1],u=a*t,s=o*t,c=i/(t*t),l=new Up("NHWC"===n?[r,u,s,c]:[r,c,u,s],t,n);return this.compileAndRun(l,[e])}},{key:"split",value:function(e,t,n){return gh(e,t,n)}},{key:"scatterND",value:function(e,t,n){var r=uu(0,e,n),a=r.sliceRank,o=r.numUpdates,i=r.sliceSize,u=r.strides,s=r.outputSize,c=[s/i,i],l=e.reshape([o,a]),f=t.reshape([o,i]);if(0===s)return vu(xr([]),n);var p=Ja(0),d=new Md(o,a,l.rank,f.rank,u,c);return this.compileAndRun(d,[f,l,p]).reshape(n)}},{key:"sparseToDense",value:function(e,t,n,r){var a=uu(0,e,n),o=a.sliceRank,i=a.numUpdates,u=a.strides,s=a.outputSize,c=new Md(i,o,e.rank,t.rank,u,[s,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)}},{key:"fft",value:function(e){return this.fftImpl(e,!1)}},{key:"ifft",value:function(e){return this.fftImpl(e,!0)}},{key:"fftImpl",value:function(e,t){var n=this.texData.get(e.dataId),r=new Yp(qp,e.shape,t),a=new Yp(Xp,e.shape,t),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],i=this.compileAndRun(r,o),u=this.compileAndRun(a,o),s=this.complex(i,u).as2D(e.shape[0],e.shape[1]);return i.dispose(),u.dispose(),s}},{key:"gatherND",value:function(e,t){var n=t.shape,r=n[n.length-1],a=function(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[t.rank-1]," vs. ").concat(e.rank));if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var n=t.shape,r=n[n.length-1],a=1,o=0;o<n.length-1;++o)a*=n[o];var i=e.shape,u=n.slice();u.pop();for(var s=1,c=r;c<e.rank;++c)s*=i[c],u.push(i[c]);var l=[].concat(R(dn(e.shape).map((function(e){return e/s}))),[1]).slice(0,r);return[u,a,s,l]}(e,t),o=E(a,4),i=o[0],u=o[1],s=o[2],c=o[3],l=t.reshape([u,r]),f=e.reshape([e.size/s,s]),p=new Jp(r,c,[u,s]);return this.compileAndRun(p,[f,l]).reshape(i)}},{key:"fill",value:function(e,t,n){if("string"===(n=n||ln(t))){var r=on(n,Qt(e));return r.fill(t),si().makeTensor(r,e,n,this)}var a=new Qp(e,t),o=a.getCustomSetupFunc(t);return this.compileAndRun(a,[],n,o)}},{key:"onesLike",value:function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)}},{key:"zerosLike",value:function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)}},{key:"linspace",value:function(e,t,n){return function(e,t,n){var r=(t-e)/(n-1),a=yn(n,"float32");a[0]=e;for(var o=1;o<a.length;o++)a[o]=a[o-1]+r;return Xa(a,"float32")}(e,t,n)}},{key:"makeTensorInfo",value:function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t){var n=this.makeTensorInfo(e,t).dataId;return si().makeTensorFromDataId(n,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new mh(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new Cd(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[Ef(e.shape)].concat(R(Sf(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[Ef(t)].concat(R(Sf(t))),o=new Id(a,n),i=this.runWebGLProgram(o,[r],e.dtype,null,!0);return{dataId:i.dataId,shape:t,dtype:i.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,o=n.dtype,i=Nf(a);t=r?new Vp(i):new zp(i);return{dtype:o,shape:a,dataId:this.runWebGLProgram(t,[{shape:i,dtype:o,dataId:e}],o,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(i.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===Ql.DENSE){var s=rf(e.outputShape);u.texShape=s.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===Qt(i.shape))return u.values=an(i.dtype,0),i;var c=[],l=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=a.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&Qt(t.shape)<=P().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!==!!e.packedInputs)t=n.isPacked?a.unpackTensor(t):a.packTensor(t),c.push(t),n=a.texData.get(t.dataId);else if(n.isPacked&&!Rf(n.shape,t.shape)){var r=t,o=t.shape;t.shape=n.shape,t=a.packedReshape(t,o),c.push(t),n=a.texData.get(t.dataId),r.shape=o}return a.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(i.dataId);var f,p={shape:i.shape,texData:u,isUniform:!1},d=dd(e,l,p),h=this.getAndSaveBinary(d,(function(){return ld(a.gpgpu,e,l,p)})),m=null!=this.activeTimers;if(m&&(f=this.startTimer()),pd(this.gpgpu,h,l,p,r),c.forEach((function(e){return a.disposeData(e.dataId)})),m&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)})),!P().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===o){var v=this.unpackTensor(i);return this.disposeData(i.dataId),v}return i}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var o=this.runWebGLProgram(e,t,n,r,a);return si().makeTensorFromDataId(o.dataId,o.shape,o.dtype)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!P().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=ci((function(){if(!P().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=P().getBool("DEBUG");P().set("DEBUG",!1);var n=e.abs(Ja(1e-8)).dataSync()[0];if(P().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,o=t.texture,i=t.usage,u=t.isPacked;if(null==o){var s,c=null!=this.activeTimers;c&&(s=xn());var l=t.texShape;if(null==l&&(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=P().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?jt(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var r=rn(e);e=r.newShape}var a=Qt(e);if(e.length<=1&&a<=n)return[1,a];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var o=Ef(e),i=2,u=2;if(e.length){var s=E(Sf(e),2);i=s[0],u=s[1]}return Zt(a=o*(i/2)*(u/2)).map((function(e){return 2*e}))}return Zt(a)}(n,u),t.texShape=l),null!=a){var f,p=Nf(n),d=l[1],h=l[0],m=a instanceof Uint8Array;if(u){var v=E(af(l[0],l[1]),2);d=v[0],h=v[1],f=new Kp(p,[h,d],m)}else f=new Hp(p,[h,d],m);var g=this.makeTensorInfo([h,d],r);this.texData.get(g.dataId).usage=m?$l.PIXELS:$l.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(g.dataId),d,h,a);var y=this.runWebGLProgram(f,[g],r,null,!0),x=this.texData.get(y.dataId);t.texture=x.texture,t.texShape=x.texShape,t.isPacked=x.isPacked,t.usage=x.usage,this.disposeData(g.dataId),this.texData.delete(y.dataId),t.values=null,c&&(this.uploadWaitMs+=xn()-s)}else{var b=this.acquireTexture(l,i,r,u);t.texture=b}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*sn(t)}}]),n}(xu);cr()&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;ir.registerBackend(e,t,n)}("webgl",(function(){return new Ch}),2);var Eh,Sh={kernelName:ve,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return function(e,t,n){var r=new vp("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return P().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new yp("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",e.shape,t.shape,!0)),n.runWebGLProgram(r,[e,t],"float32")}(t.a,t.b,n)}},Nh=A((function e(t){I(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),Th={kernelName:ye,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,o=new Nh(r.shape);return a.runWebGLProgram(o,[r],r.dtype)}},Rh=A((function e(t){I(this,e),this.variableNames=["A"];var n=zf(),r=E(t,2),a=r[0],o=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(o,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")})),Ih=A((function e(t){I(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=zf(),r=E(t,2),a=r[0],o=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(o,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")})),_h={kernelName:_t,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,o=r.numChannels,i="undefined"!==typeof HTMLVideoElement&&a instanceof HTMLVideoElement,u="undefined"!==typeof HTMLImageElement&&a instanceof HTMLImageElement,s=E(i?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),c=s[0],l=s[1],f=[l,c],p=[l,c,o];(u||i)&&(null==Eh&&(Eh=document.createElement("canvas").getContext("2d")),Eh.canvas.width=c,Eh.canvas.height=l,Eh.drawImage(a,0,0,c,l),a=Eh.canvas);var d=n.makeTensorInfo(f,"int32");n.texData.get(d.dataId).usage=$l.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(d.dataId),a);var h=P().getBool("WEBGL_PACK")?new Ih(p):new Rh(p),m=n.runWebGLProgram(h,[d],"int32");return n.disposeData(d.dataId),m}};var Ah=function(e,t,n,r){for(var a=an(r,Qt(n)),o=0;o<a.length;++o){for(var i=o*t,u=e[i],s=0;s<t;++s){var c=e[i+s];c>u&&(u=c)}a[o]=u}return a},Oh=function(e,t,n,r,a){for(var o=t.length,i=Qt(t),u=dn(t),s=dn(a),c=an(n,Qt(a)),l=0;l<i;++l){for(var f=Cn(l,o,u),p=new Array(f.length),d=0;d<p.length;d++)p[d]=f[r[d]];c[kn(p,o,s)]=e[l]}return c};function Dh(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=nu(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),o=e,i=0;i<a.length;i++){var u=a[i],s=u.inSize,c=u.windowSize,l=u.outSize,f=new Rd({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l},n),p=o;o=r.runWebGLProgram(f,[o],t),p.dataId!==e.dataId&&r.disposeData(p.dataId)}return o}function Fh(e,t,n){var r=n.texData.get(e.dataId);return!r.isPacked||Rf(e.shape,t)||null!==r.texture&&Rf(r.shape,t)?{dataId:e.dataId,shape:t,dtype:e.dtype}:function(e,t,n){var r=[Ef(e.shape)].concat(R(Sf(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},o=[Ef(t)].concat(R(Sf(t))),i=new Id(o,r),u=n.runWebGLProgram(i,[a],e.dtype,null,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(e,t,n)}var Ph=A((function e(t,n){I(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var o=tp(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(o," resRC = getOutputCoords();\n      setOutput(getA(").concat(i,"));\n    }\n    ")}));var Lh=A((function e(t,n){I(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var o=tp(this.rank),i=Mf("rc",this.rank),u=new Array(this.rank),s=0;s<n.length;s++)u[n[s]]=i[s];var c="vec2(".concat(u.slice(-2).join(),")"),l="++".concat(i[this.rank-1]," < ").concat(r[this.rank-1]),f="getChannel(getA(".concat(u.join(),"), ").concat(c,")");this.userCode="\n    void main() {\n      ".concat(o," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(f,";\n      if(").concat(l,") {\n        result[1] = ").concat(f,";\n      }\n      --").concat(i[this.rank-1],";\n      if(++").concat(i[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(f,";\n        if(").concat(l,") {\n          result[3] = ").concat(f,";\n        }\n      }\n      setOutput(result);\n    }\n    ")}));function Mh(e,t,n){var r=P().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Lh(e.shape,t):new Ph(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}var Bh={kernelName:Oe,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,o=n.reductionIndices,i=n.keepDims,u=r,s=a.shape.length,c=nn(o,a.shape),l=c,f=Ua(l,s),p=null!=f,d=u.shouldExecuteOnCPU([a]),h=a;if(p){if(d){for(var m=u.texData.get(h.dataId).values,v=new Array(s),g=0;g<v.length;g++)v[g]=a.shape[f[g]];var y=Oh(m,a.shape,a.dtype,f,v);h=u.makeTensorInfo(v,a.dtype),u.texData.get(h.dataId).values=y}else h=Mh(a,f,u);l=Ga(l.length,s)}Va("max",l,s);var x,b=E(Ba(h.shape,l),2),w=b[0],k=b[1],C=w;if(i&&(C=za(w,c)),d){var S=u.texData.get(h.dataId).values,N=Ah(S,Qt(k),C,a.dtype);x=u.makeTensorInfo(C,a.dtype),u.texData.get(x.dataId).values=N}else x=function(e,t,n,r){var a=Qt(t),o=Fh(e,[Qt(e.shape)/a,a],r),i=Dh(o,e.dtype,"max",r);return o.dataId!==e.dataId&&r.disposeData(o.dataId),Fh(i,n,r)}(h,k,C,u);return p&&u.disposeData(h.dataId),x}};for(var zh,Vh,Uh={kernelName:Me,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,o=n.filterSize,i=n.strides,u=n.pad,s=n.includeBatchInIndex,c=r;Kt(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var l=[1,1];Kt(Ki(i,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(i," and dilations '").concat(l,"'")}));var f=Fi(a.shape,o,i,l,u),p=function(e,t,n,r){var a=new Nd(n,"max",!1),o=r.runWebGLProgram(a,[e],"float32");return a=new Nd(n,"max",!0,!0,t),[o,r.runWebGLProgram(a,[e],"float32")]}(a,s,f,c),d=E(p,2);return[d[0],d[1]]}},Wh={kernelName:We,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;lu("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t.boxes,o=t.scores,i=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=n;return Ro(c.readSync(a.dataId),c.readSync(o.dataId),i,u,s)}},Gh=Io,jh={kernelName:Ge,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;lu("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t.boxes,o=t.scores,i=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.padToMaxOutputSize,l=n,f=l.readSync(a.dataId),p=l.readSync(o.dataId),d=Gh(f,p,i,u,s,c);return[d.selectedIndices,d.validOutputs]}},Hh=_o,Kh={kernelName:je,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;lu("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t.boxes,o=t.scores,i=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.softNmsSigma,l=n,f=l.readSync(a.dataId),p=l.readSync(o.dataId),d=Hh(f,p,i,u,s,c);return[d.selectedIndices,d.selectedScores]}},qh=A((function e(t,n,r,a){I(this,e),this.variableNames=["Image"],this.outputShape=[];var o=t[1],i=t[2],u=Math.sin(n).toFixed(3),s=Math.cos(n).toFixed(3);this.outputShape=t;var c=function(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}(a,o,i),l=E(c,2),f=l[0],p=l[1],d=f.toFixed(3),h=p.toFixed(3),m="";m="number"===typeof r?"float outputValue = ".concat(r.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(r.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - ".concat(d,") * ").concat(s," - (float(y) - ").concat(h,") * ").concat(u,";\n          float coordYFloat = (float(x) - ").concat(d,") * ").concat(u," + (float(y) - ").concat(h,") * ").concat(s,";\n          int coordX = int(round(coordXFloat + ").concat(d,"));\n          int coordY = int(round(coordYFloat + ").concat(h,"));\n          ").concat(m,"\n          if(coordX >= 0 && coordX < ").concat(i," && coordY >= 0 && coordY < ").concat(o,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")})),Xh={kernelName:At,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,o=n.radians,i=n.fillValue,u=n.center,s=r,c=new qh(a.shape,o,i,u);return s.runWebGLProgram(c,[a],a.dtype)}},Yh={kernelName:xt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,o=new Yd(r.shape,"return x * x;");return a.runWebGLProgram(o,[r],r.dtype)}},Qh={kernelName:yt,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.a,a=t.b,o="return (a - b) * (a - b);",i=n,u=P().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new yp(o,r.shape,a.shape):new vp(o,r.shape,a.shape);return i.compileAndRun(u,[r,a])}},$h={kernelName:St,backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,a=e.backend,o=n.x,i=r.perm,u=a,s=o.shape.length,c=new Array(s),l=0;l<c.length;l++)c[l]=o.shape[i[l]];if(u.shouldExecuteOnCPU([o])){var f=u.texData.get(o.dataId).values,p=Oh(f,o.shape,o.dtype,i,c);t=u.makeTensorInfo(c,o.dtype),u.texData.get(t.dataId).values=p}else t=Mh(o,i,u);return t}},Jh=0,Zh=[Bh,Th,_h,Sh,Uh,Wh,jh,Kh,Xh,Yh,Qh,$h];Jh<Zh.length;Jh++){Vt(Zh[Jh])}!function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(zh||(zh={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(Vh||(Vh={}));var em={};function tm(e){return em[e]}function nm(e,t,n,r){var a=t.inputParams[e];if(a&&void 0!==a.inputIndexStart){var o=a.inputIndexStart,i=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?o+1:a.inputIndexEnd;if("tensor"===a.type)return rm(t.inputNames[a.inputIndexStart],n,r);if("tensors"===a.type)return t.inputNames.slice(o,i).map((function(e){return rm(e,n,r)}));var u=rm(t.inputNames.slice(o)[0],n,r),s=u.dataSync();return"number"===a.type?s[0]:vn(u.shape,s)}var c=t.attrParams[e];return c&&c.value}function rm(e,t,n){var r=E(im(e),2),a=r[0],o=r[1],i=n.currentContextIds.find((function(e){return!!t[om(a,e)]}));return void 0!==i?t[om(a,i)][o]:void 0}function am(e,t){var n=E(im(e),2),r=n[0],a=n[1];return[om(r,t&&t.currentContextId),a]}function om(e,t){return t?"".concat(e,"-").concat(t):e}function im(e){var t=e.split(":");return 1===t.length?[e,0]:[t[0],Number(t[t.length-1])]}function um(e,t,n){var r=nm("pad",e,t,n);if("explicit"===r){r=nm("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],o=0;o<4;o++)a[o][0]=r[2*o],a[o][1]=r[2*o+1];return a}return r}function sm(e){return e.kept?e:aa(e)}var cm=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],lm=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],fm=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],pm=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],dm=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],hm=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],mm=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],vm=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],gm=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],ym=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],xm=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],bm=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],wm=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],km=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],Cm=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Em=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}],Sm=function(){function e(){var n;I(this,e);var y=[t,r,a,o,i,u,s,f,l,c,p,d,h,m,v,g],x=(n=[]).concat.apply(n,R(y.map((function(e){return e.json}))));this.opMappers=x.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return A(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.node,a=[],o=[],i=r.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")&&a.push(e[n.name]),"Const"===n.op&&o.push(e[n.name]),e}),{}),u=[],s=[],c={},l={};null!=n&&(c=this.mapSignatureEntries(n.inputs),l=this.mapSignatureEntries(n.outputs));var f=Object.keys(i);f.forEach((function(e){var t=i[e];t.inputNames.forEach((function(e){var n=E(am(e),1)[0];t.inputs.push(i[n]),i[n].children.push(t)}))})),0===Object.keys(l).length?f.forEach((function(e){var t=i[e];0===t.children.length&&s.push(t)})):Object.keys(l).forEach((function(e){var t=E(am(e),1)[0],n=i[t];null!=n&&(n.signatureKey=l[e],s.push(n))})),Object.keys(c).length>0?Object.keys(c).forEach((function(e){var t=E(am(e),1)[0],n=i[t];n&&(n.signatureKey=c[e],u.push(n))})):u=a;var p={};return null!=e.library&&null!=e.library.function&&(p=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{})),{nodes:i,inputs:u,outputs:s,weights:o,placeholders:a,signature:n,functions:p}}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=tm(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=Tm(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Tm(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=Mm(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Mm(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=Im(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=Im(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=Lm(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Lm(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=Rm(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Rm(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=zm(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=zm(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=Pm(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Pm(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=Bm(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Bm(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=Om(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Om(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=Dm(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Dm(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=Am(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=Am(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,r=[],a={};null!=n&&(a=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&r.push(e[n.name]),e}),{}));var o=[],i=[];e.signature.inputArg.forEach((function(e){var t=E(am(e.name),1)[0],n={name:t,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:_m(e.type),type:"dtype"}},children:[]};n.signatureKey=e.name,o.push(n),a[t]=n})),Object.keys(a).forEach((function(e){var t=a[e];t.inputNames.forEach((function(e){var n=E(am(e),1)[0];t.inputs.push(a[n]),a[n].children.push(t)}))}));var u=e.ret;e.signature.outputArg.forEach((function(e){var t=E(am(u[e.name]),2),n=t[0],r=t[1],o=a[n];null!=o&&(o.defaultOutput=r,i.push(o))}));var s=this.mapArgsToSignature(e);return{nodes:a,inputs:o,outputs:i,weights:r,placeholders:[],signature:s}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();function Nm(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=P().global;if("undefined"!==typeof t.atob)return t.atob(e);if("undefined"!==typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function Tm(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?Nm(a.s,r):n}function Rm(e,t,n){var r=e[t];return r?r.b:n}function Im(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function _m(e){switch("string"===typeof e&&(e=zh[e]),e){case zh.DT_FLOAT:return"float32";case zh.DT_INT32:case zh.DT_INT64:case zh.DT_INT8:case zh.DT_UINT8:return"int32";case zh.DT_BOOL:return"bool";case zh.DT_DOUBLE:return"float32";case zh.DT_STRING:return"string";default:return null}}function Am(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function Om(e,t,n){var r=e[t];return r&&r.type?_m(r.type):n}function Dm(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return _m(e)})):n}function Fm(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"===typeof e.size?e.size:parseInt(e.size,10)})):[]}function Pm(e,t,n){var r=e[t];return r&&r.shape?Fm(r.shape):n}function Lm(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"===typeof e?e:parseInt(e,10)})):n}function Mm(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return Nm(e,r)})):n}function Bm(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return Fm(e)})):n}function zm(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var Vm=function(){function e(t,n,r){var a=this;I(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return A(e,[{key:"getInput",value:function(e){return rm(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return rm(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Im(this.node.rawAttrs,e,t);if(null!=n.s)return Tm(this.node.rawAttrs,e,t);if(null!=n.b)return Rm(this.node.rawAttrs,e,t);if(null!=n.shape)return Pm(this.node.rawAttrs,e,t);if(null!=n.type)return Om(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Lm(this.node.rawAttrs,e,t);if(null!=n.list.s)return Mm(this.node.rawAttrs,e,t);if(null!=n.list.shape)return Bm(this.node.rawAttrs,e,t);if(null!=n.list.b)return zm(this.node.rawAttrs,e,t);if(null!=n.list.type)return Dm(this.node.rawAttrs,e,t)}return t}}]),e}();var Um=vr({addN_:function(e){Kt(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),Kt(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return hr(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!$t(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return ir.runKernelFunc((function(e,n){var r=e.addN(t);return n(t),r}),r,null,G)}});function Wm(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Kt(Gm(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function Gm(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(-1!==e[n]&&-1!==t[n]&&e[n]!==t[n])return!1;return!0}var jm=function(){function e(t,n,r,a,o,i,u){I(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=u,this.tensors=[],this.closed_=!1,this.idTensor=Ja(0),fi(this.idTensor)}return A(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),Wm(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,fi(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return xr([],[0].concat(this.elementShape));var r=this.readMany(e);return Wm(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),ro(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return xr([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return Wm(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),Oa(r,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,R(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,io(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var o=0===r?0:t.size/r,i=[];ci((function(){t=ja(t,[1,r,o]);for(var u=0;u<e.length;++u){var s=[0,0===u?0:a[u-1],0],c=[1,e[u],o];i[u]=ja(eo(t,s,c),n.elementShape)}return i}));for(var u=[],s=0;s<e.length;s++)u[s]=s;this.writeMany(u,i)}}]),e}(),Hm=function(){function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;I(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=r,null!=t&&t.forEach((function(e){if(r!==e.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(e.dtype));Wm(n,e.shape,"TensorList shape mismatch: "),fi(e)})),this.idTensor=Ja(0),this.maxNumElements=a,fi(this.idTensor)}return A(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e(R(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==r&&this.tensors.length!==r)throw new Error("Operation expected a list with ".concat(r," elements but got a list with ").concat(this.tensors.length," elements."));return Wm(e,this.elementShape,"TensorList shape mismatch: "),ci((function(){var t=n.tensors.map((function(t){return ja(t,e)}));return ro(t,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=this.tensors.pop();return Wm(n.shape,e,"TensorList shape mismatch: "),ja(n,e)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(Wm(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");fi(e),this.tensors.push(e)}},{key:"resize",value:function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));this.tensors.length=e}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));return Wm(this.tensors[e].shape,t,"TensorList shape mismatch: "),this.tensors[e]}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));Wm(this.elementShape,t.shape,"TensorList shape mismatch: "),fi(t),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));return Wm(this.elementShape,n,"TensorList shape mismatch: "),0===(e=e.slice(0,this.size())).length?xr([],[0].concat(this.elementShape)):ci((function(){var t=e.map((function(e){return ja(r.tensors[e],n)}));return ro(t,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));return Wm(this.elementShape,t,"TensorList shape mismatch: "),0===this.size()?xr([],[0].concat(this.elementShape)):ci((function(){var e=n.tensors.map((function(e){return ja(e,t)}));return Oa(e,0)}))}}]),e}();function Km(e,t,n){var r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));Wm(e.shape.slice(1),t,"TensorList shape mismatch: ");var a=io(e);return new Hm(a,t,r)}function qm(e,t,n){return new Hm([],e,t,n)}function Xm(e,t,n,r){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var a=Math.max.apply(Math,R(t));if(null!=r&&-1!==r&&a>=r)throw new Error("Max index must be < array size (".concat(a,"  vs. ").concat(r,")"));var o=new Hm([],n,e.dtype,r),i=io(e,0);return t.forEach((function(e,t){o.setItem(e,i[t])})),o}function Ym(e,t,n){var r=0,a=t.map((function(e){return r+=e}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));for(var o=0===r?0:e.size/r,i=ci((function(){var i=[];e=ja(e,[1,r,o]);for(var u=0;u<t.length;++u){var s=[0,0===u?0:a[u-1],0],c=[1,t[u],o];i[u]=ja(eo(e,s,c),n)}return e.dispose(),i})),u=new Hm([],n,e.dtype,t.length),s=0;s<i.length;s++)u.setItem(s,i[s]);return u}var Qm=function(){var e=w(N().mark((function e(t,n,r){var a,o,i,u,s,c,l,f,p,d,h,m,v,g,y,x,b,w,k,C,E,S,T,R,I,_,A,O,D,F,P,L,M,B,z,V,U,W,G,j,H,K,q,X,Y,Q,$,J,Z,ee,te,ne,re,ae,oe,ie,ue,se,ce,le,fe,pe,de,he,me,ve,ge,ye,xe,be,we,ke,Ce,Ee,Se,Ne,Te,Re,Ie,_e,Ae,Oe,De,Fe,Pe,Le,Me,Be,ze,Ve,Ue,We,Ge,je,He;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0||"StatelessIf"===e.t0?3:"While"===e.t0||"StatelessWhile"===e.t0?15:"LoopCond"===e.t0?19:"Switch"===e.t0?21:"Merge"===e.t0?32:"Enter"===e.t0?37:"Exit"===e.t0?41:"NextIteration"===e.t0?44:"TensorArrayV3"===e.t0?47:"TensorArrayWriteV3"===e.t0?57:"TensorArrayReadV3"===e.t0?63:"TensorArrayGatherV3"===e.t0?67:"TensorArrayScatterV3"===e.t0?72:"TensorArrayConcatV3"===e.t0?78:"TensorArraySplitV3"===e.t0?82:"TensorArraySizeV3"===e.t0?88:"TensorArrayCloseV3"===e.t0?91:"TensorListSetItem"===e.t0?95:"TensorListGetItem"===e.t0?101:"TensorListScatterV2"===e.t0||"TensorListScatter"===e.t0?107:"TensorListReserve"===e.t0?114:"TensorListGather"===e.t0?120:"TensorListStack"===e.t0?126:"TensorListFromTensor"===e.t0?132:"TensorListConcat"===e.t0?138:"TensorListPushBack"===e.t0?143:"TensorListPopBack"===e.t0?148:"TensorListSplit"===e.t0?153:159;break;case 3:return a=nm("thenBranch",t,n,r),o=nm("elseBranch",t,n,r),i=nm("cond",t,n,r),u=nm("args",t,n,r),e.next=9,i.data();case 9:if(!e.sent[0]){e.next=14;break}return e.abrupt("return",r.functionMap[a].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap));case 14:return e.abrupt("return",r.functionMap[o].executeFunctionAsync(u,r.tensorArrayMap,r.tensorListMap));case 15:return e.delegateYield(N().mark((function e(){var a,o,i,u,s,c,l,f;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=nm("body",t,n,r),o=nm("cond",t,n,r),i=nm("args",t,n,r),e.next=5,r.functionMap[o].executeFunctionAsync(i,r.tensorArrayMap,r.tensorListMap);case 5:return u=e.sent,s=i.map((function(e){return e.id})),e.next=9,u[0].data();case 9:c=e.sent,u.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||e.dispose()})),l=i,f=N().mark((function e(){var t,n,i;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l,e.next=3,r.functionMap[a].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 3:return l=e.sent,n=l.map((function(e){return e.id})),t.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()})),e.next=8,r.functionMap[o].executeFunctionAsync(l,r.tensorArrayMap,r.tensorListMap);case 8:return i=e.sent,e.next=11,i[0].data();case 11:c=e.sent,i.forEach((function(e){e.kept||-1!==s.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()}));case 13:case"end":return e.stop()}}),e)}));case 13:if(!c[0]){e.next=17;break}return e.delegateYield(f(),"t0",15);case 15:e.next=13;break;case 17:return e.abrupt("return",{v:l});case 18:case"end":return e.stop()}}),e)}))(),"t1",16);case 16:if("object"!==typeof(s=e.t1)){e.next=19;break}return e.abrupt("return",s.v);case 19:return c=nm("pred",t,n,r),e.abrupt("return",[sm(c)]);case 21:return l=nm("pred",t,n,r),(f=nm("data",t,n,r)).kept||(f=sm(f)),e.next=26,l.data();case 26:if(!e.sent[0]){e.next=30;break}e.t2=[void 0,f],e.next=31;break;case 30:e.t2=[f,void 0];case 31:return e.abrupt("return",e.t2);case 32:if(p=t.inputNames.find((function(e){return void 0!==rm(e,n,r)})),!p){e.next=36;break}return d=rm(p,n,r),e.abrupt("return",[sm(d)]);case 36:return e.abrupt("return",void 0);case 37:return h=nm("frameName",t,n,r),m=nm("tensor",t,n,r),r.enterFrame(h),e.abrupt("return",[sm(m)]);case 41:return v=nm("tensor",t,n,r),r.exitFrame(),e.abrupt("return",[sm(v)]);case 44:return g=nm("tensor",t,n,r),r.nextIteration(),e.abrupt("return",[sm(g)]);case 47:return y=nm("size",t,n,r),x=nm("dtype",t,n,r),b=nm("elementShape",t,n,r),w=nm("dynamicSize",t,n,r),k=nm("clearAfterRead",t,n,r),C=nm("identicalElementShapes",t,n,r),E=nm("name",t,n,r),S=new jm(E,x,y,b,C,w,k),r.addTensorArray(S),e.abrupt("return",[S.idTensor,Ja(1)]);case 57:return T=nm("tensorArrayId",t,n,r),R=nm("index",t,n,r),I=nm("tensor",t,n,r),(_=r.getTensorArray(T.id)).write(R,I),e.abrupt("return",[_.idTensor]);case 63:return A=nm("tensorArrayId",t,n,r),O=nm("index",t,n,r),D=r.getTensorArray(A.id),e.abrupt("return",[D.read(O)]);case 67:return F=nm("tensorArrayId",t,n,r),P=nm("indices",t,n,r),L=nm("dtype",t,n,r),M=r.getTensorArray(F.id),e.abrupt("return",[M.gather(P,L)]);case 72:return B=nm("tensorArrayId",t,n,r),z=nm("indices",t,n,r),V=nm("tensor",t,n,r),(U=r.getTensorArray(B.id)).scatter(z,V),e.abrupt("return",[U.idTensor]);case 78:return W=nm("tensorArrayId",t,n,r),G=r.getTensorArray(W.id),j=nm("dtype",t,n,r),e.abrupt("return",[G.concat(j)]);case 82:return H=nm("tensorArrayId",t,n,r),K=nm("tensor",t,n,r),q=nm("lengths",t,n,r),(X=r.getTensorArray(H.id)).split(q,K),e.abrupt("return",[X.idTensor]);case 88:return Y=nm("tensorArrayId",t,n,r),Q=r.getTensorArray(Y.id),e.abrupt("return",[Ja(Q.size(),"int32")]);case 91:return $=nm("tensorArrayId",t,n,r),(J=r.getTensorArray($.id)).clearAndClose(),e.abrupt("return",[J.idTensor]);case 95:return Z=nm("tensorListId",t,n,r),ee=nm("index",t,n,r),te=nm("tensor",t,n,r),(ne=r.getTensorList(Z.id)).setItem(ee,te),e.abrupt("return",[ne.idTensor]);case 101:return re=nm("tensorListId",t,n,r),ae=nm("index",t,n,r),oe=nm("elementShape",t,n,r),ie=nm("elementDType",t,n,r),ue=r.getTensorList(re.id),e.abrupt("return",[ue.getItem(ae,oe,ie)]);case 107:return se=nm("indices",t,n,r),ce=nm("tensor",t,n,r),le=nm("elementShape",t,n,r),fe=nm("numElements",t,n,r),pe=Xm(ce,se,le,fe),r.addTensorList(pe),e.abrupt("return",[pe.idTensor]);case 114:return de=nm("elementShape",t,n,r),he=nm("elementDType",t,n,r),me=nm("numElements",t,n,r),ve=qm(de,he,me),r.addTensorList(ve),e.abrupt("return",[ve.idTensor]);case 120:return ge=nm("tensorListId",t,n,r),ye=nm("indices",t,n,r),xe=nm("elementShape",t,n,r),be=nm("elementDType",t,n,r),we=r.getTensorList(ge.id),e.abrupt("return",[we.gather(ye,be,xe)]);case 126:return ke=nm("tensorListId",t,n,r),Ce=nm("elementShape",t,n,r),Ee=nm("elementDType",t,n,r),Se=nm("numElements",t,n,r),Ne=r.getTensorList(ke.id),e.abrupt("return",[Ne.stack(Ce,Ee,Se)]);case 132:return Te=nm("tensor",t,n,r),Re=nm("elementShape",t,n,r),Ie=nm("elementDType",t,n,r),_e=Km(Te,Re,Ie),r.addTensorList(_e),e.abrupt("return",[_e.idTensor]);case 138:return Ae=nm("tensorListId",t,n,r),Oe=r.getTensorList(Ae.id),De=nm("dtype",t,n,r),Fe=nm("elementShape",t,n,r),e.abrupt("return",[Oe.concat(De,Fe)]);case 143:return Pe=nm("tensorListId",t,n,r),Le=nm("tensor",t,n,r),(Me=r.getTensorList(Pe.id)).pushBack(Le),e.abrupt("return",[Me.idTensor]);case 148:return Be=nm("tensorListId",t,n,r),ze=nm("elementShape",t,n,r),Ve=nm("elementDType",t,n,r),Ue=r.getTensorList(Be.id),e.abrupt("return",[Ue.popBack(ze,Ve)]);case 153:return We=nm("tensor",t,n,r),Ge=nm("elementShape",t,n,r),je=nm("lengths",t,n,r),He=Ym(We,je,Ge),r.addTensorList(He),e.abrupt("return",[He.idTensor]);case 159:throw TypeError("Node type ".concat(t.op," is not implemented"));case 160:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();var $m=vr({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,o=e.dataFormat,i=void 0===o?"NHWC":o,u=e.dilations,s=void 0===u?[1,1]:u,c=e.dimRoundingMode,l=e.bias,f=e.activation,p=void 0===f?"linear":f,d=e.preluActivationWeights;if(p=p||"linear",!1===tu(ir.state.gradientDepth,p)){var h=Xu(t,n,r,a,i,s,c);return null!=l&&(h=Ia(h,l)),eu(h,p,d)}var m=hr(t,"x","conv2d"),v=hr(n,"filter","conv2d"),g=m,y=!1;3===m.rank&&(y=!0,g=ja(m,[1,m.shape[0],m.shape[1],m.shape[2]])),Kt(4===g.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(g.rank,".")})),Kt(4===v.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(v.rank,".")})),null!=c&&Kt(Jt(a),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(c," but got pad ").concat(a,".")})),Kt(g.shape[3]===v.shape[2],(function(){return"Error in conv2d: depth of input (".concat(g.shape[3],") must match ")+"input depth for filter ".concat(v.shape[2],".")})),Kt(Ki(r,s),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(s,"'")})),Kt("NHWC"===i,(function(){return"Error in conv2d: got dataFormat of ".concat(i," but only NHWC is currently supported.")}));var x,b,w=Li(g.shape,v.shape,r,s,a,c);if(null!=l){var k=E(Zn(x=hr(l,"bias","fused conv2d"),m),1);x=k[0],Ko(w.outShape,x.shape)}null!=d&&(b=hr(d,"prelu weights","fused conv2d"));var C=function(e,t){var n=E(t,4),o=n[0],i=n[1],u=n[2],c=n[3],l=Ji(e,u,p);Kt(Hi(s),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(s,"'")}));var f=[Ku(i.shape,l,o,r,a),Hu(i,l,o.shape,r,a)];if(null!=c){var d=Zi(c,l);f.push(d)}return f},S=function(e){return e.fusedConv2d({input:g,filter:v,convInfo:w,bias:x,activation:p,preluActivationWeights:b})},N={x:g,filter:v,bias:x,preluActivationWeights:b},T={strides:r,pad:a,dataFormat:i,dilations:s,dimRoundingMode:c,activation:p};if(null==l){var R=xi((function(e,t,n){var r=ir.runKernelFunc(S,N,null,Dt,T);return n([t,e,r]),y&&(r=ja(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:C}}));return R(g,v)}var I=xi((function(e,t,n,r){var a=ir.runKernelFunc(S,N,null,Dt,T);return r([t,e,a,n]),y&&(a=ja(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:C}}));return I(g,v,x)}});var Jm=vr({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,o=e.dataFormat,i=void 0===o?"NHWC":o,u=e.dilations,s=void 0===u?[1,1]:u,c=e.dimRoundingMode,l=e.bias,f=e.activation,p=void 0===f?"linear":f,d=e.preluActivationWeights;if(!1===tu(ir.state.gradientDepth,p)){var h=hl(t,n,r,a,i,s,c);return null!=l&&(h=Ia(h,l)),eu(h,p,d)}var m=hr(t,"x","depthwiseConv2d"),v=hr(n,"filter","depthwiseConv2d"),g=m,y=!1;3===m.rank&&(y=!0,g=ja(m,[1,m.shape[0],m.shape[1],m.shape[2]])),Kt(4===g.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(g.rank,".")})),Kt(4===v.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(v.rank,".")})),Kt(g.shape[3]===v.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(g.shape[3],") must match the inChannels dimension in ")+"filter ".concat(v.shape[2],".")})),null==s&&(s=[1,1]),Kt(Ki(r,s),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(s,"'")})),null!=c&&Kt(Jt(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(c," but got pad ").concat(a,".")}));var x,b,w=Li(g.shape,v.shape,r,s,a,c,!0);if(null!=l){var k=E(Zn(x=hr(l,"bias","fused conv2d"),m),1);x=k[0],Ko(w.outShape,x.shape)}null!=d&&(b=hr(d,"prelu weights","fused depthwiseConv2d"));var C=function(e,t){Kt(Hi(s),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(s,"'")}));var n=E(t,4),r=n[0],a=n[1],o=n[2],i=n[3],u=Ji(e,o,p),c=is(a.shape,u,r,w),l=os(a,u,r.shape,w);return null!=i?[c,l,Zi(x,u)]:[c,l]},S=function(e){return e.fusedDepthwiseConv2D({input:g,filter:v,convInfo:w,bias:x,activation:p,preluActivationWeights:b})},N={x:g,filter:v,bias:x,preluActivationWeights:b},T={strides:r,pad:a,dataFormat:i,dilations:s,dimRoundingMode:c,activation:p};if(null==l){var R=xi((function(e,t,n){var r=ir.runKernelFunc(S,N,null,Ft,T);return n([t,e,r]),y&&(r=ja(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:C}}));return R(g,v)}var I=xi((function(e,t,n,r){var a=ir.runKernelFunc(S,N,null,Ft,T);return r([t,e,a,n]),y&&(a=ja(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:C}}));return I(g,v,x)}});var Zm=vr({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,a=void 0!==r&&r,o=e.transposeB,i=void 0!==o&&o,u=e.bias,s=e.activation,c=void 0===s?"linear":s,l=e.preluActivationWeights;if(!1===tu(ir.state.gradientDepth,c)){var f=mi(t,n,a,i);return null!=u&&(f=Ia(f,u)),eu(f,c,l)}var p=hr(t,"a","fused matMul"),d=hr(n,"b","fused matMul"),h=E(Zn(p,d),2);p=h[0],d=h[1];var m=a?p.shape[p.rank-2]:p.shape[p.rank-1],v=i?d.shape[d.rank-1]:d.shape[d.rank-2],g=a?p.shape[p.rank-1]:p.shape[p.rank-2],y=i?d.shape[d.rank-2]:d.shape[d.rank-1],x=p.shape.slice(0,-2),b=d.shape.slice(0,-2),w=Qt(x),k=Qt(b);Kt(p.rank>=2&&d.rank>=2&&p.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least "+"2, got ranks ".concat(p.rank," and ").concat(d.rank,".")})),Kt($t(x,b),(function(){return"Error in fused matMul: outer dimensions (".concat(x,") and (")+"".concat(b,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(d.shape," must match.")})),Kt(m===v,(function(){return"Error in fused matMul: inner shapes (".concat(m,") and (")+"".concat(v,") of Tensors with shapes ").concat(p.shape," and ")+"".concat(d.shape," and transposeA=").concat(a)+" and transposeB=".concat(i," must match.")}));var C,S,N=p.shape.slice(0,-2).concat([g,y]),T=ja(p,a?[w,m,g]:[w,g,m]),R=ja(d,i?[k,y,v]:[k,v,y]);if(null!=u){var I=E(Zn(C=hr(u,"bias","fused matMul"),p),1);C=I[0],Ko(N,C.shape)}null!=l&&(S=hr(l,"prelu weights","fused matMul"));var _=function(e,t){var n,r,o=E(t,4),s=o[0],l=o[1],f=o[2],p=o[3],d=Ji(ja(e,f.shape),f,c);return a||i?!a&&i?(n=mi(d,l,!1,!1),r=mi(d,s,!0,!1)):a&&!i?(n=mi(l,d,!1,!0),r=mi(s,d,!1,!1)):(n=mi(l,d,!0,!0),r=mi(d,s,!0,!0)):(n=mi(d,l,!1,!0),r=mi(s,d,!0,!1)),null!=u?[n,r,Zi(p,d)]:[n,r]},A=function(e){return e.fusedBatchMatMul({a:T,b:R,transposeA:a,transposeB:i,bias:C,activation:c,preluActivationWeights:S})},O={a:T,b:R,bias:C,preluActivationWeights:S},D={transposeA:a,transposeB:i,activation:c};if(null==u){var F=xi((function(e,t,n){var r=ir.runKernelFunc(A,O,null,Ot,D);return n([e,t,r]),{value:ja(r,N),gradFunc:_}}));return F(T,R)}var P=xi((function(e,t,n,r){var a=ir.runKernelFunc(A,O,null,Ot,D);return r([e,t,a,n]),{value:ja(a,N),gradFunc:_}}));return P(T,R,C)}});var ev=vr({conv3d_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],i=hr(e,"x","conv3d"),u=hr(t,"filter","conv3d"),s=i,c=!1;4===i.rank&&(c=!0,s=ja(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Kt(5===s.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(s.rank,".")})),Kt(5===u.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(u.rank,".")})),Kt(s.shape[4]===u.shape[3],(function(){return"Error in conv3d: depth of input (".concat(s.shape[4],") must match ")+"input depth for filter ".concat(u.shape[3],".")})),Kt(Ki(n,o),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(o,"'")})),Kt("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of ".concat(a," but only NDHWC is currently supported.")}));var l=function(e,t){var a=Mi(s.shape,u.shape,n,o,r),i=e.conv3d(s,u,a);return t([s,u]),i},f={x:s,filter:u},p={strides:n,pad:r,dataFormat:a,dilations:o},d=ir.runKernelFunc(l,f,null,le,p);return c?ja(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var tv=vr({maxPoolWithArgmax_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=hr(e,"x","maxPoolWithArgmax"),i={x:o},u={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},s=ir.runKernel(Me,i,u);return{result:s[0],indexes:s[1]}}});var nv=vr({avgPool3d_:function(e,t,n,r,a){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",i=arguments.length>6?arguments[6]:void 0;null==i?i=[1,1,1]:ui("dilations is deprecated, this field will be gone in v3.0.0.");var u=hr(e,"x","avgPool3d","float32"),s=u,c=!1;4===u.rank&&(c=!0,s=ja(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Kt(5===s.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),Kt("NDHWC"===o,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o)})),Kt(Ki(n,i),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),null!=a&&Kt(Jt(r),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var l=function(e,u){null==i&&(i=[1,1,1]);var c=Pi(s.shape,t,n,i,r,a,o);return u([s]),e.avgPool3d(s,c)},f={x:s},p={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:o,dilations:i},d=ir.runKernelFunc(l,f,null,J,p);return d=ra(d,s.dtype),c?ja(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});var rv=vr({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",i=arguments.length>6?arguments[6]:void 0;null==i?i=[1,1,1]:ui("dilations is deprecated, this field will be gone in v3.0.0.");var u=hr(e,"x","maxPool3d"),s=u,c=!1;4===u.rank&&(c=!0,s=ja(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Kt(5===s.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(s.rank,".")})),Kt("NDHWC"===o,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(o)})),Kt(Ki(n,i),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(i,"'")})),null!=a&&Kt(Jt(r),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(a," but got pad ").concat(r,".")}));var l=function(e,u){null==i&&(i=[1,1,1]);var c=Pi(s.shape,t,n,i,r,a,o),l=e.maxPool3d(s,c);return u([s,l]),l},f={x:s},p={filterSize:t,strides:n,pad:r,dimRoundingMode:a,dataFormat:o,dilations:i},d=ir.runKernelFunc(l,f,null,Pe,p);return c?ja(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}});function av(e,t,n){var r=E(nm("fusedOps",e,t,n),2),a=r[0],o=r[1],i="biasadd"===a,u="prelu"===o,s="fusedbatchnorm"===a,c=nm("numArgs",e,t,n);if(i){if(u&&2!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==c)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(s)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");var l=nm("strides",e,t,n),f=um(e,t,n),p=nm("dataFormat",e,t,n).toUpperCase(),d=nm("dilations",e,t,n),h=E(nm("args",e,t,n),2);return{stride:l,pad:f,dataFormat:p,dilations:d,biasArg:h[0],preluArg:h[1],activationFunc:o}}function ov(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var r={start:e,stop:t,num:n};return ir.runKernelFunc((function(r){return r.linspace(e,t,n)}),{},null,"LinSpace",r)}var iv=vr({multinomial_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=hr(e,"logits","multinomial"),o=a.size,i=a.rank;if(o<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(o,"."));if(i>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(i));n=n||Math.random();var u=1===i?ja(a,[1,-1]):a,s=ir.runKernelFunc((function(e){return e.multinomial(u,r,t,n)}),{logits2D:u});return 1===i?ja(s,[s.size]):s}}),uv=n(699),sv=function(){function e(t,n,r,a,o){I(this,e),this.mean=t,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=a,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=o||Math.random();this.random=uv.alea(i.toString())}return A(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,o=void 0,i=void 0;do{i=(a=2*this.random()-1)*a+(o=2*this.random()-1)*o}while(i>=1||0===i);var u=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*a*u,n=this.mean+this.stdDev*o*u,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}(),cv=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;if(I(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=r-n,this.dtype=a,null==o&&(o=Math.random()),"number"===typeof o&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(r," <= 1 and dtype is not float"));this.random=uv.alea(o)}return A(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}();var lv=vr({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",a=arguments.length>4?arguments[4]:void 0,o=na(e,r),i=new cv(t,n,null,a),u=0;u<o.values.length;u++)o.values[u]=i.nextValue();return o.toTensor()}});var fv=vr({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;if(null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var o=new sv(t,n,r,!0,a),i=na(e,r),u=0;u<i.values.length;u++)i.values[u]=o.nextValue();return i.toTensor()}});function pv(){return(pv=w(N().mark((function e(t){var n,r,a;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=hr(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,a=gu(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var dv=function(e){return pv.apply(this,arguments)};function hv(){return hv=w(N().mark((function e(t,n){var r,a,o,i,u,s,c,l,f,p,d;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=hr(t,"x","setdiff1d"),a=hr(n,"y","setdiff1d"),Kt(r.dtype===a.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(a.dtype,").")})),Kt(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),Kt(1===a.rank,(function(){return"y should be 1D tensor, but got y (".concat(a.shape,").")})),e.next=7,r.data();case 7:return o=e.sent,e.next=10,a.data();case 10:for(i=e.sent,u=new Set(i),s=0,c=0;c<o.length;c++)u.has(o[c])||s++;for(l=new Vn([s],r.dtype),f=new Vn([s],"int32"),p=0,d=0;p<o.length;p++)u.has(o[p])||(l.values[d]=o[p],f.values[d]=p,d++);return e.abrupt("return",[l.toTensor(),f.toTensor()]);case 18:case"end":return e.stop()}}),e)}))),hv.apply(this,arguments)}var mv=function(e,t){return hv.apply(this,arguments)};function vv(e,t,n){return{boxes:nm("boxes",e,t,n),scores:nm("scores",e,t,n),maxOutputSize:nm("maxOutputSize",e,t,n),iouThreshold:nm("iouThreshold",e,t,n),scoreThreshold:nm("scoreThreshold",e,t,n),softNmsSigma:nm("softNmsSigma",e,t,n)}}var gv=function(){var e=w(N().mark((function e(t,n,r){var a,o,i,u,s,c,l,f,p,d,h,m,v,g,y,x,b,w,k,C,E,S,T,R;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?3:"NonMaxSuppressionV4"===e.t0?8:"NonMaxSuppressionV3"===e.t0||"NonMaxSuppressionV2"===e.t0?14:"Where"===e.t0?19:"ListDiff"===e.t0?26:27;break;case 3:return a=vv(t,n,r),o=a.boxes,i=a.scores,u=a.maxOutputSize,s=a.iouThreshold,c=a.scoreThreshold,l=a.softNmsSigma,e.next=6,Di.nonMaxSuppressionWithScoreAsync(o,i,u,s,c,l);case 6:return f=e.sent,e.abrupt("return",[f.selectedIndices,f.selectedScores]);case 8:return p=vv(t,n,r),d=p.boxes,h=p.scores,m=p.maxOutputSize,v=p.iouThreshold,g=p.scoreThreshold,y=nm("padToMaxOutputSize",t,n,r),e.next=12,Di.nonMaxSuppressionPaddedAsync(d,h,m,v,g,y);case 12:return x=e.sent,e.abrupt("return",[x.selectedIndices,x.validOutputs]);case 14:return b=vv(t,n,r),w=b.boxes,k=b.scores,C=b.maxOutputSize,E=b.iouThreshold,S=b.scoreThreshold,e.next=17,Di.nonMaxSuppressionAsync(w,k,C,E,S);case 17:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 19:return T=ra(nm("condition",t,n,r),"bool"),e.next=22,dv(T);case 22:return e.t2=e.sent,R=[e.t2],T.dispose(),e.abrupt("return",R);case 26:return e.abrupt("return",mv(nm("x",t,n,r),nm("y",t,n,r)));case 27:throw TypeError("Node type ".concat(t.op," is not implemented"));case 28:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}();function yv(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,o=e.rank>1?e.shape[1]:1;if(n.length!==o)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(o,"."));var i=t.size;if(0!==t.rank&&(1!==t.rank||i!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var xv=vr({sparseToDense_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=hr(e,"sparseIndices","sparseToDense","int32"),o=hr(t,"sparseValues","sparseToDense"),i=hr(r,"defaultValue","sparseToDense",o.dtype);yv(a,o,n,i);var u={sparseIndices:a,sparseValues:o,defaultValue:i},s={outputShape:n};return ir.runKernelFunc((function(e){return e.sparseToDense(a,o,n,i)}),u,null,bt,s)}});var bv=vr({scatterND_:function(e,t,n){var r=hr(e,"indices","scatterND","int32"),a=hr(t,"updates","scatterND");iu(a,r,n);var o={indices:r,updates:a},i={shape:n};return ir.runKernelFunc((function(e){return e.scatterND(r,a,n)}),o,null,"ScatterNd",i)}});var wv=vr({gatherND_:function(e,t){var n=hr(t,"indices","gatherND","int32"),r=hr(e,"x","gatherND"),a={params:r,indices:n};return ir.runKernelFunc((function(e){return e.gatherND(r,n)}),a,null,"GatherNd")}});function kv(e,t,n){var r=function(e,t,n){switch(e.category){case"arithmetic":return ci((function(){return function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[Ia(nm("a",e,t,n),nm("b",e,t,n))];case"AddN":return[Um(nm("tensors",e,t,n))];case"FloorMod":case"Mod":return[Uc(nm("a",e,t,n),nm("b",e,t,n))];case"Mul":return[qa(nm("a",e,t,n),nm("b",e,t,n))];case"RealDiv":case"Div":return[Pa(nm("a",e,t,n),nm("b",e,t,n))];case"DivNoNan":return[vl(nm("a",e,t,n),nm("b",e,t,n))];case"FloorDiv":return[Fa(nm("a",e,t,n),nm("b",e,t,n))];case"Sub":return[ao(nm("a",e,t,n),nm("b",e,t,n))];case"Minimum":return[Si(nm("a",e,t,n),nm("b",e,t,n))];case"Maximum":return[Pc(nm("a",e,t,n),nm("b",e,t,n))];case"Pow":return[ei(nm("a",e,t,n),nm("b",e,t,n))];case"SquaredDifference":return[Ti(nm("a",e,t,n),nm("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"basic_math":return ci((function(){return function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[Jo(nm("x",e,t,n))];case"Acos":return[zc(nm("x",e,t,n))];case"Acosh":return[Vc(nm("x",e,t,n))];case"Asin":return[tl(nm("x",e,t,n))];case"Asinh":return[nl(nm("x",e,t,n))];case"Atan":return[rl(nm("x",e,t,n))];case"Atan2":return[al(nm("x",e,t,n),nm("y",e,t,n))];case"Atanh":return[ol(nm("x",e,t,n))];case"Ceil":return[cl(nm("x",e,t,n))];case"Complex":return[gr(nm("real",e,t,n),nm("imag",e,t,n))];case"Cos":return[pc(nm("x",e,t,n))];case"Cosh":return[hc(nm("x",e,t,n))];case"Elu":return[Xi(nm("x",e,t,n))];case"Erf":return[El(nm("x",e,t,n))];case"Exp":return[Ri(nm("x",e,t,n))];case"Expm1":return[Sl(nm("x",e,t,n))];case"Floor":return[Gs(nm("x",e,t,n))];case"Log":return[Ni(nm("x",e,t,n))];case"Log1p":return[Ii(nm("x",e,t,n))];case"Imag":return[La(nm("x",e,t,n))];case"Neg":return[vi(nm("x",e,t,n))];case"Reciprocal":return[Ul(nm("x",e,t,n))];case"Real":return[$a(nm("x",e,t,n))];case"Relu":return[Ei(nm("x",e,t,n))];case"Round":return[Wl(nm("x",e,t,n))];case"Selu":return[Gl(nm("x",e,t,n))];case"Sigmoid":return[Za(nm("x",e,t,n))];case"Sin":return[Zu(nm("x",e,t,n))];case"Sign":return[Hl(nm("x",e,t,n))];case"Sinh":return[ts(nm("x",e,t,n))];case"Softplus":return[Al(nm("x",e,t,n))];case"Sqrt":return[ti(nm("x",e,t,n))];case"Square":return[ni(nm("x",e,t,n))];case"Tanh":return[Xl(nm("x",e,t,n))];case"Tan":return[ql(nm("x",e,t,n))];case"Relu6":case"ClipByValue":return[ll(nm("x",e,t,n),nm("clipValueMin",e,t,n),nm("clipValueMax",e,t,n))];case"Rsqrt":return[vs(rm(e.inputNames[0],t,n))];case"Prod":return[Vl(nm("x",e,t,n),nm("axes",e,t,n))];case"LeakyRelu":return[Il(nm("x",e,t,n),nm("alpha",e,t,n))];case"Prelu":return[Yi(nm("x",e,t,n),nm("alpha",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"control":return Qm(e,t,n);case"convolution":return ci((function(){return function(e,t,n){switch(e.op){case"Conv1D":var r=nm("stride",e,t,n),a=nm("pad",e,t,n),o=nm("dataFormat",e,t,n).toUpperCase(),i=nm("dilation",e,t,n);return[fl(nm("x",e,t,n),nm("filter",e,t,n),r,a,o,i)];case"Conv2D":var u=nm("strides",e,t,n),s=um(e,t,n),c=nm("dataFormat",e,t,n).toUpperCase(),l=nm("dilations",e,t,n);return[Xu(nm("x",e,t,n),nm("filter",e,t,n),[u[1],u[2]],s,c,[l[1],l[2]])];case"_FusedConv2D":var f=av(e,t,n),p=f.stride,d=f.pad,h=f.dataFormat,m=f.dilations,v=f.biasArg,g=f.preluArg,y=f.activationFunc;return[$m({x:nm("x",e,t,n),filter:nm("filter",e,t,n),strides:[p[1],p[2]],pad:d,dataFormat:h,dilations:[m[1],m[2]],bias:v,activation:y,preluActivationWeights:g})];case"FusedDepthwiseConv2dNative":var x=av(e,t,n),b=x.stride,w=x.pad,k=x.dataFormat,C=x.dilations,E=x.biasArg,S=x.preluArg,N=x.activationFunc;return[Jm({x:nm("x",e,t,n),filter:nm("filter",e,t,n),strides:[b[1],b[2]],pad:w,dataFormat:k,dilations:[C[1],C[2]],bias:E,activation:N,preluActivationWeights:S})];case"Conv2DBackpropInput":case"Conv2dTranspose":var T=nm("outputShape",e,t,n),R=nm("strides",e,t,n),I=um(e,t,n);return[pl(nm("x",e,t,n),nm("filter",e,t,n),T,[R[1],R[2]],I)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var _=nm("strides",e,t,n),A=um(e,t,n),O=nm("dilations",e,t,n),D=nm("dataFormat",e,t,n).toUpperCase();return[hl(nm("input",e,t,n),nm("filter",e,t,n),[_[1],_[2]],A,D,[O[1],O[2]])];case"Conv3D":var F=nm("strides",e,t,n),P=nm("pad",e,t,n),L=nm("dataFormat",e,t,n).toUpperCase(),M=nm("dilations",e,t,n);return[ev(nm("x",e,t,n),nm("filter",e,t,n),[F[1],F[2],F[3]],P,L,[M[1],M[2],M[3]])];case"AvgPool":var B=nm("strides",e,t,n),z=nm("pad",e,t,n),V=nm("kernelSize",e,t,n);return[il(nm("x",e,t,n),[V[1],V[2]],[B[1],B[2]],z)];case"MaxPool":var U=nm("strides",e,t,n),W=nm("pad",e,t,n),G=nm("kernelSize",e,t,n);return[Ll(nm("x",e,t,n),[G[1],G[2]],[U[1],U[2]],W)];case"MaxPoolWithArgmax":var j=nm("strides",e,t,n),H=nm("pad",e,t,n),K=nm("kernelSize",e,t,n),q=nm("includeBatchInIndex",e,t,n),X=tv(nm("x",e,t,n),[K[1],K[2]],[j[1],j[2]],H,q);return[X.result,X.indexes];case"AvgPool3D":var Y=nm("strides",e,t,n),Q=nm("pad",e,t,n),$=nm("kernelSize",e,t,n);return[nv(nm("x",e,t,n),[$[1],$[2],$[3]],[Y[1],Y[2],Y[3]],Q)];case"MaxPool3D":var J=nm("strides",e,t,n),Z=nm("pad",e,t,n),ee=nm("kernelSize",e,t,n);return[rv(nm("x",e,t,n),[ee[1],ee[2],ee[3]],[J[1],J[2],J[3]],Z)];case"Dilation2D":var te=nm("strides",e,t,n),ne=nm("pad",e,t,n),re=nm("dilations",e,t,n),ae=te[1],oe=te[2],ie=re[1],ue=re[2];return[ml(nm("x",e,t,n),nm("filter",e,t,n),[ae,oe],ne,[ie,ue],"NHWC")];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"creation":return ci((function(){return function(e,t,n){switch(e.op){case"Fill":var r=nm("shape",e,t,n),a=nm("dtype",e,t,n);return[xo(r,nm("value",e,t,n),a)];case"LinSpace":return[ov(nm("start",e,t,n),nm("stop",e,t,n),nm("num",e,t,n))];case"Multinomial":var o=nm("logits",e,t,n),i=nm("numSamples",e,t,n),u=nm("seed",e,t,n);return[iv(o,i,u)];case"OneHot":var s=nm("indices",e,t,n),c=nm("depth",e,t,n),l=nm("onValue",e,t,n),f=nm("offValue",e,t,n);return[Ml(s,c,l,f)];case"Ones":return[bi(nm("shape",e,t,n),nm("dtype",e,t,n))];case"OnesLike":return[Bl(nm("x",e,t,n))];case"RandomUniform":return[lv(nm("shape",e,t,n),nm("minval",e,t,n),nm("maxval",e,t,n),nm("dtype",e,t,n))];case"Range":return[Qa(nm("start",e,t,n),nm("stop",e,t,n),nm("step",e,t,n),nm("dtype",e,t,n))];case"TruncatedNormal":var p=nm("shape",e,t,n),d=nm("mean",e,t,n),h=nm("stdDev",e,t,n),m=nm("seed",e,t,n);return[fv(p,d,h,nm("dtype",e,t,n),m)];case"Zeros":return[Ya(nm("shape",e,t,n),nm("dtype",e,t,n))];case"ZerosLike":return[co(nm("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"dynamic":return gv(e,t,n);case"evaluation":return ci((function(){return function(e,t,n){if("TopKV2"===e.op){var r=nm("x",e,t,n),a=nm("k",e,t,n),o=nm("sorted",e,t,n),i=Yl(r,a,o);return[i.values,i.indices]}throw TypeError("Node type ".concat(e.op," is not implemented"))}(e,t,n)}));case"image":return ci((function(){return function(e,t,n){switch(e.op){case"ResizeBilinear":var r=nm("images",e,t,n),a=nm("size",e,t,n),o=nm("alignCorners",e,t,n);return[Di.resizeBilinear(r,[a[0],a[1]],o)];case"ResizeNearestNeighbor":var i=nm("images",e,t,n),u=nm("size",e,t,n),s=nm("alignCorners",e,t,n);return[Di.resizeNearestNeighbor(i,[u[0],u[1]],s)];case"CropAndResize":var c=nm("image",e,t,n),l=nm("boxes",e,t,n),f=nm("boxInd",e,t,n),p=nm("cropSize",e,t,n),d=nm("method",e,t,n),h=nm("extrapolationValue",e,t,n);return[Di.cropAndResize(c,l,f,p,d,h)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"graph":return ci((function(){return function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=nm("default",e,t,n);return[rm(e.name,t,n)||r];case"Placeholder":return[rm(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[sm(nm("x",e,t,n))];case"IdentityN":return nm("x",e,t,n).map((function(e){return sm(e)}));case"Shape":return[Xa(nm("x",e,t,n).shape,"int32")];case"ShapeN":return nm("x",e,t,n).map((function(e){return Xa(e.shape)}));case"Size":return[Ja(nm("x",e,t,n).size,"int32")];case"Rank":return[Ja(nm("x",e,t,n).rank,"int32")];case"NoOp":return[Ja(1)];case"Print":var a=nm("x",e,t,n),o=nm("data",e,t,n),i=nm("message",e,t,n),u=nm("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(i);for(var s=0;s<o.length;s++)console.log(Array.prototype.slice.call(o[s].dataSync()).slice(0,u));return[a];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"logical":return ci((function(){return function(e,t,n){switch(e.op){case"Equal":return[Os(nm("a",e,t,n),nm("b",e,t,n))];case"NotEqual":return[ki(nm("a",e,t,n),nm("b",e,t,n))];case"Greater":return[hi(nm("a",e,t,n),nm("b",e,t,n))];case"GreaterEqual":return[qo(nm("a",e,t,n),nm("b",e,t,n))];case"Less":return[Ps(nm("a",e,t,n),nm("b",e,t,n))];case"LessEqual":return[Xo(nm("a",e,t,n),nm("b",e,t,n))];case"LogicalAnd":return[Yo(nm("a",e,t,n),nm("b",e,t,n))];case"LogicalNot":return[uc(nm("a",e,t,n))];case"LogicalOr":return[Fl(nm("a",e,t,n),nm("b",e,t,n))];case"Select":case"SelectV2":return[$o(nm("condition",e,t,n),nm("a",e,t,n),nm("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"matrices":return ci((function(){return function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[mi(nm("a",e,t,n),nm("b",e,t,n),nm("transposeA",e,t,n),nm("transposeB",e,t,n))];case"Transpose":return[Ha(nm("x",e,t,n),nm("perm",e,t,n))];case"_FusedMatMul":var r=E(nm("fusedOps",e,t,n),2),a=r[0],o=r[1],i="biasadd"===a,u="prelu"===o,s=nm("numArgs",e,t,n);if(i){if(u&&2!==s)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!u&&1!==s)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var c=E(nm("args",e,t,n),2),l=c[0],f=c[1];return[Zm({a:nm("a",e,t,n),b:nm("b",e,t,n),transposeA:nm("transposeA",e,t,n),transposeB:nm("transposeB",e,t,n),bias:l,activation:o,preluActivationWeights:f})];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"normalization":return ci((function(){return function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[sl(nm("x",e,t,n),nm("mean",e,t,n),nm("variance",e,t,n),nm("offset",e,t,n),nm("scale",e,t,n),nm("epsilon",e,t,n))];case"LRN":return[_l(nm("x",e,t,n),nm("radius",e,t,n),nm("bias",e,t,n),nm("alpha",e,t,n),nm("beta",e,t,n))];case"Softmax":return[to(nm("x",e,t,n))];case"LogSoftmax":return[Dl(nm("x",e,t,n))];case"SparseToDense":return[xv(nm("sparseIndices",e,t,n),nm("outputShape",e,t,n),nm("sparseValues",e,t,n),nm("defaultValue",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"reduction":return ci((function(){return function(e,t,n){switch(e.op){case"Max":var r=nm("axis",e,t,n),a=nm("keepDims",e,t,n);return[Ka(nm("x",e,t,n),r,a)];case"Mean":var o=nm("axis",e,t,n),i=nm("keepDims",e,t,n);return[wi(nm("x",e,t,n),o,i)];case"Min":var u=nm("axis",e,t,n),s=nm("keepDims",e,t,n);return[Zo(nm("x",e,t,n),u,s)];case"Sum":var c=nm("axis",e,t,n),l=nm("keepDims",e,t,n);return[ri(nm("x",e,t,n),c,l)];case"All":var f=nm("axis",e,t,n),p=nm("keepDims",e,t,n);return[$c(nm("x",e,t,n),f,p)];case"Any":var d=nm("axis",e,t,n),h=nm("keepDims",e,t,n);return[Jc(nm("x",e,t,n),d,h)];case"ArgMax":var m=nm("axis",e,t,n);return[Zc(nm("x",e,t,n),m)];case"ArgMin":var v=nm("axis",e,t,n);return[el(nm("x",e,t,n),v)];case"Prod":var g=nm("axis",e,t,n),y=nm("keepDims",e,t,n);return[Vl(nm("x",e,t,n),g,y)];case"Cumsum":var x=nm("axis",e,t,n),b=nm("exclusive",e,t,n),w=nm("reverse",e,t,n);return[rs(nm("x",e,t,n),x,b,w)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"slice_join":return ci((function(){return function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=nm("n",e,t,n),a=nm("axis",e,t,n),o=nm("tensors",e,t,n);return o=o.slice(0,r),[Oa(o,a)];case"GatherV2":case"Gather":var i=nm("axis",e,t,n),u=nm("x",e,t,n),s=nm("indices",e,t,n);return[Fc(u,ra(s,"int32"),i)];case"ReverseV2":case"Reverse":var c=nm("axis",e,t,n),l=nm("x",e,t,n);return[ho(l,c)];case"Slice":var f=nm("begin",e,t,n),p=nm("size",e,t,n);return[eo(nm("x",e,t,n),f,p)];case"StridedSlice":var d=nm("begin",e,t,n),h=nm("end",e,t,n),m=nm("strides",e,t,n),v=nm("beginMask",e,t,n),g=nm("endMask",e,t,n),y=nm("ellipsisMask",e,t,n),x=nm("newAxisMask",e,t,n),b=nm("shrinkAxisMask",e,t,n),w=nm("x",e,t,n);return[Kl(w,d,h,m,v,g,y,x,b)];case"Pack":return ci((function(){var r=nm("axis",e,t,n),a=nm("tensors",e,t,n),o=a[0].shape,i=ii(a[0]).shape,u=a.map((function(e){var t=$t(e.shape,o);if(!t&&!$t(ii(e).shape,i))throw new Error("the input tensors shape does not match");return t?e:ja(e,o)}));return[ro(u,r)]}));case"Unpack":var k=nm("axis",e,t,n),C=nm("tensor",e,t,n);return io(C,k);case"Tile":var E=nm("reps",e,t,n);return[pi(nm("x",e,t,n),E)];case"Split":case"SplitV":var S=nm("axis",e,t,n),N=nm("numOrSizeSplits",e,t,n),T=nm("x",e,t,n);return so(T,N,S);case"ScatterNd":var R=nm("indices",e,t,n),I=nm("values",e,t,n),_=nm("shape",e,t,n);return[bv(R,I,_)];case"GatherNd":var A=nm("x",e,t,n),O=nm("indices",e,t,n);return[wv(A,O)];case"SparseToDense":var D=nm("sparseIndices",e,t,n),F=nm("outputShape",e,t,n),P=nm("sparseValues",e,t,n),L=nm("defaultValue",e,t,n);return[xv(D,P,F,P.dtype===L.dtype?L:ra(L,P.dtype))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"spectral":return ci((function(){return function(e,t,n){switch(e.op){case"FFT":return[lo(nm("x",e,t,n))];case"IFFT":return[po(nm("x",e,t,n))];case"RFFT":return[fo(nm("x",e,t,n))];case"IRFFT":return[mo(nm("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"transformation":return ci((function(){return function(e,t,n){switch(e.op){case"Cast":return[ra(nm("x",e,t,n),nm("dtype",e,t,n))];case"ExpandDims":var r=nm("axis",e,t,n);return[no(nm("x",e,t,n),r)];case"Squeeze":var a=nm("axis",e,t,n);return[ii(nm("x",e,t,n),a)];case"Reshape":return[ja(nm("x",e,t,n),nm("shape",e,t,n))];case"PadV2":case"Pad":return[vc(nm("x",e,t,n),nm("padding",e,t,n),nm("constantValue",e,t,n))];case"SpaceToBatchND":var o=nm("blockShape",e,t,n),i=nm("paddings",e,t,n);return[Bu(nm("x",e,t,n),o,i)];case"BatchToSpaceND":var u=nm("blockShape",e,t,n),s=nm("crops",e,t,n);return[bc(nm("x",e,t,n),u,s)];case"DepthToSpace":var c=nm("blockSize",e,t,n),l=nm("dataFormat",e,t,n).toUpperCase();return[dl(nm("x",e,t,n),c,l)];case"BroadcastTo":return[Qo(nm("x",e,t,n),nm("shape",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"custom":var r=tm(e.op);if(r&&r.customExecutor)return r.customExecutor(new Vm(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r instanceof Promise?r.then((function(e){return[].concat(e)})):[].concat(r)}var Cv=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};I(this,e),this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return A(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"addTensorList",value:function(e){this.tensorListMap[e.id]=e}},{key:"getTensorList",value:function(e){return this.tensorListMap[e]}},{key:"dispose",value:function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}]),e}();function Ev(e,t,n){for(var r=new Set,a=[],o=null,i=null,u=new Set,s=Object.keys(e).map((function(e){return im(e)[0]})),c=R(t);c.length>0;){var l=c.pop();(Tv(l)||Rv(l))&&null==o&&(i=(o=l).children.map((function(e){return e.name})).filter((function(e){return r.has(e)}))),r.add(l.name),null==n[l.name]&&(-1===s.indexOf(l.name)&&(0!==l.inputs.length?l.inputs.forEach((function(e){u.has(e.name)||(u.add(e.name),c.push(e))})):a.push(l.name)))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:a,dynamicNode:o,syncInputs:i}}var Sv=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],Nv=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function Tv(e){return Sv.indexOf(e.op)>=0}function Rv(e){return Nv.indexOf(e.op)>=0}var Iv=function(){function e(t,n){var r=this;I(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}return A(e,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,R(n)),this._weightMap=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}},{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(e,t){var n=Ev(e,t,this.weightMap),r=n.missingInputs,a=n.dynamicNode,o=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(o,"]"));if(r.length>0){var i=t.map((function(e){return e.name})),u=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(i,"] from the provided inputs ")+"[".concat(u,"]. Missing the following inputs: [").concat(r,"]"))}return function(e,t,n){var r=n.usedNodes,a=n.inputs,o=[];Object.keys(a).map((function(e){return im(e)[0]})).map((function(t){return e.nodes[t]})).forEach((function(e){r.has(e.name)&&o.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&o.push(e)}));for(var i=new Set,u=[];o.length>0;){var s=o.pop();i.add(s.name),t[s.name]||u.push(s),s.children.forEach((function(e){!i.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return i.has(e.name)}))&&o.push(e)}))}return u}(this.graph,this.weightMap,n)}},{key:"execute",value:function(e,t){var n=this;e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[im(e)[0]]})),o=t.map((function(e){return n.graph.nodes[im(e)[0]]})),i=this.getCompilationKey(a,o),u=this.compiledMap.get(i);null==u&&(u=this.compile(e,o),this.compiledMap.set(i,u));var s={},c={};return ci((function(){var r=new Cv(n.weightMap,s,c,n.functionExecutorMap),a=Object.assign({},n.weightMap);Object.keys(e).forEach((function(t){var n=E(im(t),2),r=n[0],o=[];o[n[1]]=e[t],a[r]=o}));for(var o=n.getFrozenTensorIds(a),i={},l=0;l<u.length;l++){var f=u[l];if(!a[f.name]){var p=kv(f,a,r);if(p instanceof Promise)throw new Error("The execution of the op '".concat(f.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");a[f.name]=p,n.checkTensorForDisposal(f.name,f,a,r,o,t,i)}}return null==n.parent&&r.dispose(o),t.map((function(e){return rm(e,a,r)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,o,i){"control"!==t.category&&-1===o.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(i[e.id]=(i[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=function(e,t,n){return t[om(e,n.currentContextId)]}(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!a.has(e.id)){var t=i[e.id];1===t?(e.dispose(),delete i[e.id]):null!=t&&i[e.id]--}}))}})))}},{key:"executeAsync",value:function(){var e=w(N().mark((function e(t,n){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._executeAsync(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_executeAsync",value:function(){var e=w(N().mark((function e(t,n){var r,a,o,i,u,s,c,l,f,p=arguments;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p.length>2&&void 0!==p[2]&&p[2],a=p.length>3&&void 0!==p[3]?p[3]:{},o=p.length>4&&void 0!==p[4]?p[4]:{},r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n)),i=new Cv(this.weightMap,a,o,this.functionExecutorMap),e.next=7,this.executeWithControlFlow(t,i,n,r);case 7:return u=e.sent,s=n.map((function(e){return rm(e,u,i)})),c=s.map((function(e){return e.id})),l=Object.keys(t).map((function(e){return t[e].id})),f=new Set([].concat(R(c),R(l),R(this.weightIds))),Object.keys(u).forEach((function(e){u[e].forEach((function(e){!e||e.isDisposed||f.has(e.id)||e.dispose()}))})),null==this.parent&&i.dispose(f),e.abrupt("return",s);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var e=w(N().mark((function e(t,n,r){var a,o=this;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.reduce((function(e,t,n){return e[o.inputs[n].name]=t,e}),{}),e.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var e=w(N().mark((function e(t,n,r,a){var o,i,u,s,c,l,f,p,d,h,m,v,g,y,x,b,w=this;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Object.keys(t),i=o.map((function(e){return w.graph.nodes[im(e)[0]]})),u=r.map((function(e){return w.graph.nodes[im(e)[0]]})),s=Ev(t,u,this.weightMap),c=s.usedNodes,l=s.missingInputs,f=s.dynamicNode,p=s.syncInputs,d=[].concat(R(i),R(this.graph.weights)).map((function(e){return{node:e,contexts:n.currentContext}})),h=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=E(im(e),2),r=n[0],a=[];a[n[1]]=t[e],h[r]=a})),m={},v=this.getFrozenTensorIds(h),g={};case 10:if(!(d.length>0)){e.next=16;break}return y=this.processStack(i,d,n,h,g,v,r,m,c),e.next=14,Promise.all(y);case 14:e.next=10;break;case 16:if(null!=f||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((x=u.filter((function(e){return!Tv(e)&&!rm(e.name,h,n)})).map((function(e){return e.name}))).length>0)){e.next=22;break}throw b="",null!=f&&(b="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(p,"]")),new Error("Cannot compute the outputs [".concat(x,"] from the provided ")+"inputs [".concat(o,"]. Consider providing the following inputs: ")+"[".concat(l,"]. ").concat(b));case 22:return e.abrupt("return",h);case 23:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"processStack",value:function(e,t,n,r,a,o,i,u,s){for(var c=this,l=[],f=function(){var f=t.pop();n.currentContext=f.contexts;var p="";if("Enter"===f.node.op&&nm("isConstant",f.node,r,n)){var d=E(am(f.node.name,n),1);p=d[0]}if(-1===e.indexOf(f.node)){var h=kv(f.node,r,n);if(!p){var m=E(am(f.node.name,n),1);p=m[0]}var v=n.currentContext;h instanceof Promise?l.push(h.then((function(e){return r[p]=e,n.currentContext=v,c.checkTensorForDisposal(p,f.node,r,n,o,i,u),c.processChildNodes(f.node,t,n,r,a,s),e}))):(r[p]=h,c.checkTensorForDisposal(p,f.node,r,n,o,i,u),c.processChildNodes(f.node,t,n,r,a,s))}else c.processChildNodes(f.node,t,n,r,a,s)};t.length>0;)f();return l}},{key:"processChildNodes",value:function(e,t,n,r,a,o){e.children.forEach((function(e){var i=E(am(e.name,n),1)[0];!a[i]&&o.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!rm(e,r,n)}))&&(a[i]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!rm(e,r,n)}))&&(a[i]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=E(im(n),1)[0],o=t.graph.nodes[a];if(o.attrParams.shape&&o.attrParams.shape.value){var i=o.attrParams.shape.value;Kt(i.length===r.shape.length&&r.shape.every((function(e,t){return-1===i[t]||i[t]===e})),(function(){return"The shape of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be [".concat(i,"], but was ")+"[".concat(r.shape,"]")}))}o.attrParams.dtype&&o.attrParams.dtype.value&&Kt(r.dtype===o.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(o.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(o.attrParams.dtype.value,", but was ").concat(r.dtype)}))}))}},{key:"mapInputs",value:function(e){var t={};for(var n in e){if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n])t[this._signature.inputs[n].name]=e[n];else t[n]=e[n]}return t}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=E(im(e),1)[0];return null==t.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){return null!=t._signature&&null!=t._signature.outputs&&null!=t._signature.outputs[e]?t._signature.outputs[e].name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=E(im(e),1)[0];if(!t.graph.nodes[n])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}]),e}(),_v="?tfjs-format=file",Av="model.json",Ov=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};I(this,e),this.modelUrl=t,this.loadOptions=n,this.version="n/a",null==n&&(this.loadOptions={})}return A(e,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"findIOHandler",value:function(){var e,t,n=this.modelUrl;if(null!=n.load)this.handler=n;else if(null!=this.loadOptions.requestInit)this.handler=va(n,this.loadOptions);else{var r=(e=n,t=this.loadOptions,Ir.getLoadHandlers(e,t));if(0===r.length)r.push(va(n,this.loadOptions));else if(r.length>1)throw new Error("Found more than one (".concat(r.length,") load handlers for ")+"URL '".concat([n],"'"));this.handler=r[0]}}},{key:"load",value:function(){var e=w(N().mark((function e(){var t;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.findIOHandler(),null!=this.handler.load){e.next=3;break}throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 3:return e.next=5,this.handler.load();case 5:return t=e.sent,e.abrupt("return",this.loadSync(t));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadSync",value:function(e){this.artifacts=e;var t=this.artifacts.modelTopology,n={};null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version="".concat(t.versions.producer,".").concat(t.versions.minConsumer);var r=wr(this.artifacts.weightData,this.artifacts.weightSpecs);return this.executor=new Iv(Sm.Instance.transformGraph(t,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),!0}},{key:"save",value:function(){var e=w(N().mark((function e(t,n){var r;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(n=t,0!==(r=Ir.getSaveHandlers(n)).length){e.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(r.length>1)){e.next=8;break}throw new Error("Found more than one (".concat(r.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=r[0];case 9:if(null!=t.save){e.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.abrupt("return",t.save(this.artifacts));case 12:case"end":return e.stop()}var n}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e,t){return this.execute(e,this.outputNodes)}},{key:"normalizeInputs",value:function(e){if(!(e instanceof Gn)&&!Array.isArray(e))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(e.length," input tensors."));return this.inputNodes.reduce((function(t,n,r){return t[n]=e[r],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"execute",value:function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var e=w(N().mark((function e(t,n){var r;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=4,this.executor.executeAsync(t,n);case 4:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose()}}]),e}();function Dv(e){return Fv.apply(this,arguments)}function Fv(){return Fv=w(N().mark((function e(t){var n,r,a=arguments;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},null!=t){e.next=3;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 3:return null==n&&(n={}),n.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t="".concat(t).concat(Av).concat(_v)),r=new Ov(t,n),e.next=8,r.load();case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)}))),Fv.apply(this,arguments)}var Pv=function(){return(Pv=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function Lv(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}s((r=r.apply(e,t||[])).next())}))}function Mv(e,t){var n,r,a,o,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,r=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}}var Bv=function(e){return{startEndTensor:e,startPoint:eo(e,[0,0],[-1,2]),endPoint:eo(e,[0,2],[-1,2])}},zv={strides:[8,16],anchors:[2,6]};function Vv(e,t){var n,r,a;if(e.topLeft instanceof Gn&&e.bottomRight instanceof Gn){var o=E(ci((function(){return[Oa([ao(t-1,e.topLeft.slice(0,1)),e.topLeft.slice(1,1)]),Oa([ao(t-1,e.bottomRight.slice(0,1)),e.bottomRight.slice(1,1)])]})),2);n=o[0],r=o[1],null!=e.landmarks&&(a=ci((function(){var n=ao(Xa([t-1,0]),e.landmarks),r=Xa([1,-1]);return qa(n,r)})))}else{var i=E(e.topLeft,2),u=i[0],s=i[1],c=E(e.bottomRight,2),l=c[0],f=c[1];n=[t-1-u,s],r=[t-1-l,f],null!=e.landmarks&&(a=e.landmarks.map((function(e){return[t-1-e[0],e[1]]})))}var p={topLeft:n,bottomRight:r};return null!=a&&(p.landmarks=a),null!=e.probability&&(p.probability=e.probability instanceof Gn?e.probability.clone():e.probability),p}function Uv(e,t){return ci((function(){return function(e,t){var n=qa(e.startPoint,t),r=qa(e.endPoint,t),a=Da([n,r],1);return Bv(a)}(e.hasOwnProperty("box")?e.box:e,t).startEndTensor.squeeze()}))}var Wv=function(){function e(t,n,r,a,o,i){I(this,e),this.blazeFaceModel=t,this.width=n,this.height=r,this.maxFaces=a,this.anchorsData=function(e,t,n){for(var r=[],a=0;a<n.strides.length;a++)for(var o=n.strides[a],i=Math.floor((t+o-1)/o),u=Math.floor((e+o-1)/o),s=n.anchors[a],c=0;c<i;c++)for(var l=o*(c+.5),f=0;f<u;f++)for(var p=o*(f+.5),d=0;d<s;d++)r.push([p,l]);return r}(n,r,zv),this.anchors=oo(this.anchorsData),this.inputSizeData=[n,r],this.inputSize=Xa([n,r]),this.iouThreshold=o,this.scoreThreshold=i}return A(e,[{key:"getBoundingBoxes",value:function(){var e=w(N().mark((function e(t,n){var r,a,o,i,u,s,c,l,f,p,d,h,m,v,g,y,x=this,b=arguments;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(b.length>2&&void 0!==b[2])||b[2],a=ci((function(){var e=t.resizeBilinear([x.width,x.height]),n=qa(ao(e.div(255),.5),2),r=x.blazeFaceModel.predict(n).squeeze(),a=function(e,t,n){var r=eo(e,[0,1],[-1,2]),a=Ia(r,t),o=eo(e,[0,3],[-1,2]),i=Pa(o,n),u=Pa(a,n),s=Pa(i,2),c=ao(u,s),l=Ia(u,s),f=qa(c,n),p=qa(l,n);return Da([f,p],1)}(r,x.anchors,x.inputSize),o=eo(r,[0,0],[-1,1]);return[r,a,Za(o).squeeze()]})),o=E(a,3),i=o[0],u=o[1],s=o[2],c=console.warn,console.warn=function(){},l=Di.nonMaxSuppression(u,s,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=c,e.next=7,l.array();case 7:if(f=e.sent,l.dispose(),p=f.map((function(e){return eo(u,[e,0],[1,-1])})),e.t0=n,e.t0){e.next=15;break}return e.next=14,Promise.all(p.map(function(){var e=w(N().mark((function e(t){var n;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.array();case 2:return n=e.sent,e.abrupt("return",(t.dispose(),n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 14:p=e.sent;case 15:for(d=t.shape[1],h=t.shape[2],m=n?Pa([h,d],this.inputSize):[h/this.inputSizeData[0],d/this.inputSizeData[1]],v=[],g=function(e){var t=p[e],a=ci((function(){var a=Bv(t instanceof Gn?t:oo(t));if(!r)return a;var o,u=f[e];return o=n?x.anchors.slice([u,0],[1,2]):x.anchorsData[u],{box:a,landmarks:eo(i,[u,5],[1,-1]).squeeze().reshape([6,-1]),probability:eo(s,[u],[1]),anchor:o}}));v.push(a)},y=0;y<p.length;y++)g(y);return e.abrupt("return",(u.dispose(),s.dispose(),i.dispose(),{boxes:v,scaleFactor:m}));case 21:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"estimateFaces",value:function(){var e=w(N().mark((function e(t){var n,r,a,o,i,u,s,c,l,f,p=arguments;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p.length>1&&void 0!==p[1]&&p[1],r=p.length>2&&void 0!==p[2]&&p[2],a=!(p.length>3&&void 0!==p[3])||p[3],o=function(e){return e instanceof Gn?[e.shape[0],e.shape[1]]:[e.height,e.width]}(t),i=E(o,2),u=i[1],s=ci((function(){return t instanceof Gn||(t=xa(t)),t.toFloat().expandDims(0)})),e.next=9,this.getBoundingBoxes(s,n,a);case 9:return c=e.sent,l=c.boxes,f=c.scaleFactor,e.abrupt("return",(s.dispose(),n?l.map((function(e){var t=Uv(e,f),n={topLeft:t.slice([0],[2]),bottomRight:t.slice([2],[2])};if(a){var o=e.landmarks,i=e.probability,s=e.anchor,c=o.add(s).mul(f);n.landmarks=c,n.probability=i}return r&&(n=Vv(n,u)),n})):Promise.all(l.map(function(){var e=w(N().mark((function e(t){var n,o,i,s,c,l,p,d,h,m,v,g,y;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Uv(t,f),!a){e.next=17;break}return e.next=4,Promise.all([t.landmarks,n,t.probability].map(function(){var e=w(N().mark((function e(t){return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.array());case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:i=e.sent,s=E(i,3),c=s[0],l=s[1],p=s[2],d=t.anchor,h=E(f,2),m=h[0],v=h[1],g=c.map((function(e){return[(e[0]+d[0])*m,(e[1]+d[1])*v]})),o={topLeft:l.slice(0,2),bottomRight:l.slice(2),landmarks:g,probability:p},function(e){e.startEndTensor.dispose(),e.startPoint.dispose(),e.endPoint.dispose()}(t.box),t.landmarks.dispose(),t.probability.dispose(),e.next=21;break;case 17:return e.next=19,n.array();case 19:y=e.sent,o={topLeft:y.slice(0,2),bottomRight:y.slice(2)};case 21:return e.abrupt("return",(n.dispose(),r&&(o=Vv(o,u)),o));case 22:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Gv(){return jv.apply(this,arguments)}function jv(){return jv=w(N().mark((function e(){var t,n,r,a,o,i,u,s,c,l,f,p,d=arguments;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d.length>0&&void 0!==d[0]?d[0]:{},n=t.maxFaces,r=void 0===n?10:n,a=t.inputWidth,o=void 0===a?128:a,i=t.inputHeight,u=void 0===i?128:i,s=t.iouThreshold,c=void 0===s?.3:s,l=t.scoreThreshold,f=void 0===l?.75:l,e.next=3,Dv("https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1",{fromTFHub:!0});case 3:return p=e.sent,e.abrupt("return",new Wv(p,o,u,r,c,f));case 5:case"end":return e.stop()}}),e)}))),jv.apply(this,arguments)}var Hv={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],rightEyeIris:[473,474,475,476,477],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],leftEyeIris:[468,469,470,471,472],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]};function Kv(e){return[Math.abs(e.endPoint[0]-e.startPoint[0]),Math.abs(e.endPoint[1]-e.startPoint[1])]}function qv(e){return[e.startPoint[0]+(e.endPoint[0]-e.startPoint[0])/2,e.startPoint[1]+(e.endPoint[1]-e.startPoint[1])/2]}function Xv(e,t){void 0===t&&(t=1.5);var n=qv(e),r=Kv(e),a=[t*r[0]/2,t*r[1]/2];return{startPoint:[n[0]-a[0],n[1]-a[1]],endPoint:[n[0]+a[0],n[1]+a[1]],landmarks:e.landmarks}}var Yv=[[1,0,0],[0,1,0],[0,0,1]];function Qv(e,t){return[[1,0,e],[0,1,t],[0,0,1]]}function $v(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function Jv(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r][t]);return n}function Zv(e,t){for(var n=[],r=e.length,a=0;a<r;a++){n.push([]);for(var o=0;o<r;o++)n[a].push($v(e[a],Jv(t,o)))}return n}function eg(e,t){var n=Math.cos(e),r=Math.sin(e),a=[[n,-r,0],[r,n,0],[0,0,1]],o=Zv(Qv(t[0],t[1]),a);return Zv(o,Qv(-t[0],-t[1]))}var tg=[13,Hv.midwayBetweenEyes[0]],ng=[3,2],rg=Hv.leftEyeLower0,ag=[rg[0],rg[rg.length-1]],og=Hv.rightEyeLower0,ig=[og[0],og[og.length-1]],ug=[{key:"EyeUpper0",indices:[9,10,11,12,13,14,15]},{key:"EyeUpper1",indices:[25,26,27,28,29,30,31]},{key:"EyeUpper2",indices:[41,42,43,44,45,46,47]},{key:"EyeLower0",indices:[0,1,2,3,4,5,6,7,8]},{key:"EyeLower1",indices:[16,17,18,19,20,21,22,23,24]},{key:"EyeLower2",indices:[32,33,34,35,36,37,38,39,40]},{key:"EyeLower3",indices:[54,55,56,57,58,59,60,61,62]},{key:"EyebrowUpper",indices:[63,64,65,66,67,68,69,70]},{key:"EyebrowLower",indices:[48,49,50,51,52,53]}];function sg(e,t,n,r){for(var a=0;a<ug.length;a++){var o=ug[a],i=o.key,u=o.indices,s=Hv[""+n+i];if(null==r||r.includes(i))for(var c=0;c<u.length;c++){var l=u[c];e[s[c]]=[t[l][0],t[l][1],(t[l][2]+e[s[c]][2])/2]}}}var cg=function(){function e(e,t,n,r,a,o,i){this.regionsOfInterest=[],this.runsWithoutFaceDetector=0,this.boundingBoxDetector=e,this.meshDetector=t,this.irisModel=i,this.meshWidth=n,this.meshHeight=r,this.maxContinuousChecks=a,this.maxFaces=o}return e.prototype.transformRawCoords=function(e,t,n,r){var a,o,i,u,s=this,c=Kv({startPoint:t.startPoint,endPoint:t.endPoint}),l=[c[0]/this.meshWidth,c[1]/this.meshHeight],f=e.map((function(e){return[l[0]*(e[0]-s.meshWidth/2),l[1]*(e[1]-s.meshHeight/2),e[2]]})),p=eg(n,[0,0]),d=f.map((function(e){return function(e,t){return[$v(e,t[0]),$v(e,t[1])]}(e,p).concat([e[2]])})),h=(o=[[(a=r)[0][0],a[1][0]],[a[0][1],a[1][1]]],i=[a[0][2],a[1][2]],u=[-$v(o[0],i),-$v(o[1],i)],[o[0].concat(u[0]),o[1].concat(u[1]),[0,0,1]]),m=qv({startPoint:t.startPoint,endPoint:t.endPoint}).concat([1]),v=[$v(m,h[0]),$v(m,h[1])];return d.map((function(e){return[e[0]+v[0],e[1]+v[1],e[2]]}))},e.prototype.getLeftToRightEyeDepthDifference=function(e){return e[ag[0]][2]-e[ig[0]][2]},e.prototype.getEyeBox=function(e,t,n,r,a){void 0===a&&(a=!1);var o=function(e){var t=qv(e),n=Kv(e),r=Math.max.apply(Math,n)/2;return{startPoint:[t[0]-r,t[1]-r],endPoint:[t[0]+r,t[1]+r],landmarks:e.landmarks}}(Xv(this.calculateLandmarksBoundingBox([e[n],e[r]]),2.3)),i=Kv(o),u=Di.cropAndResize(t,[[o.startPoint[1]/this.meshHeight,o.startPoint[0]/this.meshWidth,o.endPoint[1]/this.meshHeight,o.endPoint[0]/this.meshWidth]],[0],[64,64]);return a&&(u=Di.flipLeftRight(u)),{box:o,boxSize:i,crop:u}},e.prototype.getEyeCoords=function(e,t,n,r){void 0===r&&(r=!1);for(var a=[],o=0;o<76;o++){var i=e[3*o],u=e[3*o+1],s=e[3*o+2];a.push([(r?1-i/64:i/64)*n[0]+t.startPoint[0],u/64*n[1]+t.startPoint[1],s])}return{rawCoords:a,iris:a.slice(71)}},e.prototype.getAdjustedIrisCoords=function(e,t,n){var r=e[Hv[n+"EyeUpper0"][3]][2],a=e[Hv[n+"EyeLower0"][4]][2],o=(r+a)/2;return t.map((function(e,t){var n=o;return 2===t?n=r:4===t&&(n=a),[e[0],e[1],n]}))},e.prototype.predict=function(e,t){return Lv(this,void 0,void 0,(function(){var n,r,a,o,i=this;return Mv(this,(function(u){switch(u.label){case 0:return this.shouldUpdateRegionsOfInterest()?[4,this.boundingBoxDetector.getBoundingBoxes(e,!1,!0)]:[3,2];case 1:return n=u.sent(),r=n.boxes,a=n.scaleFactor,0===r.length?(this.regionsOfInterest=[],[2,null]):(o=r.map((function(e){var t,n,r={startPoint:e.box.startPoint.squeeze().arraySync(),endPoint:e.box.endPoint.squeeze().arraySync()},o=Xv((n=a,{startPoint:[(t=r).startPoint[0]*n[0],t.startPoint[1]*n[1]],endPoint:[t.endPoint[0]*n[0],t.endPoint[1]*n[1]]}));return Pv({},o,{landmarks:e.landmarks.arraySync()})})),r.forEach((function(e){null!=e&&null!=e.startPoint&&(e.startEndTensor.dispose(),e.startPoint.dispose(),e.endPoint.dispose())})),this.updateRegionsOfInterest(o),this.runsWithoutFaceDetector=0,[3,3]);case 2:this.runsWithoutFaceDetector++,u.label=3;case 3:return[2,ci((function(){return i.regionsOfInterest.map((function(n,r){var a,o=n.landmarks.length>=468,u=tg[0],s=tg[1];!1===o&&(u=ng[0],s=ng[1]),a=function(e,t){var n;return(n=Math.PI/2-Math.atan2(-(t[1]-e[1]),t[0]-e[0]))-2*Math.PI*Math.floor((n+Math.PI)/(2*Math.PI))}(n.landmarks[u],n.landmarks[s]);var c=qv({startPoint:n.startPoint,endPoint:n.endPoint}),l=[c[0]/e.shape[2],c[1]/e.shape[1]],f=e,p=Yv;0!==a&&(f=Di.rotateWithOffset(e,a,0,l),p=eg(-a,c));var d=function(e,t,n){var r=t.shape[1],a=t.shape[2],o=[[e.startPoint[1]/r,e.startPoint[0]/a,e.endPoint[1]/r,e.endPoint[0]/a]];return Di.cropAndResize(t,o,[0],n)}({startPoint:n.startPoint,endPoint:n.endPoint},f,[i.meshHeight,i.meshWidth]).div(255),h=i.meshDetector.predict(d),m=h[1],v=h[2],g=ja(v,[-1,3]).arraySync();if(t){var y=i.getEyeBox(g,d,ag[0],ag[1],!0),x=y.box,b=y.boxSize,w=y.crop,k=i.getEyeBox(g,d,ig[0],ig[1]),C=k.box,E=k.boxSize,S=k.crop,N=i.irisModel.predict(Oa([w,S])).dataSync(),T=N.slice(0,228),R=i.getEyeCoords(T,x,b,!0),I=R.rawCoords,_=R.iris,A=N.slice(228),O=i.getEyeCoords(A,C,E),D=O.rawCoords,F=O.iris,P=i.getLeftToRightEyeDepthDifference(g);Math.abs(P)<30?(sg(g,I,"left"),sg(g,D,"right")):P<1?sg(g,I,"left",["EyeUpper0","EyeLower0"]):sg(g,D,"right",["EyeUpper0","EyeLower0"]);var L=i.getAdjustedIrisCoords(g,_,"left"),M=i.getAdjustedIrisCoords(g,F,"right");g=g.concat(L).concat(M)}var B=i.transformRawCoords(g,n,a,p),z=oo(B),V=Xv(i.calculateLandmarksBoundingBox(B));return i.regionsOfInterest[r]=Pv({},V,{landmarks:z.arraySync()}),{coords:oo(g,[g.length,3]),scaledCoords:z,box:V,flag:m.squeeze()}}))}))]}}))}))},e.prototype.updateRegionsOfInterest=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=this.regionsOfInterest[t],a=0;if(r&&r.startPoint){var o=n.startPoint,i=o[0],u=o[1],s=n.endPoint,c=s[0],l=s[1],f=r.startPoint,p=f[0],d=f[1],h=r.endPoint,m=h[0],v=h[1],g=Math.max(i,p),y=Math.max(u,d),x=(Math.min(c,m)-g)*(Math.min(l,v)-y);a=x/((c-i)*(l-u)+(m-p)*(v-u)-x)}a<.25&&(this.regionsOfInterest[t]=n)}this.regionsOfInterest=this.regionsOfInterest.slice(0,e.length)},e.prototype.clearRegionOfInterest=function(e){null!=this.regionsOfInterest[e]&&(this.regionsOfInterest=this.regionsOfInterest.slice(0,e).concat(this.regionsOfInterest.slice(e+1)))},e.prototype.shouldUpdateRegionsOfInterest=function(){var e=this.regionsOfInterest.length,t=0===e;return 1===this.maxFaces||t?t:e!==this.maxFaces&&this.runsWithoutFaceDetector>=this.maxContinuousChecks},e.prototype.calculateLandmarksBoundingBox=function(e){var t=e.map((function(e){return e[0]})),n=e.map((function(e){return e[1]}));return{startPoint:[Math.min.apply(Math,t),Math.min.apply(Math,n)],endPoint:[Math.max.apply(Math,t),Math.max.apply(Math,n)]}},e}(),lg=[[.499976992607117,.652534008026123],[.500025987625122,.547487020492554],[.499974012374878,.602371990680695],[.482113003730774,.471979022026062],[.500150978565216,.527155995368958],[.499909996986389,.498252987861633],[.499523013830185,.40106201171875],[.289712011814117,.380764007568359],[.499954998493195,.312398016452789],[.499987006187439,.269918978214264],[.500023007392883,.107050001621246],[.500023007392883,.666234016418457],[.5000159740448,.679224014282227],[.500023007392883,.692348003387451],[.499976992607117,.695277988910675],[.499976992607117,.70593398809433],[.499976992607117,.719385027885437],[.499976992607117,.737019002437592],[.499967992305756,.781370997428894],[.499816000461578,.562981009483337],[.473773002624512,.573909997940063],[.104906998574734,.254140973091125],[.365929991006851,.409575998783112],[.338757991790771,.41302502155304],[.311120003461838,.409460008144379],[.274657994508743,.389131009578705],[.393361985683441,.403706014156342],[.345234006643295,.344011008739471],[.370094001293182,.346076011657715],[.319321990013123,.347265005111694],[.297903001308441,.353591024875641],[.24779200553894,.410809993743896],[.396889001131058,.842755019664764],[.280097991228104,.375599980354309],[.106310002505779,.399955987930298],[.2099249958992,.391353011131287],[.355807989835739,.534406006336212],[.471751004457474,.65040397644043],[.474155008792877,.680191993713379],[.439785003662109,.657229006290436],[.414617002010345,.66654098033905],[.450374007225037,.680860996246338],[.428770989179611,.682690978050232],[.374971002340317,.727805018424988],[.486716985702515,.547628998756409],[.485300987958908,.527395009994507],[.257764995098114,.314490020275116],[.401223003864288,.455172002315521],[.429818987846375,.548614978790283],[.421351999044418,.533740997314453],[.276895999908447,.532056987285614],[.483370006084442,.499586999416351],[.33721199631691,.282882988452911],[.296391993761063,.293242990970612],[.169294998049736,.193813979625702],[.447580009698868,.302609980106354],[.392390012741089,.353887975215912],[.354490011930466,.696784019470215],[.067304998636246,.730105042457581],[.442739009857178,.572826027870178],[.457098007202148,.584792017936707],[.381974011659622,.694710969924927],[.392388999462128,.694203019142151],[.277076005935669,.271932005882263],[.422551989555359,.563233017921448],[.385919004678726,.281364023685455],[.383103013038635,.255840003490448],[.331431001424789,.119714021682739],[.229923993349075,.232002973556519],[.364500999450684,.189113974571228],[.229622006416321,.299540996551514],[.173287004232407,.278747975826263],[.472878992557526,.666198015213013],[.446828007698059,.668527007102966],[.422762006521225,.673889994621277],[.445307999849319,.580065965652466],[.388103008270264,.693961024284363],[.403039008378983,.706539988517761],[.403629004955292,.693953037261963],[.460041999816895,.557139039039612],[.431158006191254,.692366003990173],[.452181994915009,.692366003990173],[.475387006998062,.692366003990173],[.465828001499176,.779190003871918],[.472328990697861,.736225962638855],[.473087012767792,.717857003211975],[.473122000694275,.704625964164734],[.473033010959625,.695277988910675],[.427942007780075,.695277988910675],[.426479011774063,.703539967536926],[.423162013292313,.711845993995667],[.4183090031147,.720062971115112],[.390094995498657,.639572978019714],[.013953999616206,.560034036636353],[.499913990497589,.58014702796936],[.413199990987778,.69539999961853],[.409626007080078,.701822996139526],[.468080013990402,.601534962654114],[.422728985548019,.585985004901886],[.463079988956451,.593783974647522],[.37211999297142,.47341400384903],[.334562003612518,.496073007583618],[.411671012639999,.546965003013611],[.242175996303558,.14767599105835],[.290776997804642,.201445996761322],[.327338010072708,.256527006626129],[.399509996175766,.748921036720276],[.441727995872498,.261676013469696],[.429764986038208,.187834024429321],[.412198007106781,.108901023864746],[.288955003023148,.398952007293701],[.218936994671822,.435410976409912],[.41278201341629,.398970007896423],[.257135003805161,.355440020561218],[.427684992551804,.437960982322693],[.448339998722076,.536936044692993],[.178560003638268,.45755398273468],[.247308000922203,.457193970680237],[.286267012357712,.467674970626831],[.332827985286713,.460712015628815],[.368755996227264,.447206974029541],[.398963987827301,.432654976844788],[.476410001516342,.405806005001068],[.189241006970406,.523923993110657],[.228962004184723,.348950982093811],[.490725994110107,.562400996685028],[.404670000076294,.485132992267609],[.019469000399113,.401564002037048],[.426243007183075,.420431017875671],[.396993011236191,.548797011375427],[.266469985246658,.376977026462555],[.439121007919312,.51895797252655],[.032313998788595,.644356966018677],[.419054001569748,.387154996395111],[.462783008813858,.505746960639954],[.238978996872902,.779744982719421],[.198220998048782,.831938028335571],[.107550002634525,.540755033493042],[.183610007166862,.740257024765015],[.134409993886948,.333683013916016],[.385764002799988,.883153975009918],[.490967005491257,.579378008842468],[.382384985685349,.508572995662689],[.174399003386497,.397670984268188],[.318785011768341,.39623498916626],[.343364000320435,.400596976280212],[.396100014448166,.710216999053955],[.187885001301765,.588537991046906],[.430987000465393,.944064974784851],[.318993002176285,.898285031318665],[.266247987747192,.869701027870178],[.500023007392883,.190576016902924],[.499976992607117,.954452991485596],[.366169989109039,.398822009563446],[.393207013607025,.39553701877594],[.410373002290726,.391080021858215],[.194993004202843,.342101991176605],[.388664990663528,.362284004688263],[.365961998701096,.355970978736877],[.343364000320435,.355356991291046],[.318785011768341,.35834002494812],[.301414996385574,.363156020641327],[.058132998645306,.319076001644135],[.301414996385574,.387449026107788],[.499987989664078,.618434011936188],[.415838003158569,.624195992946625],[.445681989192963,.566076993942261],[.465844005346298,.620640993118286],[.49992299079895,.351523995399475],[.288718998432159,.819945991039276],[.335278987884521,.852819979190826],[.440512001514435,.902418971061707],[.128294005990028,.791940987110138],[.408771991729736,.373893976211548],[.455606997013092,.451801002025604],[.499877005815506,.908990025520325],[.375436991453171,.924192011356354],[.11421000212431,.615022003650665],[.448662012815475,.695277988910675],[.4480200111866,.704632043838501],[.447111994028091,.715808033943176],[.444831997156143,.730794012546539],[.430011987686157,.766808986663818],[.406787008047104,.685672998428345],[.400738000869751,.681069016456604],[.392399996519089,.677703022956848],[.367855995893478,.663918972015381],[.247923001646996,.601333022117615],[.452769994735718,.420849978923798],[.43639200925827,.359887003898621],[.416164010763168,.368713974952698],[.413385987281799,.692366003990173],[.228018000721931,.683571994304657],[.468268007040024,.352671027183533],[.411361992359161,.804327011108398],[.499989002943039,.469825029373169],[.479153990745544,.442654013633728],[.499974012374878,.439637005329132],[.432112008333206,.493588984012604],[.499886006116867,.866917014122009],[.49991300702095,.821729004383087],[.456548988819122,.819200992584229],[.344549000263214,.745438992977142],[.37890899181366,.574010014533997],[.374292999505997,.780184984207153],[.319687992334366,.570737957954407],[.357154995203018,.604269981384277],[.295284003019333,.621580958366394],[.447750002145767,.862477004528046],[.410986006259918,.508723020553589],[.31395098567009,.775308012962341],[.354128003120422,.812552988529205],[.324548006057739,.703992962837219],[.189096003770828,.646299958229065],[.279776990413666,.71465802192688],[.1338230073452,.682700991630554],[.336768001317978,.644733011722565],[.429883986711502,.466521978378296],[.455527991056442,.548622965812683],[.437114000320435,.558896005153656],[.467287987470627,.529924988746643],[.414712011814117,.335219979286194],[.37704598903656,.322777986526489],[.344107985496521,.320150971412659],[.312875986099243,.32233202457428],[.283526003360748,.333190023899078],[.241245999932289,.382785975933075],[.102986000478268,.468762993812561],[.267612010240555,.424560010433197],[.297879010438919,.433175981044769],[.333433985710144,.433878004550934],[.366427004337311,.426115989685059],[.396012008190155,.416696012020111],[.420121014118195,.41022801399231],[.007561000064015,.480777025222778],[.432949006557465,.569517970085144],[.458638995885849,.479089021682739],[.473466008901596,.545744001865387],[.476087987422943,.563830018043518],[.468472003936768,.555056989192963],[.433990985155106,.582361996173859],[.483518004417419,.562983989715576],[.482482999563217,.57784903049469],[.42645001411438,.389798998832703],[.438998997211456,.39649498462677],[.450067013502121,.400434017181396],[.289712011814117,.368252992630005],[.276670008897781,.363372981548309],[.517862021923065,.471948027610779],[.710287988185883,.380764007568359],[.526226997375488,.573909997940063],[.895093023777008,.254140973091125],[.634069979190826,.409575998783112],[.661242008209229,.41302502155304],[.688880026340485,.409460008144379],[.725341975688934,.389131009578705],[.606630027294159,.40370500087738],[.654766023159027,.344011008739471],[.629905998706818,.346076011657715],[.680678009986877,.347265005111694],[.702096998691559,.353591024875641],[.75221198797226,.410804986953735],[.602918028831482,.842862963676453],[.719901978969574,.375599980354309],[.893692970275879,.399959981441498],[.790081977844238,.391354024410248],[.643998026847839,.534487962722778],[.528249025344849,.65040397644043],[.525849997997284,.680191040039062],[.560214996337891,.657229006290436],[.585384011268616,.66654098033905],[.549625992774963,.680860996246338],[.57122802734375,.682691991329193],[.624852001667023,.72809898853302],[.513050019741058,.547281980514526],[.51509702205658,.527251958847046],[.742246985435486,.314507007598877],[.598631024360657,.454979002475739],[.570338010787964,.548575043678284],[.578631997108459,.533622980117798],[.723087012767792,.532054007053375],[.516445994377136,.499638974666595],[.662801027297974,.282917976379395],[.70362401008606,.293271005153656],[.830704987049103,.193813979625702],[.552385985851288,.302568018436432],[.607609987258911,.353887975215912],[.645429015159607,.696707010269165],[.932694971561432,.730105042457581],[.557260990142822,.572826027870178],[.542901992797852,.584792017936707],[.6180260181427,.694710969924927],[.607590973377228,.694203019142151],[.722943007946014,.271963000297546],[.577413976192474,.563166975975037],[.614082992076874,.281386971473694],[.616907000541687,.255886018276215],[.668509006500244,.119913995265961],[.770092010498047,.232020974159241],[.635536015033722,.189248979091644],[.77039098739624,.299556016921997],[.826722025871277,.278755009174347],[.527121007442474,.666198015213013],[.553171992301941,.668527007102966],[.577238023281097,.673889994621277],[.554691970348358,.580065965652466],[.611896991729736,.693961024284363],[.59696102142334,.706539988517761],[.596370995044708,.693953037261963],[.539958000183105,.557139039039612],[.568841993808746,.692366003990173],[.547818005084991,.692366003990173],[.52461302280426,.692366003990173],[.534089982509613,.779141008853912],[.527670979499817,.736225962638855],[.526912987232208,.717857003211975],[.526877999305725,.704625964164734],[.526966989040375,.695277988910675],[.572058022022247,.695277988910675],[.573521018028259,.703539967536926],[.57683801651001,.711845993995667],[.581691026687622,.720062971115112],[.609944999217987,.639909982681274],[.986046016216278,.560034036636353],[.5867999792099,.69539999961853],[.590372025966644,.701822996139526],[.531915009021759,.601536989212036],[.577268004417419,.585934996604919],[.536915004253387,.593786001205444],[.627542972564697,.473352015018463],[.665585994720459,.495950996875763],[.588353991508484,.546862006187439],[.757824003696442,.14767599105835],[.709249973297119,.201507985591888],[.672684013843536,.256581008434296],[.600408971309662,.74900496006012],[.55826598405838,.261672019958496],[.570303976535797,.187870979309082],[.588165998458862,.109044015407562],[.711045026779175,.398952007293701],[.781069993972778,.435405015945435],[.587247014045715,.398931980133057],[.742869973182678,.355445981025696],[.572156012058258,.437651991844177],[.55186802148819,.536570012569427],[.821442008018494,.457556009292603],[.752701997756958,.457181990146637],[.71375697851181,.467626988887787],[.66711300611496,.460672974586487],[.631101012229919,.447153985500336],[.6008620262146,.432473003864288],[.523481011390686,.405627012252808],[.810747981071472,.523926019668579],[.771045982837677,.348959028720856],[.509127020835876,.562718033790588],[.595292985439301,.485023975372314],[.980530977249146,.401564002037048],[.573499977588654,.420000016689301],[.602994978427887,.548687994480133],[.733529984951019,.376977026462555],[.560611009597778,.519016981124878],[.967685997486115,.644356966018677],[.580985009670258,.387160003185272],[.537728011608124,.505385041236877],[.760966002941132,.779752969741821],[.801778972148895,.831938028335571],[.892440974712372,.54076099395752],[.816350996494293,.740260004997253],[.865594983100891,.333687007427216],[.614073991775513,.883246004581451],[.508952975273132,.579437971115112],[.617941975593567,.508316040039062],[.825608015060425,.397674977779388],[.681214988231659,.39623498916626],[.656635999679565,.400596976280212],[.603900015354156,.710216999053955],[.81208598613739,.588539004325867],[.56801301240921,.944564998149872],[.681007981300354,.898285031318665],[.733752012252808,.869701027870178],[.633830010890961,.398822009563446],[.606792986392975,.39553701877594],[.589659988880157,.391062021255493],[.805015981197357,.342108011245728],[.611334979534149,.362284004688263],[.634037971496582,.355970978736877],[.656635999679565,.355356991291046],[.681214988231659,.35834002494812],[.698584973812103,.363156020641327],[.941866993904114,.319076001644135],[.698584973812103,.387449026107788],[.584177017211914,.624107003211975],[.554318010807037,.566076993942261],[.534153997898102,.62064003944397],[.711217999458313,.819975018501282],[.664629995822906,.852871000766754],[.559099972248077,.902631998062134],[.871706008911133,.791940987110138],[.591234028339386,.373893976211548],[.544341027736664,.451583981513977],[.624562978744507,.924192011356354],[.88577002286911,.615028977394104],[.551338016986847,.695277988910675],[.551980018615723,.704632043838501],[.552887976169586,.715808033943176],[.555167973041534,.730794012546539],[.569944024085999,.767035007476807],[.593203008174896,.685675978660583],[.599261999130249,.681069016456604],[.607599973678589,.677703022956848],[.631937980651855,.663500010967255],[.752032995223999,.601315021514893],[.547226011753082,.420395016670227],[.563543975353241,.359827995300293],[.583841025829315,.368713974952698],[.586614012718201,.692366003990173],[.771915018558502,.683578014373779],[.531597018241882,.352482974529266],[.588370978832245,.804440975189209],[.52079701423645,.442565023899078],[.567984998226166,.493479013442993],[.543282985687256,.819254994392395],[.655317008495331,.745514988899231],[.621008992195129,.574018001556396],[.625559985637665,.78031200170517],[.680198013782501,.570719003677368],[.64276397228241,.604337990283966],[.704662978649139,.621529996395111],[.552012026309967,.862591981887817],[.589071989059448,.508637011051178],[.685944974422455,.775357007980347],[.645735025405884,.812640011310577],[.675342977046967,.703978002071381],[.810858011245728,.646304965019226],[.72012197971344,.714666962623596],[.866151988506317,.682704985141754],[.663187026977539,.644596993923187],[.570082008838654,.466325998306274],[.544561982154846,.548375964164734],[.562758982181549,.558784961700439],[.531987011432648,.530140042304993],[.585271000862122,.335177004337311],[.622952997684479,.32277899980545],[.655896008014679,.320163011550903],[.687132000923157,.322345972061157],[.716481983661652,.333200991153717],[.758756995201111,.382786989212036],[.897013008594513,.468769013881683],[.732392013072968,.424547016620636],[.70211398601532,.433162987232208],[.66652500629425,.433866024017334],[.633504986763,.426087975502014],[.603875994682312,.416586995124817],[.579657971858978,.409945011138916],[.992439985275269,.480777025222778],[.567192018032074,.569419980049133],[.54136598110199,.478899002075195],[.526564002037048,.546118021011353],[.523913025856018,.563830018043518],[.531529009342194,.555056989192963],[.566035985946655,.582329034805298],[.51631098985672,.563053965568542],[.5174720287323,.577877044677734],[.573594987392426,.389806985855103],[.560697972774506,.395331978797913],[.549755990505219,.399751007556915],[.710287988185883,.368252992630005],[.723330020904541,.363372981548309]];function fg(e){return Lv(this,void 0,void 0,(function(){var t,n,r,a,o,i,u,s,c,l,f,p,d,h,m;return Mv(this,(function(v){switch(v.label){case 0:return t=e.maxContinuousChecks,n=void 0===t?5:t,r=e.detectionConfidence,a=void 0===r?.9:r,o=e.maxFaces,i=void 0===o?10:o,u=e.iouThreshold,s=void 0===u?.3:u,c=e.scoreThreshold,l=void 0===c?.75:c,f=e.shouldLoadIrisModel,p=void 0===f||f,d=e.modelUrl,h=e.irisModelUrl,p?[4,Promise.all([pg(i,s,l),dg(d),hg(h)])]:[3,2];case 1:return m=v.sent(),[3,4];case 2:return[4,Promise.all([pg(i,s,l),dg(d)])];case 3:m=v.sent(),v.label=4;case 4:return[2,new gg(m[0],m[1],n,a,i,p?m[2]:null)]}}))}))}function pg(e,t,n){return Lv(this,void 0,void 0,(function(){return Mv(this,(function(r){return[2,Gv({maxFaces:e,iouThreshold:t,scoreThreshold:n})]}))}))}function dg(e){return Lv(this,void 0,void 0,(function(){return Mv(this,(function(t){return null!=e?[2,Dv(e)]:[2,Dv("https://tfhub.dev/mediapipe/tfjs-model/facemesh/1/default/1",{fromTFHub:!0})]}))}))}function hg(e){return Lv(this,void 0,void 0,(function(){return Mv(this,(function(t){return null!=e?[2,Dv(e)]:[2,Dv("https://tfhub.dev/mediapipe/tfjs-model/iris/1/default/2",{fromTFHub:!0})]}))}))}function mg(e,t){if(e.mesh instanceof Gn){var n=ci((function(){var n=Xa([t-1,0,0]),r=Xa([1,-1,1]);return ci((function(){return[Oa([ao(t-1,e.boundingBox.topLeft.slice(0,1)),e.boundingBox.topLeft.slice(1,1)]),Oa([ao(t-1,e.boundingBox.bottomRight.slice(0,1)),e.boundingBox.bottomRight.slice(1,1)]),ao(n,e.mesh).mul(r),ao(n,e.scaledMesh).mul(r)]}))})),r=n[0],a=n[1],o=n[2],i=n[3];return Object.assign({},e,{boundingBox:{topLeft:r,bottomRight:a},mesh:o,scaledMesh:i})}return Object.assign({},e,{boundingBox:{topLeft:[t-1-e.boundingBox.topLeft[0],e.boundingBox.topLeft[1]],bottomRight:[t-1-e.boundingBox.bottomRight[0],e.boundingBox.bottomRight[1]]},mesh:e.mesh.map((function(e){var n=e.slice(0);return n[0]=t-1-e[0],n})),scaledMesh:e.scaledMesh.map((function(e){var n=e.slice(0);return n[0]=t-1-e[0],n}))})}var vg,gg=function(){function e(e,t,n,r,a,o){this.pipeline=new cg(e,t,192,192,n,a,o),this.detectionConfidence=r}return e.getAnnotations=function(){return Hv},e.getUVCoords=function(){return lg},e.prototype.estimateFaces=function(e){return Lv(this,void 0,void 0,(function(){var t,n,r,a,o,i,u,s,c,l,f,p,d=this;return Mv(this,(function(h){switch(h.label){case 0:if(t=e.returnTensors,n=void 0!==t&&t,r=e.flipHorizontal,a=void 0!==r&&r,o=e.predictIrises,i=void 0===o||o,u=e.input,i&&null==this.pipeline.irisModel)throw new Error("The iris model was not loaded as part of facemesh. Please initialize the model with facemesh.load({shouldLoadIrisModel: true}).");return s=function(e){return e instanceof Gn?[e.shape[0],e.shape[1]]:[e.height,e.width]}(u),c=s[1],l=ci((function(){return u instanceof Gn||(u=xa(u)),u.toFloat().expandDims(0)})),"webgl"!==ir.backendName?[3,2]:(p=P().get("WEBGL_PACK_DEPTHWISECONV"),P().set("WEBGL_PACK_DEPTHWISECONV",!0),[4,this.pipeline.predict(l,i)]);case 1:return f=h.sent(),P().set("WEBGL_PACK_DEPTHWISECONV",p),[3,4];case 2:return[4,this.pipeline.predict(l,i)];case 3:f=h.sent(),h.label=4;case 4:return l.dispose(),null!=f&&f.length>0?[2,Promise.all(f.map((function(e,t){return Lv(d,void 0,void 0,(function(){var r,o,u,s,l,f,p,d,h,m,v,g,y,x,b=this;return Mv(this,(function(w){switch(w.label){case 0:return r=e.coords,o=e.scaledCoords,u=e.box,s=e.flag,l=[s],n||(l=l.concat([r,o])),[4,Promise.all(l.map((function(e){return Lv(b,void 0,void 0,(function(){return Mv(this,(function(t){return[2,e.array()]}))}))})))];case 1:if(f=w.sent(),p=f[0],s.dispose(),p<this.detectionConfidence&&this.pipeline.clearRegionOfInterest(t),n)return d={faceInViewConfidence:p,mesh:r,scaledMesh:o,boundingBox:{topLeft:Xa(u.startPoint),bottomRight:Xa(u.endPoint)}},a?[2,mg(d,c)]:[2,d];for(x in h=f.slice(1),m=h[0],v=h[1],o.dispose(),r.dispose(),g={faceInViewConfidence:p,boundingBox:{topLeft:u.startPoint,bottomRight:u.endPoint},mesh:m,scaledMesh:v},a&&(g=mg(g,c)),y={},Hv)(i||!1===x.includes("Iris"))&&(y[x]=Hv[x].map((function(e){return g.scaledMesh[e]})));return g.annotations=y,[2,g]}}))}))})))]:[2,[]]}}))}))},e}();!function(){function e(){}e.prototype.estimateFaces=function(e){throw new Error("estimateFaces is not yet implemented.")}}();function yg(e,t){return void 0===e&&(e=vg.mediapipeFacemesh),void 0===t&&(t={}),Lv(this,void 0,void 0,(function(){return Mv(this,(function(n){if(e===vg.mediapipeFacemesh)return[2,fg(t)];throw new Error(e+" is not a valid package name.")}))}))}(vg||(vg={})).mediapipeFacemesh="mediapipe-facemesh";var xg=n(97),bg=n.n(xg),wg=[127,34,139,11,0,37,232,231,120,72,37,39,128,121,47,232,121,128,104,69,67,175,171,148,157,154,155,118,50,101,73,39,40,9,151,108,48,115,131,194,204,211,74,40,185,80,42,183,40,92,186,230,229,118,202,212,214,83,18,17,76,61,146,160,29,30,56,157,173,106,204,194,135,214,192,203,165,98,21,71,68,51,45,4,144,24,23,77,146,91,205,50,187,201,200,18,91,106,182,90,91,181,85,84,17,206,203,36,148,171,140,92,40,39,193,189,244,159,158,28,247,246,161,236,3,196,54,68,104,193,168,8,117,228,31,189,193,55,98,97,99,126,47,100,166,79,218,155,154,26,209,49,131,135,136,150,47,126,217,223,52,53,45,51,134,211,170,140,67,69,108,43,106,91,230,119,120,226,130,247,63,53,52,238,20,242,46,70,156,78,62,96,46,53,63,143,34,227,173,155,133,123,117,111,44,125,19,236,134,51,216,206,205,154,153,22,39,37,167,200,201,208,36,142,100,57,212,202,20,60,99,28,158,157,35,226,113,160,159,27,204,202,210,113,225,46,43,202,204,62,76,77,137,123,116,41,38,72,203,129,142,64,98,240,49,102,64,41,73,74,212,216,207,42,74,184,169,170,211,170,149,176,105,66,69,122,6,168,123,147,187,96,77,90,65,55,107,89,90,180,101,100,120,63,105,104,93,137,227,15,86,85,129,102,49,14,87,86,55,8,9,100,47,121,145,23,22,88,89,179,6,122,196,88,95,96,138,172,136,215,58,172,115,48,219,42,80,81,195,3,51,43,146,61,171,175,199,81,82,38,53,46,225,144,163,110,246,33,7,52,65,66,229,228,117,34,127,234,107,108,69,109,108,151,48,64,235,62,78,191,129,209,126,111,35,143,163,161,246,117,123,50,222,65,52,19,125,141,221,55,65,3,195,197,25,7,33,220,237,44,70,71,139,122,193,245,247,130,33,71,21,162,153,158,159,170,169,150,188,174,196,216,186,92,144,160,161,2,97,167,141,125,241,164,167,37,72,38,12,145,159,160,38,82,13,63,68,71,226,35,111,158,153,154,101,50,205,206,92,165,209,198,217,165,167,97,220,115,218,133,112,243,239,238,241,214,135,169,190,173,133,171,208,32,125,44,237,86,87,178,85,86,179,84,85,180,83,84,181,201,83,182,137,93,132,76,62,183,61,76,184,57,61,185,212,57,186,214,207,187,34,143,156,79,239,237,123,137,177,44,1,4,201,194,32,64,102,129,213,215,138,59,166,219,242,99,97,2,94,141,75,59,235,24,110,228,25,130,226,23,24,229,22,23,230,26,22,231,112,26,232,189,190,243,221,56,190,28,56,221,27,28,222,29,27,223,30,29,224,247,30,225,238,79,20,166,59,75,60,75,240,147,177,215,20,79,166,187,147,213,112,233,244,233,128,245,128,114,188,114,217,174,131,115,220,217,198,236,198,131,134,177,132,58,143,35,124,110,163,7,228,110,25,356,389,368,11,302,267,452,350,349,302,303,269,357,343,277,452,453,357,333,332,297,175,152,377,384,398,382,347,348,330,303,304,270,9,336,337,278,279,360,418,262,431,304,408,409,310,415,407,270,409,410,450,348,347,422,430,434,313,314,17,306,307,375,387,388,260,286,414,398,335,406,418,364,367,416,423,358,327,251,284,298,281,5,4,373,374,253,307,320,321,425,427,411,421,313,18,321,405,406,320,404,405,315,16,17,426,425,266,377,400,369,322,391,269,417,465,464,386,257,258,466,260,388,456,399,419,284,332,333,417,285,8,346,340,261,413,441,285,327,460,328,355,371,329,392,439,438,382,341,256,429,420,360,364,394,379,277,343,437,443,444,283,275,440,363,431,262,369,297,338,337,273,375,321,450,451,349,446,342,467,293,334,282,458,461,462,276,353,383,308,324,325,276,300,293,372,345,447,382,398,362,352,345,340,274,1,19,456,248,281,436,427,425,381,256,252,269,391,393,200,199,428,266,330,329,287,273,422,250,462,328,258,286,384,265,353,342,387,259,257,424,431,430,342,353,276,273,335,424,292,325,307,366,447,345,271,303,302,423,266,371,294,455,460,279,278,294,271,272,304,432,434,427,272,407,408,394,430,431,395,369,400,334,333,299,351,417,168,352,280,411,325,319,320,295,296,336,319,403,404,330,348,349,293,298,333,323,454,447,15,16,315,358,429,279,14,15,316,285,336,9,329,349,350,374,380,252,318,402,403,6,197,419,318,319,325,367,364,365,435,367,397,344,438,439,272,271,311,195,5,281,273,287,291,396,428,199,311,271,268,283,444,445,373,254,339,263,466,249,282,334,296,449,347,346,264,447,454,336,296,299,338,10,151,278,439,455,292,407,415,358,371,355,340,345,372,390,249,466,346,347,280,442,443,282,19,94,370,441,442,295,248,419,197,263,255,359,440,275,274,300,383,368,351,412,465,263,467,466,301,368,389,380,374,386,395,378,379,412,351,419,436,426,322,373,390,388,2,164,393,370,462,461,164,0,267,302,11,12,374,373,387,268,12,13,293,300,301,446,261,340,385,384,381,330,266,425,426,423,391,429,355,437,391,327,326,440,457,438,341,382,362,459,457,461,434,430,394,414,463,362,396,369,262,354,461,457,316,403,402,315,404,403,314,405,404,313,406,405,421,418,406,366,401,361,306,408,407,291,409,408,287,410,409,432,436,410,434,416,411,264,368,383,309,438,457,352,376,401,274,275,4,421,428,262,294,327,358,433,416,367,289,455,439,462,370,326,2,326,370,305,460,455,254,449,448,255,261,446,253,450,449,252,451,450,256,452,451,341,453,452,413,464,463,441,413,414,258,442,441,257,443,442,259,444,443,260,445,444,467,342,445,459,458,250,289,392,290,290,328,460,376,433,435,250,290,392,411,416,433,341,463,464,453,464,465,357,465,412,343,412,399,360,363,440,437,399,456,420,456,363,401,435,288,372,383,353,339,255,249,448,261,255,133,243,190,133,155,112,33,246,247,33,130,25,398,384,286,362,398,414,362,463,341,263,359,467,263,249,255,466,467,260,75,60,166,238,239,79,162,127,139,72,11,37,121,232,120,73,72,39,114,128,47,233,232,128,103,104,67,152,175,148,173,157,155,119,118,101,74,73,40,107,9,108,49,48,131,32,194,211,184,74,185,191,80,183,185,40,186,119,230,118,210,202,214,84,83,17,77,76,146,161,160,30,190,56,173,182,106,194,138,135,192,129,203,98,54,21,68,5,51,4,145,144,23,90,77,91,207,205,187,83,201,18,181,91,182,180,90,181,16,85,17,205,206,36,176,148,140,165,92,39,245,193,244,27,159,28,30,247,161,174,236,196,103,54,104,55,193,8,111,117,31,221,189,55,240,98,99,142,126,100,219,166,218,112,155,26,198,209,131,169,135,150,114,47,217,224,223,53,220,45,134,32,211,140,109,67,108,146,43,91,231,230,120,113,226,247,105,63,52,241,238,242,124,46,156,95,78,96,70,46,63,116,143,227,116,123,111,1,44,19,3,236,51,207,216,205,26,154,22,165,39,167,199,200,208,101,36,100,43,57,202,242,20,99,56,28,157,124,35,113,29,160,27,211,204,210,124,113,46,106,43,204,96,62,77,227,137,116,73,41,72,36,203,142,235,64,240,48,49,64,42,41,74,214,212,207,183,42,184,210,169,211,140,170,176,104,105,69,193,122,168,50,123,187,89,96,90,66,65,107,179,89,180,119,101,120,68,63,104,234,93,227,16,15,85,209,129,49,15,14,86,107,55,9,120,100,121,153,145,22,178,88,179,197,6,196,89,88,96,135,138,136,138,215,172,218,115,219,41,42,81,5,195,51,57,43,61,208,171,199,41,81,38,224,53,225,24,144,110,105,52,66,118,229,117,227,34,234,66,107,69,10,109,151,219,48,235,183,62,191,142,129,126,116,111,143,7,163,246,118,117,50,223,222,52,94,19,141,222,221,65,196,3,197,45,220,44,156,70,139,188,122,245,139,71,162,145,153,159,149,170,150,122,188,196,206,216,92,163,144,161,164,2,167,242,141,241,0,164,37,11,72,12,144,145,160,12,38,13,70,63,71,31,226,111,157,158,154,36,101,205,203,206,165,126,209,217,98,165,97,237,220,218,237,239,241,210,214,169,140,171,32,241,125,237,179,86,178,180,85,179,181,84,180,182,83,181,194,201,182,177,137,132,184,76,183,185,61,184,186,57,185,216,212,186,192,214,187,139,34,156,218,79,237,147,123,177,45,44,4,208,201,32,98,64,129,192,213,138,235,59,219,141,242,97,97,2,141,240,75,235,229,24,228,31,25,226,230,23,229,231,22,230,232,26,231,233,112,232,244,189,243,189,221,190,222,28,221,223,27,222,224,29,223,225,30,224,113,247,225,99,60,240,213,147,215,60,20,166,192,187,213,243,112,244,244,233,245,245,128,188,188,114,174,134,131,220,174,217,236,236,198,134,215,177,58,156,143,124,25,110,7,31,228,25,264,356,368,0,11,267,451,452,349,267,302,269,350,357,277,350,452,357,299,333,297,396,175,377,381,384,382,280,347,330,269,303,270,151,9,337,344,278,360,424,418,431,270,304,409,272,310,407,322,270,410,449,450,347,432,422,434,18,313,17,291,306,375,259,387,260,424,335,418,434,364,416,391,423,327,301,251,298,275,281,4,254,373,253,375,307,321,280,425,411,200,421,18,335,321,406,321,320,405,314,315,17,423,426,266,396,377,369,270,322,269,413,417,464,385,386,258,248,456,419,298,284,333,168,417,8,448,346,261,417,413,285,326,327,328,277,355,329,309,392,438,381,382,256,279,429,360,365,364,379,355,277,437,282,443,283,281,275,363,395,431,369,299,297,337,335,273,321,348,450,349,359,446,467,283,293,282,250,458,462,300,276,383,292,308,325,283,276,293,264,372,447,346,352,340,354,274,19,363,456,281,426,436,425,380,381,252,267,269,393,421,200,428,371,266,329,432,287,422,290,250,328,385,258,384,446,265,342,386,387,257,422,424,430,445,342,276,422,273,424,306,292,307,352,366,345,268,271,302,358,423,371,327,294,460,331,279,294,303,271,304,436,432,427,304,272,408,395,394,431,378,395,400,296,334,299,6,351,168,376,352,411,307,325,320,285,295,336,320,319,404,329,330,349,334,293,333,366,323,447,316,15,315,331,358,279,317,14,316,8,285,9,277,329,350,253,374,252,319,318,403,351,6,419,324,318,325,397,367,365,288,435,397,278,344,439,310,272,311,248,195,281,375,273,291,175,396,199,312,311,268,276,283,445,390,373,339,295,282,296,448,449,346,356,264,454,337,336,299,337,338,151,294,278,455,308,292,415,429,358,355,265,340,372,388,390,466,352,346,280,295,442,282,354,19,370,285,441,295,195,248,197,457,440,274,301,300,368,417,351,465,251,301,389,385,380,386,394,395,379,399,412,419,410,436,322,387,373,388,326,2,393,354,370,461,393,164,267,268,302,12,386,374,387,312,268,13,298,293,301,265,446,340,380,385,381,280,330,425,322,426,391,420,429,437,393,391,326,344,440,438,458,459,461,364,434,394,428,396,262,274,354,457,317,316,402,316,315,403,315,314,404,314,313,405,313,421,406,323,366,361,292,306,407,306,291,408,291,287,409,287,432,410,427,434,411,372,264,383,459,309,457,366,352,401,1,274,4,418,421,262,331,294,358,435,433,367,392,289,439,328,462,326,94,2,370,289,305,455,339,254,448,359,255,446,254,253,449,253,252,450,252,256,451,256,341,452,414,413,463,286,441,414,286,258,441,258,257,442,257,259,443,259,260,444,260,467,445,309,459,250,305,289,290,305,290,460,401,376,435,309,250,392,376,411,433,453,341,464,357,453,465,343,357,412,437,343,399,344,360,440,420,437,456,360,420,363,361,401,288,265,372,353,390,339,249,339,448,255],kg=function(e,t,n){var r=new Path2D;r.moveTo(t[0][0],t[0][1]);for(var a=1;a<t.length;a++){var o=t[a];r.lineTo(o[0],o[1])}n&&r.closePath(),e.strokeStyle="grey",e.stroke(r)},Cg=function(e,t){e.length>0&&e.forEach((function(e){for(var n=e.scaledMesh,r=0;r<wg.length/3;r++){var a=[wg[3*r],wg[3*r+1],wg[3*r+2]].map((function(e){return n[e]}));kg(t,a,!0)}for(var o=0;o<n.length;o++){var i=n[o][0],u=n[o][1];t.beginPath(),t.arc(i,u,1,0,3*Math.PI),t.fillStyle="aqua",t.fill()}}))},Eg=n(184);var Sg=function(){var e=(0,y.useRef)(null),t=(0,y.useRef)(null),n=E((0,y.useState)(!1),2),r=n[0],a=n[1],o=function(){var e=w(N().mark((function e(){var t;return N().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a(!r),e.next=3,yg(vg.mediapipeFacemesh);case 3:t=e.sent,setInterval((function(){i(t)}),1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var n=w(N().mark((function n(r){var a,o,i,u,s;return N().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("undefined"===typeof e.current||null===e.current||4!==e.current.video.readyState){n.next=13;break}return a=e.current.video,o=e.current.video.videoWidth,i=e.current.video.videoHeight,e.current.video.width=o,e.current.video.height=i,t.current.width=o,t.current.height=i,n.next=10,r.estimateFaces({input:a});case 10:u=n.sent,s=t.current.getContext("2d"),requestAnimationFrame((function(){Cg(u,s)}));case 13:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,Eg.jsxs)("div",{className:"App",children:[r&&(0,Eg.jsx)(bg(),{className:"cam ".concat(r&&"cam-opened"),ref:e}),(0,Eg.jsx)("canvas",{className:"cam ".concat(r&&"cam-opened"),onClick:o,ref:t})]})};x.render((0,Eg.jsx)(y.StrictMode,{children:(0,Eg.jsx)(Sg,{})}),document.getElementById("root"))}()}();
//# sourceMappingURL=main.a78a67c9.js.map